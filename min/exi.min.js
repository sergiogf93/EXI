function Exi(a){var b=this;if(this.headerCssClass="titlePanel",this.mainMenu=new MainMenu,this.anonymousMenu=null,this.userMenu=null,this.managerMenu=null,this.keepTabs=!1,this.timers=[],this.controllers=[new ExiController,new ProposalExiController,new ShippingExiController],null!=a&&(null!=a.menu&&(this.mainMenu=a.menu,this.userMenu=a.menu),null!=a.anonymousMenu&&(this.anonymousMenu=a.anonymousMenu),null!=a.managerMenu&&(this.managerMenu=a.managerMenu),null!=a.headerCssClass&&(this.headerCssClass=a.headerCssClass),null!=a.controllers))for(var c=0;c<a.controllers.length;c++)this.controllers.push(a.controllers[c]);this.mainStatusBar=new MainStatusBar,this.proposalManager=new ProposalManager,this.credentialManager=new CredentialManager,this.credentialManager.onLogout.attach(function(a){b.mainMenu.populateCredentialsMenu(),b.clearMainPanel(),b.clearNavigationPanel(),b.setAnonymousMenu(),Ext.getCmp("navigation").collapse(),location.hash="/welcome"}),this.credentialManager.onLogin.attach(function(a,c){b.manageMenu(c)}),this.credentialManager.onActiveProposalChanged.attach(function(a){b.mainMenu.populateCredentialsMenu()}),this.authenticationForm=new AuthenticationForm,this.authenticationForm.onAuthenticate.attach(function(a,c){var d=new AuthenticationManager;d.onSuccess.attach(function(a,d){b.credentialManager.addCredential(d.user,d.roles,d.token,c.site,c.exiUrl,c.properties),b.authenticationForm.window.close();var e=EXI.credentialManager.getCredentialByUserName(d.user);e.isManager()||e.isLocalContact()?location.hash="/welcome/manager/"+d.user+"/main":location.hash="/welcome/user/"+d.user+"/main",b.getDataAdapter().exi.offline.authenticate()}),d.onError.attach(function(a,b){alert("error")}),d.login(c.user,c.password,c.site)}),this.onAfterRender=new Event(this)}function MainStatusBar(){}function ProposalManager(){this.onActiveProposalChanged=new Event(this)}function ExiGenericController(){this.init()}function MainView(a){this.id=BUI.id(),this.title="New Tab",this.closable=!0,this.onSelectionChange=new Event(this),this.onSelect=new Event(this),this.onDeselect=new Event(this),null!=a&&null!=a.title&&(this.title=a.title)}function AuthenticationManager(){this.onSuccess=new Event(this),this.onError=new Event(this)}function ExiController(){this.init()}function ExiGenericController(){this.init()}function LabContactExiController(){this.init()}function OfflineExiController(){this.init()}function ProposalExiController(){this.init()}function SessionController(){this.init()}function ShippingExiController(){this.init()}function BootstrapGrid(a){this.id=BUI.id(),this.data={},this.width=300,this.height=300,this.template="",a&&(a.width&&(this.width=a.width),a.height&&(this.height=a.height),a.template&&(this.template=a.template)),this.data.id=this.id,this.rowSelected=new Event(this)}function MainMenu(a){this.id=BUI.id(),this.loginButtonId="loginButton"+this.id,this.cssClass="mainMenu",this.isHidden=!0,null!=a&&(null!=a.cssClass&&(this.cssClass=a.cssClass),null!=a.isHidden&&(this.isHidden=a.isHidden))}function ManagerMenu(){this.id=BUI.id(),MainMenu.call(this,{isHidden:!1,cssClass:"mainMenu"})}function ListView(){this.width=250,this.height=Ext.getBody().getHeight()-215,this.onSelect=new Event}function AddressListView(){this.title="Addresses",this.sorters=[{property:"cardName",direction:"ASC"}],ListView.call(this)}function RunListView(){this.sorters=[],ListView.call(this)}function SessionListView(){this.sorters=[{property:"sessionId",direction:"DESC"}],ListView.call(this)}function ShippingListView(){this.sorters=[{property:"sessionId",direction:"DESC"}],ListView.call(this),this.dewars=null}function WorkSpaceListView(){this.width=250,this.height=800,this.selectionMenu=new SelectionMenu,this.onSelect=new Event,this.projectId=null}function Credential(a,b,c,d,e,f,g,h){this.username=a.toLowerCase(),this.roles=b,this.url=d,this.exiUrl=e,this.token=c,this.activeProposals=f,this.tokenExpires=g,this.properties=h}function CredentialManager(){this.onLogin=new Event(this),this.onLogout=new Event(this),this.onActiveProposalChanged=new Event(this)}function MainView(a){this.id=BUI.id(),this.title="New Tab",this.closable=!0,this.onSelectionChange=new Event(this),this.onSelect=new Event(this),this.onDeselect=new Event(this),null!=a&&null!=a.title&&(this.title=a.title)}function AddressMainView(){this.icon="../images/icon/contacts.png",this.queueGridList=[],MainView.call(this),this.addressForm=new AddressForm({width:.9*Ext.getBody().getWidth()}),this.onSelect=new Event(this),this.onDeselect=new Event(this)}function ManagerWelcomeMainView(){this.icon="../images/icon/rsz_ic_home_black_24dp.png",MainView.call(this),this.title="Home",this.closable=!1,this.sessionGrid=new SessionGrid({width:null,height:600,isHiddenTitle:!0,isHiddenPI:!1,isHiddenNumberOfShifts:!1,isHiddenLocalContact:!1,margin:"10 10 10 10"}),this.proposalGrid=new ProposalGrid({width:900,height:600,margin:"10 10 10 10"})}function RunMainView(){this.id=BUI.id(),MainView.call(this)}function DimpleRunMainView(){this.title="Experiment",this.icon="images/icon/ic_satellite_black_18dp.png",this.queueGridList=[],this.id=BUI.id(),RunMainView.call(this)}function ScatteringForm(a){this.id=BUI.id(),this.width=600,this.height=200,this.showTitle=!0,null!=a&&(null!=a.showTitle&&(this.showTitle=a.showTitle),null!=a.width&&(this.width=a.width),null!=a.height&&(this.height=a.height))}function SessionMainView(a){this.icon="images/icon/ic_satellite_black_18dp.png",MainView.call(this,a);this.sessionGrid=new SessionGrid({width:700,height:598,margin:"0 0 0 20",title:"Click on calendar to see the sessions"})}function SpreadSheet(a){this.id=BUI.id(),this.height=380,this.width=500,this.containerType="OTHER",null!=a&&(null!=a.height&&(this.height=a.height),null!=a.width&&(this.width=a.width),null!=a.containerType&&(this.containerType=a.containerType))}function AddContainerForm(a){this.id=BUI.id();var b=this;this.width=600,this.height=200,this.showTitle=!0,this.container={},null!=a&&(null!=a.showTitle&&(this.showTitle=a.showTitle),null!=a.width&&(this.width=a.width),null!=a.height&&(this.height=a.height)),this.containerTypeComboBox=new ContainerTypeComboBox({extraOptions:[{type:"STOCK SOLUTION"},{type:"OTHER",capacity:1}]}),this.stockSolutionsGrid=new StockSolutionsGrid({width:.95*this.width}),this.containerTypeComboBox.onSelected.attach(function(a,c){b.container={},"STOCK SOLUTION"==c.type?(b.addStockSolutionsList(),Ext.getCmp(b.id+"-save-button").disable()):(b.stockSolutionsGrid.panel&&b.panel.remove(b.stockSolutionsGrid.panel),Ext.getCmp(b.id+"-save-button").enable())}),this.stockSolutionsGrid.onSelected.attach(function(a,c){b.container=c,b.container.containerType="STOCK SOLUTION",Ext.getCmp(b.id+"-save-button").enable()}),this.onSave=new Event(this),this.onCancel=new Event(this)}function CaseForm(a){this.id=BUI.id(),this.width=600,this.showTitle=!0,null!=a&&null!=a.showTitle&&(this.showTitle=a.showTitle),this.onSaved=new Event(this)}function ContainerSpreadSheet(a){this.id=BUI.id(),SpreadSheet.call(this,a),this.renderCrystalFormColumn=!1,null!=a&&null!=a.renderCrystalFormColumn&&(this.renderCrystalFormColumn=a.renderCrystalFormColumn),this.crystalInfoToIdMap={},this.crystalFormIndex=-1,this.spaceGroupIndex=-1,this.onModified=new Event(this)}function CrystalFormView(a){this.id=BUI.id(),this.padding=20,this.containerId=0,null!=a&&(null!=a.padding&&(this.padding=a.padding),null!=a.containerId&&(this.containerId=a.containerId)),this.uploaderWidget=new UploaderWidget}function EditCrystalFormView(a){this.id=BUI.id(),this.width=600,this.height=500,this.showTitle=!0,null!=a&&(null!=a.showTitle&&(this.showTitle=a.showTitle),null!=a.width&&(this.width=a.width),null!=a.height&&(this.height=a.height)),this.onSaved=new Event(this)}function GenericContainerSpreadSheet(a){this.id=BUI.id(),SpreadSheet.call(this,a)}function OtherContainerForm(a){this.id=BUI.id();this.width=1500,this.height=600,this.container={},null!=a&&(null!=a.width&&(this.width=a.width),null!=a.height&&(this.height=a.height)),this.containerSpreadSheet=new GenericContainerSpreadSheet({width:this.width-50,height:this.height-300}),this.onSave=new Event(this),this.onCancel=new Event(this)}function ParcelGrid(a){this.id=BUI.id(),this.height=100,this.width=100,this.padding=10,this.btnEditVisible=!0,this.btnRemoveVisible=!0,null!=a&&(null!=a.height&&(this.height=a.height),null!=a.width&&(this.width=a.width),null!=a.padding&&(this.padding=a.padding),null!=a.btnEditVisible&&(this.btnEditVisible=a.btnEditVisible),null!=a.btnRemoveVisible&&(this.btnRemoveVisible=a.btnRemoveVisible)),this.shipment=null,this.dewars={},this.parcelPanels={},this.onSuccess=new Event(this),this.onAdd=new Event(this),this.onRemove=new Event(this)}function PuckFormView(a){this.id=BUI.id(),this.height=500,this.width=500,this.unsavedChanges=!1,null!=a&&(null!=a.height&&(this.height=a.height),null!=a.width&&(this.width=a.width));var b=this;this.containerSpreadSheet=new ContainerSpreadSheet({width:Ext.getBody().getWidth()-100,height:600}),this.containerSpreadSheet.onModified.attach(function(a,c){b.unsavedChanges=!0}),this.capacityCombo=new ContainerTypeComboBox({label:"Type:",labelWidth:100,width:250,initDisabled:!0}),this.capacityCombo.onSelected.attach(function(a,c){var d=c.capacity;b.unsavedChanges=!0,b.containerTypeChanged(d)}),this.onRemoved=new Event(this),this.onSaved=new Event(this)}function ShipmentEditForm(a){this.id=BUI.id(),this.width=600,this.height=700,this.showTitle=!0,null!=a&&(null!=a.showTitle&&(this.showTitle=a.showTitle),null!=a.width&&(this.width=a.width),null!=a.height&&(this.height=a.height)),this.onSaved=new Event(this)}function ShipmentForm(a){this.id=BUI.id(),this.width=600,this.padding=10,null!=a&&(null!=a.creationMode&&(this.creationMode=a.creationMode),null!=a.width&&(this.width=a.width)),this.onSaved=new Event(this)}function ShippingMainView(){MainView.call(this);this.shipmentForm=new ShipmentForm({width:Ext.getBody().getWidth()-200}),this.shipmentForm.onSaved.attach(function(a,b){location.hash="#/shipping/"+b.shippingId+"/main"}),this.parcelGrid=new ParcelGrid({height:580,width:Ext.getBody().getWidth()-200})}function WelcomeMainView(){this.icon="../images/icon/rsz_ic_home_black_24dp.png",MainView.call(this),this.title="Welcome",this.closable=!0}function AddressEditForm(a){this.id=BUI.id(),this.height=450,this.width=740,this.padding=10,null!=a&&(null!=a.height&&(this.height=a.height),null!=a.width&&(this.width=a.width)),this.onSaved=new Event(this)}function AddressForm(a){this.id=BUI.id(),this.height=500,this.width=500,null!=a&&(null!=a.height&&(this.height=a.height),null!=a.width&&(this.width=a.width))}function AuthenticationForm(){this.singleSite=!1,this.siteURL=null,this.icon=null,this.onAuthenticate=new Event(this)}function ContainerParcelPanel(a){this.id=BUI.id(),this.height=220,this.containerId=0,this.shippingId=0,this.shippingStatus="",this.withoutCollection=!0,this.data={puckType:"Puck",mainRadius:.75*this.height*.9/2,xMargin:this.width/2-.9*this.height/2,yMargin:2.5,code:"",enableMouseOver:!0,enableClick:!0,enableMainClick:!0,enableMainMouseOver:!0,containerId:0,capacity:10},this.width=2*this.data.mainRadius+20,this.container=new ContainerWidget(this.data),null!=a&&(null!=a.height&&(this.height=a.height,this.data.mainRadius=.75*this.height*.9/2,this.width=2*this.data.mainRadius+20,this.data.xMargin=this.width/2-this.data.mainRadius),null!=a.width&&(this.width=a.width,this.data.xMargin=this.width/2-this.data.mainRadius),null!=a.containerId&&(this.containerId=a.containerId,this.data.containerId=this.containerId),null!=a.shippingId&&(this.shippingId=a.shippingId),null!=a.shippingStatus&&(this.shippingStatus=a.shippingStatus),null!=a.code&&(this.data.code=a.code),null!=a.type&&(this.data.puckType=a.type),null!=a.capacity&&(this.data.capacity=a.capacity)),this.onContainerRemoved=new Event(this)}function ContainerTypeComboBox(a){this.id=BUI.id(),this.label="Choose Container Type:",this.labelWidth=200,this.width=500,this.initDisabled=!1,this.data=[{type:"SPINE",capacity:10},{type:"UNIPUCK",capacity:16},{type:"PLATE",capacity:96}],a&&(a.label&&(this.label=a.label),a.labelWidth&&(this.labelWidth=a.labelWidth),a.width&&(this.width=a.width),null!=a.extraOptions&&(this.data=_.union(this.data,a.extraOptions)),null!=a.initDisabled&&(this.initDisabled=a.initDisabled)),this.onSelected=new Event(this)}function ContainerWidget(a){this.id=BUI.id(),this.templateData={id:this.id,xmargin:0,ymargin:0,mainRadius:50,width:100,height:100,r:20,enableMainClick:!1,enableMainMouseOver:!1},this.containerId=0,this.samples=null,this.code="",a&&(a.code&&(this.code=a.code),a.containerId&&(this.containerId=a.containerId),a.xMargin&&(this.templateData.xMargin=a.xMargin),a.yMargin&&(this.templateData.yMargin=a.yMargin),null!=a.enableMainClick&&(this.templateData.enableMainClick=a.enableMainClick),null!=a.enableMainMouseOver&&(this.templateData.enableMainMouseOver=a.enableMainMouseOver),a.mainRadius&&(this.templateData.mainRadius=a.mainRadius,this.templateData.width=2*a.mainRadius,this.templateData.height=2*a.mainRadius,this.templateData.r=a.mainRadius/5)),this.onClick=new Event(this),this.onMouseOver=new Event(this),this.onMouseOut=new Event(this)}function CurvePlotter(a){this.id=BUI.id(),this.backgroundColor="#FFFFFF",this.margin="0 0 0 5",this.ruleColor="black",this.targetId="plotCanvas"+BUI.id(),this.legend="onmouseover",null!=a&&(null!=a.margin&&(this.margin=a.margin),null!=a.legend&&(this.legend=a.legend),null!=a.targetId&&(this.targetId=a.targetId)),this.onRendered=new Event(this),this.onPointClickCallback=new Event}function AutoProcIntegrationCurvePlotter(a){CurvePlotter.call(this,a),this.margin="10 0 0 0",this.height=null,this.title="",null!=a&&(null!=a.height&&(this.height=a.height),null!=a.title&&(this.title=a.title)),this.data={labels:[],data:[]},this.xLabels=[]}function ParcelPanel(a){this.test="A",this.id=BUI.id(),this.height=500,this.width=500,this.index=0,this.containersPanelHeight=400,this.containersPanelWidth=9*this.width/12-30,this.containersParcelWidth=2*this.containersPanelHeight*.9/2+20,this.shippingId=0,this.shippingStatus="",this.containersPanel=null,this.currentTab="content",this.isSaveButtonHidden=!1,this.isHidden=!1,null!=a&&(null!=a.height&&(this.height=a.height,this.containersPanelHeight=.9*this.height,this.containersParcelWidth=2*this.containersPanelHeight*.9/2+20),null!=a.width&&(this.width=a.width,this.containersPanelWidth=9*this.width/12-30),null!=a.index&&(this.index=a.index),null!=a.shippingId&&(this.shippingId=a.shippingId),null!=a.shippingStatus&&(this.shippingStatus=a.shippingStatus),null!=a.currentTab&&(this.currentTab=a.currentTab)),this.onSavedClick=new Event(this)}function ProposalGrid(a){this.height=500,this.tbar=!1,this.id=BUI.id(),this.margin="0 0 0 0",null!=a&&(null!=a.height&&(this.height=a.height),null!=a.searchBar&&(this.searchBar=a.searchBar),null!=a.tbar&&(this.tbar=a.tbar),null!=a.collapsed&&(this.collapsed=a.collapsed),null!=a.width&&(this.width=a.width),null!=a.margin&&(this.margin=a.margin)),this.onSelected=new Event(this)}function PuckStatisticsContainer(a){this.id=BUI.id(),this.templateData={id:this.id,xmargin:0,ymargin:0,mainRadius:50,width:100,height:100,margin:15,enableMainClick:!1,enableClick:!1,code:"",enableMainMouseOver:!1,nSamples:0,nMeasured:0},this.samples=null,this.code="",a&&(a.code&&(this.code=a.code),a.xMargin&&(this.templateData.xMargin=a.xMargin),a.yMargin&&(this.templateData.yMargin=a.yMargin),null!=a.enableMainClick&&(this.templateData.enableMainClick=a.enableMainClick),null!=a.enableClick&&(this.templateData.enableClick=a.enableClick),a.mainRadius&&(this.templateData.mainRadius=a.mainRadius,this.templateData.width=2*a.mainRadius,this.templateData.height=2*a.mainRadius,this.templateData.margin=.5*(this.templateData.width-this.templateData.imgW)),a.code&&(this.templateData.code=a.code)),this.onClick=new Event(this),this.onMouseOver=new Event(this),this.onMouseOut=new Event(this)}function SessionGrid(a){this.height=500,this.tbar=!1,this.id=BUI.id(),this.width=null,this.title=null,this.margin=10,this.hiddenGoColumn=!0,this.isHiddenTitle=!0,this.isHiddenNumberOfShifts=!0,this.isHiddenPI=!0,this.isHiddenLocalContact=!0,this.layout="fit",this.beamlineFilter=[],null!=a&&(null!=a.isHiddenLocalContact&&(this.isHiddenLocalContact=a.isHiddenLocalContact),null!=a.isHiddenNumberOfShifts&&(this.isHiddenNumberOfShifts=a.isHiddenNumberOfShifts),null!=a.width&&(this.width=a.width),null!=a.isHiddenTitle&&(this.isHiddenTitle=a.isHiddenTitle),null!=a.isHiddenPI&&(this.isHiddenPI=a.isHiddenPI),null!=a.title&&(this.title=a.title),null!=a.margin&&(this.margin=a.margin),null!=a.height&&(this.height=a.height),null!=a.tbar&&(this.tbar=a.tbar),null!=a.width&&(this.width=a.width,this.layout=null),null!=a.hiddenGoColumn&&(this.hiddenGoColumn=a.hiddenGoColumn)),this.onSelected=new Event(this)}function StockSolutionContainer(a){if(this.id=BUI.id(),this.templateData={id:this.id,xmargin:0,ymargin:0,mainRadius:50,width:100,height:100,margin:15,stockId:0,enableMainClick:!1,enableClick:!1,code:""},this.stockSolutionId=0,this.samples=null,this.code="",a&&(a.code&&(this.code=a.code),a.xMargin&&(this.templateData.xMargin=a.xMargin),a.yMargin&&(this.templateData.yMargin=a.yMargin),null!=a.enableMainClick&&(this.templateData.enableMainClick=a.enableMainClick),null!=a.enableClick&&(this.templateData.enableClick=a.enableClick),a.mainRadius&&(this.templateData.mainRadius=a.mainRadius,this.templateData.width=2*a.mainRadius,this.templateData.height=2*a.mainRadius,this.templateData.margin=.5*(this.templateData.width-this.templateData.imgW)),a.code&&(this.templateData.code=a.code),a.stockSolutionId)){this.stockSolutionId=a.stockSolutionId;var b=EXI.proposalManager.getStockSolutionById(this.stockSolutionId);this.templateData.macromoleculeAcronym=EXI.proposalManager.getMacromoleculeById(b.macromoleculeId).acronym,this.templateData.buffer=EXI.proposalManager.getBufferById(b.bufferId).acronym,this.templateData.stockId=this.stockSolutionId}this.onClick=new Event(this),this.onMouseOver=new Event(this),this.onMouseOut=new Event(this)}function StockSolutionsGrid(a){this.id=BUI.id(),this.width=600,this.padding=0,null!=a&&(null!=a.width&&(this.width=a.width),null!=a.width&&(this.padding=a.padding)),this.onSelected=new Event(this)}function UploaderWidget(a){this.id=BUI.id(),this.url=null,a&&a.url&&(this.url=a.url),null==this.url&&Ext.Msg.alert("Error","Please, set an url"),this.onUploaded=new Event(this)}function AutoprocIntegrationController(){this.init()}function BeamlineParameterController(){this.init()}function CrystalController(){this.init()}function ImageController(){this.init()}function MxDataCollectionController(){this.init()}function MxPrepare(){this.init()}function PhasingController(){this.init()}function ProteinController(){this.init()}function PuckController(){this.init()}function WorkflowController(){this.init()}function XfeController(){this.init()}function ExiMX(){Exi.call(this,{menu:new MXMainMenu,managerMenu:new MXManagerMenu,anonymousMenu:new MainMenu,controllers:[new SessionController,new OfflineExiController,new ProposalExiController,new LabContactExiController,new PuckController,new CrystalController,new ProteinController,new AutoprocIntegrationController,new MxDataCollectionController,new WorkflowController,new MxPrepare,new ImageController,new PhasingController,new XfeController,new BeamlineParameterController],headerCssClass:"mxTitlePanel"})}function MXMainMenu(){this.id=BUI.id(),MainMenu.call(this,{cssClass:"mxMainMenu"})}function MXManagerMenu(){this.id=BUI.id(),ManagerMenu.call(this,{isHidden:!1,cssClass:"mainMenu"})}function AutoProcIntegrationListView(){ListView.call(this)}function CrystalListView(){ListView.call(this)}function DewarListView(){this.title="Dewars",this.sorters=[{property:"sessionId",direction:"DESC"}],ListView.call(this)}function PhasingListView(){this.title="Space Groups",this.sorters=[{property:"sessionId",direction:"DESC"}],ListView.call(this)}function ProteinListView(){ListView.call(this)}function PuckListView(){this.title="Pucks",this.sorters=[{property:"sessionId",direction:"DESC"}],ListView.call(this)}function WorkflowStepListView(){ListView.call(this)}function AutoprocessingRanker(){}function AutoProcIntegrationAttachmentGrid(a){this.id=BUI.id(),this.maxHeight=300}function AutoProcIntegrationGrid(a){this.height=500,this.tbar=!1,this.id=BUI.id(),this.preventSelection=!1,this.maxHeight=500,this.minHeight=500,this.minHeight=500,this.collapsed=!0,null!=a&&(null!=a.height&&(this.height=a.height),null!=a.maxHeight&&(this.maxHeight=a.maxHeight),null!=a.searchBar&&(this.searchBar=a.searchBar),null!=a.tbar&&(this.tbar=a.tbar),null!=a.collapsed&&(this.collapsed=a.collapsed),null!=a.width&&(this.width=a.width)),this.onSelected=new Event(this)}function AutoProcIntegrationMainView(){this.icon="images/icon/ic_satellite_black_18dp.png",MainView.call(this);this.id=BUI.id(),this.autoProcIntegrationGrid=new AutoProcIntegrationGrid({height:300})}function ImageMainView(){this.icon="images/icon/ic_satellite_black_18dp.png",MainView.call(this);this.imageViewer=new ImageResolutionViewer,this.detectorResolution={pixelSize:{x:1475,y:1679},sensitiveArea:{x:253.7,y:288.8},pixelSizeHorizontal:.172},this.imageViewer.onImageRendered.attach(function(a,b){}),this.imageViewer.onMouseOver.attach(function(a,b){})}function CrystalMainView(){this.icon="images/icon/ic_satellite_black_18dp.png",MainView.call(this);this.crystalForm=new CrystalForm,this.samplesGrid=new SamplesGrid}function AutoProcessingFileManager(){this.autoProcIntegrationAttachmentGrid=new AutoProcIntegrationAttachmentGrid({margin:5,height:500})}function DataCollectionGrid(a){this.store=Ext.create("Ext.data.Store",{fields:["dataCollectionGroup"]})}function DataCollectionMxMainView(){this.icon="../images/icon/ic_satellite_black_18dp.png",MainView.call(this);this.genericDataCollectionPanel=new MXDataCollectionGrid,this.energyScanGrid=new EnergyScanGrid,this.xfeScanGrid=new XFEScanGrid}function CollapsedDataCollectionGrid(a){this.template="collapsed.mxdatacollectiongrid.template",DataCollectionGrid.call(this,a)}function ContainersDataCollectionGrid(a){this.legend=new PuckLegend({width:300,height:50,cy:"12.5%",tOffset:30})}function CustomSectionDataCollection(a){this.noFoundClass="summary_datacollection_noFound",this.failedClass="summary_datacollection_failed",this.successClass="summary_datacollection_success"}function MXDataCollectionGrid(a){this.id=BUI.id(),this.renderingType="DATACOLLECTION",this.uncollapsedDataCollectionGrid=new UncollapsedDataCollectionGrid,this.collapsedDataCollectionGrid=new CollapsedDataCollectionGrid,this.containersDataCollectionGrid=new ContainersDataCollectionGrid,this.activePanel=this.uncollapsedDataCollectionGrid}function OnlineResultSectionDataCollection(a){this.noFoundClass="summary_datacollection_noFound",this.failedClass="summary_datacollection_failed",this.successClass="summary_datacollection_success"}function ThumbnailSectionDatacollection(a){}function UncollapsedDataCollectionGrid(a){this.id=BUI.id(),this.template="mxdatacollectiongrid.template",DataCollectionGrid.call(this,a)}function WorkflowSectionDataCollection(a){this.noFoundClass="summary_datacollection_noFound",this.failedClass="summary_datacollection_failed",this.successClass="summary_datacollection_success"}function FileManagerPhasingGrid(a){this.onSelect=new Event(this)}function PhasingGrid(a){}function PhasingViewerMainView(){MainView.call(this);var a=this;this.phasingNetworkWidget=new PhasingNetworkWidget({tbar:"MENU"}),this.summaryPhasingGrid=new SummaryPhasingGrid,this.fileManagerPhasingGrid=new FileManagerPhasingGrid,this.summaryPhasingGrid.onSelect.attach(function(b,c){var d=function(b,c){if(c){c=_.flatten(c);for(var d=[],e=0;e<c.length;e++)null!=c[e].fileName&&d.push(c[e]);a.fileManagerPhasingGrid.load(d),a.fileManagerPhasingGrid.panel.setLoading(!1)}},e=function(b,c){alert(c),a.fileManagerPhasingGrid.panel.setLoading(!1)};a.fileManagerPhasingGrid.panel.setLoading(),EXI.getDataAdapter({onSuccess:d,onError:e}).mx.phasing.getPhasingFilesByPhasingStepId(c.phasingStepId)})}function SummaryPhasingGrid(a){this.pseudoFreeMin=24,this.ccOfPartialModel=60,this.onSelect=new Event(this)}function ConfirmShipmentView(a){if(this.sampleChangerName="","undefined"!=typeof Storage){var b=sessionStorage.getItem("sampleChangerName");b&&(this.sampleChangerName=b)}this.sampleChangerWidget=null,this.selectedPuck=null}function ContainerPrepareSpreadSheet(a){this.id=BUI.id(),this.height=600,this.width=600,null!=a&&(a.height&&(this.height=a.height),a.width&&(this.width=a.width)),this.onSelectRow=new Event(this),this.onLoaded=new Event(this),this.onBeamlineChanged=new Event(this),this.onUnloadAllButtonClicked=new Event(this)}function DewarListSelectorGrid(a){this.height=600,this.width=1e3,null!=a&&(a.height&&(this.height=a.height),a.width&&(this.width=a.width)),this.filterByDate=!0,this.onSelect=new Event(this),this.onDeselect=new Event(this),this.onSelectionChange=new Event(this)}function LoadSampleChangerView(a){var b=this;this.id=BUI.id(),this.showTip=!0,this.height=600,this.width=600,this.widgetRadius=185,null!=a&&(a.height&&(this.height=a.height),a.width&&(this.width=a.width));var c={radius:this.widgetRadius,isLoading:!1};if(this.sampleChangerWidget=new FlexHCDWidget(c),this.selectedRowItem=null,this.selectedContainerId=null,this.selectedContainerCapacity=null,this.selectedPuck=null,this.sampleChangerName=null,this.containerListEditor=new ContainerPrepareSpreadSheet({height:507,width:600}),this.previewPanelView=new PreviewPanelView({height:100}),"undefined"!=typeof Storage){var d=sessionStorage.getItem("sampleChangerName");d&&(this.sampleChangerName=d)}this.containerListEditor.onSelectRow.attach(function(a,c){var d=c.record;d&&(b.showTip&&($.notify("Click on a sample changer location to place the container","info"),b.sampleChangerWidget.blink(),b.showTip=!1),d.data.beamlineName!=b.sampleChangerWidget.beamlineName&&b.changeSampleChangerWidgetByBeamline(d.data.beamlineName),b.selectedPuck&&b.deselectPuck(),b.selectedContainerId?b.selectedContainerId==d.get("containerId")?(b.deselectRow(),b.cleanPreviewPanel()):(b.deselectRow(),b.setSelectedRow(d)):b.setSelectedRow(d))}),this.containerListEditor.onBeamlineChanged.attach(function(a,c){b.changeSampleChangerWidgetByBeamline(c)}),this.containerListEditor.onLoaded.attach(function(a,c){b.load(c)}),this.containerListEditor.onUnloadAllButtonClicked.attach(function(a){b.returnToSelectionStatus()}),this.previewPanelView.onUnloadButtonClicked.attach(function(a){b.selectedPuck&&(b.selectedPuck.emptyAll(),b.previewPuck(b.selectedPuck.containerId,b.selectedPuck.capacity,{info:[{text:"SC Location",value:b.sampleChangerWidget.convertIdToSampleChangerLocation(b.selectedPuck.id)}]},"")),b.containerListEditor.updateSampleChangerLocation(b.selectedContainerId,""),b.returnToSelectionStatus()})}function PrepareMainView(a){this.icon="../images/icon/contacts.png",this.queueGridList=[],MainView.call(this);var b=this;this.currentStep=1,a&&a.currentStep&&(this.currentStep=a.currentStep),this.steps=["","/loadSampleChanger"],this.height=550,this.width=1300,this.dewarListSelector=new DewarListSelectorGrid({height:this.height-12,width:this.width-60}),this.loadSampleChangerView=new LoadSampleChangerView({height:this.height-12,width:this.width-0}),this.confirmShipmentView=new ConfirmShipmentView,this.dewarListSelector.onSelect.attach(function(a,c){$("#step-3").attr("disabled",!0),b.loadSampleChangerView.sampleChangerName="",b.save("sampleChangerName",""),"processing"==c.shippingStatus&&b.updateStatus(c.shippingId,"at_ESRF"),"processing"!=c.shippingStatus&&b.updateStatus(c.shippingId,"processing")}),this.dewarListSelector.onSelectionChange.attach(function(a,b){}),this.selectedContainerId=null,this.selectedContainerCapacity=null,this.selectedPuck=null,this.sampleChangerName=null}function PreviewPanelView(a){this.width=400,this.height=300,a&&(a.width&&(this.width=a.width),a.height&&(this.height=a.height)),this.puckData={puckType:"Unipuck",mainRadius:.4*this.height,xMargin:this.width/4-.4*this.height,yMargin:10,enableMouseOver:!0},this.onUnloadButtonClicked=new Event(this)}function WorkflowStepMainView(){this.icon="images/icon/ic_satellite_black_18dp.png",MainView.call(this)}function XfeViewerMainView(){this.id=BUI.id(),MainView.call(this),this.filters=[],this.data={labels:[],data:[]}}function CurvePlotter(a){this.id=BUI.id(),this.backgroundColor="#FFFFFF",this.margin=10,this.ruleColor="black",this.targetId="plotCanvas"+BUI.id(),this.legend="onmouseover",null!=a&&(null!=a.margin&&(this.margin=a.margin),null!=a.legend&&(this.legend=a.legend),null!=a.targetId&&(this.targetId=a.targetId)),this.onRendered=new Event(this),this.onPointClickCallback=new Event}function AutoProcIntegrationCurvePlotter(a){CurvePlotter.call(this,a),this.margin="10 0 0 0",this.height=null,this.title="",null!=a&&(null!=a.height&&(this.height=a.height),null!=a.title&&(this.title=a.title)),this.data={labels:[],data:[]},this.xLabels=[]}function ElectronDensityViewer(a){this.id=BUI.id()}function EnergyScanGrid(a){}function SampleChangerWidget(a){this.id=BUI.id(),this.pucks={},this.clockwise=1,this.initAlpha=0,this.isLoading=!0,this.radius=200,this.name="",this.onPuckSelected=new Event(this),this.sampleChangerCapacity=0,this.beamlineName="",this.data={},a&&(a.radius&&(this.radius=a.radius),null!=a.isLoading&&(this.isLoading=a.isLoading),a.beamlineName&&(this.beamlineName=a.beamlineName))}function FlexHCDWidget(a){SampleChangerWidget.call(this,a),this.name="FlexHCD",this.sampleChangerCapacity=24,this.initAlpha=-14*Math.PI/16,this.data={id:this.id,radius:this.radius,cells:8,lines:[],text:[]},this.createStructure(),this.createPucks("Spinepuck",this.data.cells/2,-7*Math.PI/8,this.data.radius/2,.5,{dAlpha:Math.PI/16,dist:3*this.data.radius/4}),this.createPucks("Unipuck",this.data.cells/2,-5*Math.PI/8,this.data.radius/2,.5,{dAlpha:Math.PI/16,dist:3*this.data.radius/4})}function PuckLegend(a){this.id=BUI.id(),this.width=200,this.height=10;var b="30.5%",c=8;a&&(a.width&&(this.width=a.width),a.height&&(this.height=a.height),a.cy&&(b=a.cy),a.tOffset&&(c=a.tOffset));var d="0.55vw",e="7%",f=[];f.push({cx:"7%",cy:b,r:e,cls:"cell_empty",text:"EMPTY"}),f.push({cx:"27%",cy:b,r:e,cls:"cell_collected",text:"COLLECTED"}),f.push({cx:"47%",cy:b,r:e,cls:"cell_filled",text:"FILLED"}),f.push({cx:"67%",cy:b,r:e,cls:"cell_selected",text:"SELECTED"}),this.data={id:this.id,circles:f,tOffset:c,fontSize:d}}function PuckWidget(a){this.id=BUI.id(),this.mainRadius=150,this.dataCollectionIds={},this.containerId=0,this.containerCode="",this.enableMouseOver=!1,this.enableClick=!1,this.enableMainClick=!1,this.enableMainMouseOver=!1,this.initSelected={},this.isLoading=!0,this.capacity=10,this.isUnipuck=!1,this.isEmpty=!0,a&&(a.id&&(this.id=a.id),a.mainRadius&&(this.mainRadius=a.mainRadius),a.isUnipuck&&(this.isUnipuck=a.isUnipuck),a.dataCollectionIds&&(this.dataCollectionIds=a.dataCollectionIds),a.containerIds&&(this.containerIds=a.containerIds),null!=a.enableMouseOver&&(this.enableMouseOver=a.enableMouseOver),null!=a.enableClick&&(this.enableClick=a.enableClick),null!=a.enableMainClick&&(this.enableMainClick=a.enableMainClick),null!=a.enableMainMouseOver&&(this.enableMainMouseOver=a.enableMainMouseOver),a.initSelected&&(this.initSelected=a.initSelected),null!=a.isLoading&&(this.isLoading=a.isLoading)),this.shapeRadiusX=this.mainRadius/10,this.shapeRadiusY=this.mainRadius/20,this.data={mainRadius:this.mainRadius,cells:[],id:this.id,isUnipuck:this.isUnipuck,shapeRadiusX:this.shapeRadiusX,shapeRadiusY:this.shapeRadiusY,containerId:this.containerId,containerCode:this.containerCode,enableClick:this.enableClick,enableMainClick:this.enableMainClick,enableMouseOver:this.enableMouseOver,dataCollectionIds:this.dataCollectionIds,isLoading:this.isLoading},this.onClick=new Event(this),this.onMouseOver=new Event(this),this.onMouseOut=new Event(this)}function PuckWidgetContainer(a){
var b=this;if(this.onClick=new Event(this),this.mouseOverCell=new Event(this),this.mouseOutCell=new Event(this),this.onMouseOver=new Event(this),this.onMouseOut=new Event(this),this.xMargin=0,this.yMargin=0,this.containerId=0,this.enableMainClick=!1,this.enableMainMouseOver=!1,this.code="",a){if(a.puckType)switch(a.puckType){case"Unipuck":this.puckWidget=new UniPuckWidget(a),this.capacity=16;break;case"Spinepuck":this.puckWidget=new SpinePuckWidget(a),this.capacity=10;break;case"Puck":this.puckWidget=new SpinePuckWidget(a),this.capacity=10}a.code&&(this.code=a.code),a.containerId&&(this.containerId=a.containerId),a.xMargin&&(this.xMargin=a.xMargin),a.yMargin&&(this.yMargin=a.yMargin),null!=a.enableMainClick&&(this.enableMainClick=a.enableMainClick),null!=a.enableMainMouseOver&&(this.enableMainMouseOver=a.enableMainMouseOver)}this.puckWidget||(this.puckWidget=new SpinePuckWidget(a)),this.puckWidget.onClick.attach(function(a,c){b.onClick.notify(c)}),this.puckWidget.onMouseOver.attach(function(a,c){b.mouseOverCell.notify(c)}),this.puckWidget.onMouseOut.attach(function(a){b.mouseOutCell.notify()})}function RoboDiffWidget(a){SampleChangerWidget.call(this,a),this.name="RoboDiff",this.sampleChangerCapacity=24,this.initAlpha=-14*Math.PI/16,this.data={id:this.id,radius:this.radius,cells:8,lines:[],text:[]},this.createStructure(),this.createPucks("Spinepuck",this.data.cells,-7*Math.PI/8,this.data.radius/2,.5,{dAlpha:Math.PI/16,dist:3*this.data.radius/4})}function SampleChangerSelector(a){var b=this;this.height=600,this.width=1e3,null!=a&&(a.height&&(this.height=a.height),a.width&&(this.width=a.width));var c={header:"Type (Sample Changer)",values:["FlexHCD","SC3","RoboDiff"]};this.beamlines=EXI.credentialManager.getBeamlinesByTechnique("MX");for(var d=[],e=0;e<this.beamlines.length;e++){var f=this.beamlines[e];d.push(f.name+" ("+f.sampleChangerType+")")}var g={header:"Beamlines",values:d};this.sampleChangerGrid=new BootstrapGrid({template:"bootstrap.grid.template"}),this.sampleChangerGrid.load(c),this.beamlinesGrid=new BootstrapGrid({template:"bootstrap.grid.template",height:1e3}),this.beamlinesGrid.load(g),this.sampleChangerWidget=null,this.sampleChangerGrid.rowSelected.attach(function(a,c){b.beamlinesGrid.deselectAll(),b.sampleChangerWidget=b.createSampleChanger(c),b.addSampleChanger(b.sampleChangerWidget),b.onRowSelected.notify()}),this.beamlinesGrid.rowSelected.attach(function(a,c){b.sampleChangerGrid.deselectAll();var d=_.filter(b.beamlines,{name:c.split(" ")[0]})[0].sampleChangerType;b.sampleChangerWidget=b.createSampleChanger(d),b.addSampleChanger(b.sampleChangerWidget),b.onRowSelected.notify(c.split(" ")[0])}),this.onRowSelected=new Event(this),this.onSampleChangerSelected=new Event(this)}function SC3Widget(a){SampleChangerWidget.call(this,a),this.name="SC3",this.sampleChangerCapacity=5,this.clockwise=-1,this.data={id:this.id,radius:this.radius,cells:5,text:[]},this.createStructure(),this.createPucks("Spinepuck",this.data.cells,0,this.data.radius/2,.8)}function SpinePuckWidget(a){null==a&&(a={}),a.isUnipuck=!1,PuckWidget.call(this,a),this.data=this.parseData(this.data),this.capacity=10}function UniPuckWidget(a){null==a&&(a={}),a.isUnipuck=!0,PuckWidget.call(this,a),this.data=this.parseData(this.data),this.capacity=16}function XFEScanGrid(a){this.id=BUI.id(),this.plots={}}function TestController(){this.init()}function SampleForm(a){this.id=a}function TestContainer(){this.container=Ext.create("Ext.container.Container",{layout:{type:"hbox"},width:400,border:1,style:{borderColor:"#000000",borderStyle:"solid",borderWidth:"1px"},items:[]})}function TestListView(){this.title="Samples",ListView.call(this)}function TestMainPanel(){this.title="Samples",ListView.call(this)}function TestMainWidgetPanel(){this.title="Samples",ListView.call(this)}function ElectronDensityViewer(a){this.id=BUI.id()}function PuckWidgetView(){this.queueGridList=[],this.widget=new FlexHCDWidget,this.title="Samples",MainView.call(this)}function TestMainView(a){MainView.call(this),this.crystalId=a,this.testMainPanel=new TestMainPanel,this.onSelect=new Event(this),this.onDeselect=new Event(this)}dust.helpers.decimal=function(a,b,c,d){if(d.key){var e=b.current()[d.key];if(d.key.split(".").length>1){var f=d.key.split(".");e=b.current()[f[0]][f[1]]}if(e)if(null!=d.decimals)try{d.intIfPossible&&parseInt(Number(e))==Number(e)?a.write(parseInt(Number(e))):a.write(Number(e).toFixed(d.decimals))}catch(g){a.write(b.current()[d.key])}else a.write(b.current()[d.key])}else a.write("WARN: NO KEY SET");return a},dust.helpers.dataCollectionComment=function(a,b,c,d){if(d.key){var e=b.current()[d.key];e&&""!=e.trim()&&a.write("Comment: "+e)}else a.write("WARN: NO KEY SET");return a},dust.helpers.sizeOf=function(a,b,c,d){var e=this.size(a,b,c,d);return c&&c.block?a.render(c.block,b.push({isSelect:!0,isResolved:!1,selectKey:e})):e},dust.helpers.exponential=function(a,b,c,d){if(d.key){var e=b.current()[d.key];if(e)if(null!=d.decimals)try{a.write(Number(Number(e).toFixed(d.decimals)).toExponential())}catch(f){a.write(b.current()[d.key])}else a.write(b.current()[d.key])}else a.write("WARN: NO KEY SET");return a},dust.helpers.mmVolTest=function(a,b,c,d){var e=b.current().Subtraction_volume;if(e)try{a.write(Number(e/2).toFixed(1)+" - "+Number(e/1.5).toFixed(1))}catch(f){a.write(b.current()[d.key])}return a},dust.helpers.framesColor=function(a,b,c,d){var e=b.current().Merge_framesMerge,f=b.current().Merge_framesCount,g="undefined";null==e||null==f?g="orange":(e/f>=.3&&(g="orange"),e/f>=.7&&(g="undefined"),.3>e/f&&(g="red"));try{a.write(g)}catch(h){a.write(b.current()[d.key])}return a},dust.helpers.fileName=function(a,b,c,d){var e=b.current().filePath;if(e)try{var f=e.substring(e.lastIndexOf("/")+1);a.write(f.substring(0,f.indexOf(".")))}catch(g){a.write(b.current()[d.key])}return a},dust.helpers.formatDate=function(a,b,c,d){if(d.date&&d.date)if(null!=d.format)try{formatted=moment(new Date(d.date)).format(d.format),a.write(formatted)}catch(e){a.write(d.date)}else a.write(d.date);return a},Exi.prototype.addTimer=function(a){this.timers.push(a),console.log(this.timers)},Exi.prototype.clearTimers=function(){for(var a=0;a<this.timers.length;a++)clearTimeout(this.timers[a]);this.timers=[],console.log(this.timers)},Exi.prototype.appendDataAdapterParameters=function(a){if(a||(a={}),EXI.credentialManager.getCredentials()[0]&&!EXI.credentialManager.getCredentials()[0].isValid())return void(location.hash="/welcome");var b=EXI.credentialManager.getConnections();return b.length>0&&(a.url=b[0].url,a.token=b[0].token,a.proposal=b[0].proposal),a},Exi.prototype.getDataAdapter=function(a){var b=new DataAdapterFactory(this.appendDataAdapterParameters(a));return b},Exi.prototype.setAnonymousMenu=function(){this.mainMenu=this.anonymousMenu,Ext.getCmp("mainMenu").removeAll(),Ext.getCmp("mainMenu").add(EXI.mainMenu.getPanel())},Exi.prototype.setUserMenu=function(){this.mainMenu=this.userMenu,Ext.getCmp("mainMenu").removeAll(),Ext.getCmp("mainMenu").add(EXI.mainMenu.getPanel())},Exi.prototype.setManagerMenu=function(){this.mainMenu=this.managerMenu,Ext.getCmp("mainMenu").removeAll(),Ext.getCmp("mainMenu").add(EXI.mainMenu.getPanel())},Exi.prototype.manageMenu=function(a){a.isManager()?this.setManagerMenu():this.setUserMenu(),this.mainMenu.populateCredentialsMenu()},Exi.prototype.loadSelected=function(a){},Exi.prototype.addMainPanel=function(a){this.keepTabs||Ext.getCmp("main_panel").removeAll(),Ext.getCmp("main_panel").add(a.getPanel()),Ext.getCmp("main_panel").setActiveTab(Ext.getCmp("main_panel").items.length-1),this.clearTimers()},Exi.prototype.addMainPanelWithTimer=function(a){this.keepTabs||Ext.getCmp("main_panel").removeAll(),Ext.getCmp("main_panel").add(a.getPanel()),Ext.getCmp("main_panel").setActiveTab(Ext.getCmp("main_panel").items.length-1)},Exi.prototype.getSelectedDataCollections=function(){for(var a=[],b=0;b<this.experimentListView.length;b++)a=a.concat(this.experimentListView[b].getSelected());return a},Exi.prototype.addNavigationPanel=function(a){Ext.getCmp("navigation").add(a.getPanel()),null!=Ext.getCmp("navigation")&&(Ext.getCmp("navigation").expand(),this.showNavigationPanel()),this.clearTimers()},Exi.prototype.addNavigationPanelWithTimer=function(a){Ext.getCmp("navigation").add(a.getPanel()),null!=Ext.getCmp("navigation")&&(Ext.getCmp("navigation").expand(),this.showNavigationPanel())},Exi.prototype.hideNavigationPanel=function(a){null!=Ext.getCmp("navigation")&&Ext.getCmp("navigation").hide()},Exi.prototype.showNavigationPanel=function(a){null!=Ext.getCmp("navigation")&&Ext.getCmp("navigation").show()},Exi.prototype.clearNavigationPanel=function(){Ext.getCmp("navigation").removeAll()},Exi.prototype.clearMainPanel=function(){Ext.getCmp("main_panel").removeAll()},Exi.prototype.setLoadingNavigationPanel=function(a){Ext.getCmp("navigation").setLoading(a)},Exi.prototype.setLoadingMainPanel=function(a){Ext.getCmp("main_panel").setLoading(a)},Exi.prototype.setError=function(a){this.mainStatusBar.showError(a)},Exi.prototype.setLoading=function(a){null==a||1==a?this.mainStatusBar.showBusy():this.mainStatusBar.showReady()},Exi.prototype.getHeader=function(a){return'<img class="titleImage" src="images/logo_EMBL.png"><span class="title">Extended ISPyB</span>'},Exi.prototype.show=function(){var a=this;Ext.application({name:"ExiSAXS",launch:function(){Ext.create("Ext.container.Viewport",{layout:"border",items:[{region:"north",xtype:"component",padding:10,height:75,html:a.getHeader(),cls:a.headerCssClass},{region:"north",cls:"toolbarPanel",id:"mainMenu",xtype:"panel",width:400,items:a.mainMenu.getPanel()},{xtype:"panel",id:"navigation",region:"west",width:250,split:!1,title:"Select",cls:"navigation",collapsible:!0,collapsed:!0},{region:"center",id:"main_panel",xtype:"tabpanel",cls:"navigation",plain:!0,items:[]},{region:"south",xtype:"panel",cls:"statusBar",bbar:a.mainStatusBar.getBar()}],listeners:{afterrender:function(b,c){if(a.mainMenu.populateCredentialsMenu(),a.onAfterRender.notify(),0==a.credentialManager.getCredentials())a.setAnonymousMenu();else{var d=a.credentialManager.getCredentials()[0];a.manageMenu(d)}}}})}})},MainStatusBar.prototype.getBar=function(){return this.statusBar=Ext.create("Ext.ux.StatusBar",{id:"main-status-bar",text:"Ready",iconCls:"accept",busyIconCls:"busy",busyText:this.busyText,cls:"statusBar",statusAlign:"right"}),this.statusBar},MainStatusBar.prototype.showBusy=function(a){null==a&&(a="Connecting to servers..."),this.statusBar.busyText=a,this.statusBar.showBusy()},MainStatusBar.prototype.showError=function(a){this.statusBar.clearStatus(),this.statusBar.setStatus({text:a,iconCls:"error"})},MainStatusBar.prototype.showReady=function(){this.statusBar.clearStatus(),this.statusBar.setStatus({text:"Ready",iconCls:"accept"})},ProposalManager.prototype.get=function(a){var b=this;if(null==localStorage.getItem("proposals")||a){var c=function(a,c){localStorage.setItem("proposals",JSON.stringify(c)),b.onActiveProposalChanged.notify()};EXI.getDataAdapter({async:!1,onSuccess:c}).proposal.proposal.getProposalsInfo()}return JSON.parse(localStorage.getItem("proposals"))},ProposalManager.prototype.clear=function(){localStorage.removeItem("proposals")},ProposalManager.prototype.getSessions=function(){if(null==localStorage.getItem("sessions")){var a=function(a,b){localStorage.setItem("sessions",JSON.stringify(b))};EXI.getDataAdapter({async:!1,onSuccess:a}).proposal.session.getSessions()}return JSON.parse(localStorage.getItem("sessions"))},ProposalManager.prototype.getFutureSessions=function(){for(var a=this.getSessions(),b=moment(),c=[],d=0;d<a.length;d++)b.diff(a[d].BLSession_startDate)<0&&c.push(a[d]);return c},ProposalManager.prototype.getBufferColors=function(){return["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"]},ProposalManager.prototype.getLabcontacts=function(){return this.get()[0].labcontacts},ProposalManager.prototype.getLabcontactById=function(a){return _.find(this.getLabcontacts(),function(b){return b.labContactId==a})},ProposalManager.prototype.getPlateTypeById=function(a){return _.find(this.getPlateTypes(),function(b){return b.plateTypeId==a})},ProposalManager.prototype.getPlateTypes=function(){return this.get()[0].plateTypes},ProposalManager.prototype.getPlateByFlavour=function(a){return[this.getPlateTypes()[0],this.getPlateTypes()[2],this.getPlateTypes()[3]]},ProposalManager.prototype.getBufferById=function(a){for(var b=this.get(),c=function(b){return b.bufferId==a},d=0;d<b.length;d++){var e=_.find(b[d].buffers,c);if(null!=e)return e}},ProposalManager.prototype.getMacromoleculeById=function(a){for(var b=this.get(),c=function(b){return b.macromoleculeId==a},d=0;d<b.length;d++){var e=_.find(b[d].macromolecules,c);if(null!=e)return e}return null},ProposalManager.prototype.getMacromoleculeByAcronym=function(a){for(var b=this.get(),c=function(b){return b.acronym==a},d=0;d<b.length;d++){var e=_.find(b[d].macromolecules,c);if(null!=e)return e}return null},ProposalManager.prototype.getStockSolutionById=function(a){for(var b=this.get(),c=function(b){return b.stockSolutionId==a},d=0;d<b.length;d++){var e=_.find(b[d].stockSolutions,c);if(null!=e)return e}},ProposalManager.prototype.getBuffers=function(){for(var a=this.get(),b=[],c=0;c<a.length;c++)b=b.concat(a[c].buffers);return b},ProposalManager.prototype.getMacromolecules=function(){for(var a=this.get(),b=[],c=0;c<a.length;c++)b=b.concat(a[c].macromolecules);return b},ProposalManager.prototype.getProposals=function(){for(var a=this.get(),b=[],c=0;c<a.length;c++)a[c].proposal[0].proposal=a[c].proposal[0].code+a[c].proposal[0].number,b=b.concat(a[c].proposal);return b},ProposalManager.prototype.getProposalById=function(a){for(var b=this.get(),c=[],d=0;d<b.length;d++)if(b[d].proposal[0].proposalId==a)return b[d].proposal[0];return c},ProposalManager.prototype.getStockSolutions=function(){return this.get()[0].stockSolutions},ProposalManager.prototype.getProteins=function(){return this.get()[0].proteins},ProposalManager.prototype.getCrystals=function(){return this.get()[0].crystals},ProposalManager.prototype.getProteinByAcronym=function(a){return _.filter(this.getProteins(),function(b){return b.acronym==a})},ProposalManager.prototype.getCrystalsByAcronym=function(a){return _.filter(this.getCrystals(),function(b){return null==b.proteinVO?!1:b.proteinVO.acronym==a})},ProposalManager.prototype.getStockSolutionsBySpecimen=function(a,b){var c=_.filter(this.getStockSolutions(),function(b){return b.macromoleculeId==a});return _.filter(c,function(a){return a.bufferId==b})},ProposalManager.prototype.getUnpackedStockSolutions=function(){for(var a=this.getStockSolutions(),b=[],c=0;c<a.length;c++)null==a[c].boxId&&b.push(a[c]);return b},ProposalManager.prototype.getStockSolutionsByDewarId=function(a){return _.filter(this.getStockSolutions(),function(b){return b.boxId==a})},ExiGenericController.prototype.setPageBackground=function(){},ExiGenericController.prototype.notFound=function(){},MainView.prototype.getContainer=function(){return this.container},MainView.prototype.getPanel=function(){return this.container=Ext.create("Ext.container.Container",{xtype:"container",items:[]}),this.panel=Ext.create("Ext.panel.Panel",{autoScroll:!0,title:this.title,closable:this.closable,icon:this.icon,bodyStyle:this.bodyStyle,items:[this.getContainer()]}),this.panel},AuthenticationManager.prototype.login=function(a,b,c){var d=this,e=function(b,e){d.onSuccess.notify({user:a,roles:e.roles,token:e.token,url:c})},f=function(a,b){EXI.setError("Permission denied"),BUI.showError("Your credentials are invalid")};EXI.getDataAdapter({onSuccess:e,onError:f,url:c,username:a}).proposal.authentication.authenticate(a,b,c)},ExiController.prototype.loadNavigationPanel=function(a){EXI.clearNavigationPanel(),EXI.setLoadingNavigationPanel(!0);var b=function(b,c){EXI.addNavigationPanel(a),a.load(c),EXI.setLoadingNavigationPanel(!1)},c=function(a,b){EXI.setLoadingNavigationPanel(!1)};return EXI.getDataAdapter({onSuccess:b,onError:c})},ExiController.prototype.init=function(){function a(){}function b(){}Path.map("#/").to(function(){location.hash="/welcome"}).enter(a),Path.map("#/login").to(function(){EXI.credentialManager.logout(),EXI.authenticationForm.show()}).enter(a),Path.map("#/welcome").to(function(){EXI.credentialManager.logout(),EXI.authenticationForm.show()}).enter(a),Path.map("#/welcome/user/:user/main").to(function(){var a=this.params.user,b=new ManagerWelcomeMainView;EXI.addMainPanel(b),EXI.hideNavigationPanel(),b.load(a)}).enter(a),Path.map("#/welcome/manager/:user/main").to(function(){var a=this.params.user,b=new ManagerWelcomeMainView;EXI.addMainPanel(b),EXI.hideNavigationPanel(),b.load(a)}).enter(a),Path.map("#/welcome/manager/:user/date/:start/:end/main").to(function(){var a=this.params.user,b=new ManagerWelcomeMainView;EXI.addMainPanel(b),EXI.hideNavigationPanel(),b.loadSessionsByDate(a,this.params.start,this.params.end)}).enter(a),Path.map("#/logout").to(function(){EXI.credentialManager.logout(),EXI.hideNavigationPanel(),EXI.proposalManager.clear()}).enter(a),Path.root("#/"),Path.rescue(b)},ExiGenericController.prototype.setPageBackground=function(){},ExiGenericController.prototype.notFound=function(){},LabContactExiController.prototype.loadNavigationPanel=ExiController.prototype.loadNavigationPanel,LabContactExiController.prototype.setPageBackground=function(){},LabContactExiController.prototype.notFound=function(){},LabContactExiController.prototype.init=function(){function a(a){return b.loadNavigationPanel(a)}var b=this,c=null,d=null;Path.map("#/proposal/addresses/nav").to(function(){EXI.clearNavigationPanel(),EXI.setLoadingNavigationPanel(!0),c=new AddressListView,c.onSelect.attach(function(a,b){location.hash="/proposal/address/"+b[0].labContactId+"/main"}),EXI.addNavigationPanel(c),d=a(c),d.proposal.labcontacts.getLabContacts()}).enter(this.setPageBackground),Path.map("#/proposal/address/:labcontactId/main").to(function(){var a=new AddressMainView;EXI.addMainPanel(a),a.load(this.params.labcontactId)}).enter(this.setPageBackground)},OfflineExiController.prototype.setPageBackground=function(){},OfflineExiController.prototype.notFound=function(){},OfflineExiController.prototype.init=function(){function a(){b.notFound()}var b=this;Path.map("#/tool/dimple/main").to(function(){var a=new DimpleMainView;EXI.addMainPanel(a),a.load()}).enter(this.setPageBackground),Path.map("#/tool/dimple/datacollection/:dataCollectionId/main").to(function(){var a=new DimpleDCMainView;EXI.addMainPanel(a),a.load(this.params.dataCollectionId)}).enter(this.setPageBackground),Path.map("#/tool/reprocess/datacollection/:dataCollectionId/:startImage/:endImage/main").to(function(){var a=new ReprocessMainView;EXI.addMainPanel(a),a.load(this.params.dataCollectionId,this.params.startImage,this.params.endImage)}).enter(this.setPageBackground),Path.map("#/tool/crysol/main").to(function(){var a=new CrysolMainView;EXI.addMainPanel(a),a.load()}).enter(this.setPageBackground),Path.map("#/tool/subtraction/main").to(function(){var a=new SubtractionMainView;EXI.addMainPanel(a),a.load()}).enter(this.setPageBackground),Path.map("#/tool/list").to(function(){var a=null,b=new RunListView;b.onSelect.attach(function(b,c){var d=c[0].internalId,e=a.internalId;"Dimple"==c[0].tool?location.hash="/project/"+e+"/dimple/"+d+"/main":location.hash="/project/"+e+"/run/"+d+"/main"}),EXI.clearNavigationPanel(),EXI.setLoadingNavigationPanel(!0);var c=function(c,d){a=d[0],EXI.addNavigationPanel(b),b.load(d[0].runs.reverse()),EXI.setLoadingNavigationPanel(!1)},d=function(a,b){EXI.setLoadingNavigationPanel(!1)};EXI.getDataAdapter({onSuccess:c,onError:d}).exi.offline.getProject()}).enter(this.setPageBackground),Path.map("#/project/:projectId/run/:runId/main").to(function(){var a=this.params.projectId,b=this.params.runId,c=function(a,c){for(var d=0;d<c.length;d++)if(c[d].internalId==b){var e=new RunMainView;EXI.addMainPanel(e),e.load(c[d])}},d=function(a){BUI.showError("There was an error")};EXI.getDataAdapter({onSuccess:c,onError:d}).exi.offline.getRuns(a)}).enter(this.setPageBackground),Path.map("#/project/:projectId/dimple/:runId/main").to(function(){var a=this.params.projectId,b=this.params.runId,c=function(a,c){for(var d=0;d<c.length;d++)if(c[d].internalId==b){var e=new DimpleRunMainView;EXI.addMainPanel(e),e.load(c[d])}},d=function(a){BUI.showError("There was an error")};EXI.getDataAdapter({onSuccess:c,onError:d}).exi.offline.getRuns(a)}).enter(this.setPageBackground),Path.rescue(a)},ProposalExiController.prototype.loadNavigationPanel=ExiController.prototype.loadNavigationPanel,ProposalExiController.prototype.setPageBackground=function(){},ProposalExiController.prototype.notFound=function(){},ProposalExiController.prototype.init=function(){function a(a){return b.loadNavigationPanel(a)}var b=this,c=null,d=null;Path.map("#/proposal/session/nav").to(function(){c=new SessionListView,c.onSelect.attach(function(a,b){"SAXS"==EXI.credentialManager.getTechniqueByBeamline(b[0].beamlineName)?location.hash="/session/nav/"+b[0].sessionId+"/session":location.hash="/mx/datacollection/session/"+b[0].sessionId+"/main"}),d=a(c),d.proposal.session.getSessions()}).enter(this.setPageBackground),Path.map("#/proposal/address/:lacontactId/main").to(function(){var a=new AddressMainView;EXI.addMainPanel(a),a.load(this.params.lacontactId)}).enter(this.setPageBackground),Path.map("#/puck/:containerId/main").to(function(){var a=new PuckMainView;EXI.addMainPanel(a),a.load(this.params.containerId)}).enter(this.setPageBackground)},SessionController.prototype.setPageBackground=ExiGenericController.prototype.setPageBackground,SessionController.prototype.notFound=ExiGenericController.prototype.notFound,SessionController.prototype.init=function(){Path.map("#/session/nav").to(function(){EXI.clearNavigationPanel(),EXI.hideNavigationPanel();var a=new SessionMainView({title:"Sessions"});EXI.addMainPanel(a);var b=function(b,c){a.load(EXI.proposalManager.getSessions()),EXI.setLoadingMainPanel(!1)};EXI.setLoadingMainPanel(),EXI.getDataAdapter({onSuccess:b}).proposal.session.getSessions()}).enter(this.setPageBackground),Path.rescue(this.notFound)},ShippingExiController.prototype.loadNavigationPanel=ExiController.prototype.loadNavigationPanel,ShippingExiController.prototype.setPageBackground=function(){},ShippingExiController.prototype.notFound=function(){},ShippingExiController.prototype.loadShipmentsNavigationPanel=function(a){EXI.clearNavigationPanel(),EXI.setLoadingMainPanel(!0);var b=function(b,c){c=BUI.groupBy(c,function(a){return a.Shipping_shippingId});for(var d=[],e=0;e<c.length;e++)d.push(c[e][0]);d.sort(function(a,b){return b.Shipping_shippingId-a.Shipping_shippingId});var f=function(b,c){a.dewars=c,EXI.addNavigationPanel(a),a.load(d),EXI.setLoadingMainPanel(!1)};EXI.getDataAdapter({onSuccess:f}).proposal.dewar.getDewarsByProposal()},c=function(a,b){EXI.setLoadingNavigationPanel(!1)};return EXI.getDataAdapter({onSuccess:b,onError:c})},ShippingExiController.prototype.init=function(){function a(){var a=new ShippingListView;a.onSelect.attach(function(a,b){location.hash="/shipping/"+b[0].Shipping_shippingId+"/main"}),c=b.loadShipmentsNavigationPanel(a),c.proposal.shipping.getShippings()}var b=this,c=null;Path.map("#/proposal/shipping/nav?nomain").to(function(){a()}),Path.map("#/proposal/shipping/nav").to(function(){a()}),Path.map("#/shipping/:shippingId/main").to(function(){var a=new ShippingMainView;EXI.addMainPanel(a),a.load(this.params.shippingId)}).enter(this.setPageBackground),Path.map("#/shipping/main").to(function(){var a=new ShippingMainView;EXI.addMainPanel(a),a.load()}).enter(this.setPageBackground),Path.map("#/shipping/:shippingId/:shippingStatus/containerId/:containerId/edit").to(function(){var a=new PuckFormView;EXI.addMainPanel(a),a.load(this.params.containerId,this.params.shippingId,this.params.shippingStatus)}).enter(this.setPageBackground),Path.map("#/shipping/:shippingId/containerId/:containerId/sampleId/:sampleId/editCrystalForm").to(function(){var a=new CrystalFormView;EXI.addMainPanel(a),a.load(this.params.containerId,this.params.sampleId,this.params.shippingId)}).enter(this.setPageBackground)},BootstrapGrid.prototype.getPanel=function(){var a=this;return this.panel=Ext.create("Ext.panel.Panel",{width:this.width,autoScroll:!0,autoHeight:!0,maxHeight:this.height,title:this.data.header,items:[{html:this.getHTML()}]}),this.panel.on("boxready",function(){a.setClickListeners()}),this.panel},BootstrapGrid.prototype.setClickListeners=function(){var a=this;$("#bootstrap-table-"+this.id).unbind("click").on("click",".clickable-row",function(b){$(this).addClass("active-step").siblings().removeClass("active-step"),a.rowSelected.notify(b.target.innerText)})},BootstrapGrid.prototype.selectRowByValue=function(a){var b=this.data.values.indexOf(a);b>=0&&($("#row-"+b+"-"+this.id).addClass("active-step").siblings().removeClass("active-step"),this.rowSelected.notify($("#row-"+b+"-"+this.id)[0].innerText))},BootstrapGrid.prototype.deselectAll=function(){$("#bootstrap-table-"+this.id).find(".clickable-row").removeClass("active-step")},BootstrapGrid.prototype.getHTML=function(){var a="";return dust.render(this.template,this.data,function(b,c){a=c}),"<div id='bootstrap-grid-"+this.id+"'>"+a+"</div>"},BootstrapGrid.prototype.load=function(a){this.data=a,this.data.id=this.id,$("#bootstrap-grid"+this.id).length&&(this.panel.setTitle(a.header),$("#bootstrap-grid"+this.id).html(this.getHTML()),this.setClickListeners())},MainMenu.prototype.getMenuItems=function(){return[]},MainMenu.prototype.getHomeItem=function(){return{text:this._convertToHTMLWhiteSpan("Home"),cls:"ExiSAXSMenuToolBar",icon:"../images/icon/rsz_ic_home_black_24dp.png",handler:function(){if(null!=EXI.credentialManager.getCredentials())if(EXI.credentialManager.getCredentials().length>0){var a=EXI.credentialManager.getCredentials()[0].username,b=EXI.credentialManager.getCredentialByUserName(EXI.credentialManager.getCredentials()[0].username);b.isManager()?location.hash="/welcome/manager/"+a+"/main":location.hash="/welcome/user/"+a+"/main"}else BUI.showError("You should sign up");else BUI.showError("You should sign up")}}},MainMenu.prototype.getShipmentItem=function(){function a(){function a(a,b){"Stock Solutions"==a.text&&(location.hash="/saxs/stocksolution/nav")}return Ext.create("Ext.menu.Menu",{items:[{text:"Stock Solutions",icon:"../images/icon/testtube.png",handler:a}]})}function b(){function a(a,b){if("Add new"==a.text){var c=new AddressEditForm;c.onSaved.attach(function(a,b){d.close(),location.hash="#/proposal/address/"+b.labContactId+"/main"});var d=Ext.create("Ext.window.Window",{title:"Shipping Address Card",height:550,width:750,modal:!0,layout:"fit",items:[c.getPanel()],buttons:[{text:"Save",handler:function(){c.save()}},{text:"Cancel",handler:function(){d.close()}}]}).show();c.load()}else"List"==a.text&&(location.hash="/proposal/addresses/nav")}return Ext.create("Ext.menu.Menu",{items:[{text:"Add new",icon:"../images/icon/add.png",handler:a,disabled:!0},{text:"List",icon:"../images/icon/ic_list_black_24dp.png",handler:a}]})}function c(){function a(a,b){if("Add new"==a.text){var c=new ShipmentEditForm({width:600,height:700});c.onSaved.attach(function(a,b){d.close(),location.hash="#/shipping/"+b.shippingId+"/main"});var d=Ext.create("Ext.window.Window",{title:"Shipment",height:500,width:650,padding:"10 10 10 10",modal:!0,layout:"fit",items:[c.getPanel()],buttons:[{text:"Save",handler:function(){c.saveShipment()}},{text:"Cancel",handler:function(){d.close()}}]}).show();c.load()}else"List"==a.text&&(location.hash="/proposal/shipping/nav")}return Ext.create("Ext.menu.Menu",{items:[{text:"Add new",icon:"../images/icon/add.png",handler:a},{text:"List",icon:"../images/icon/ic_list_black_24dp.png",handler:a}]})}return{text:this._convertToHTMLWhiteSpan("Shipment"),cls:"ExiSAXSMenuToolBar",disabled:!1,menu:Ext.create("Ext.menu.Menu",{items:[{text:"BioSAXS",icon:"../images/icon/macromolecule.png",menu:a()},{text:"Manage shipping addresses",icon:"../images/icon/contacts.png",menu:b()},{text:"Shipments",icon:"../images/icon/shipping.png",menu:c()}]})}},MainMenu.prototype.getHelpMenu=function(){function a(a,b){"ISPyB Web services API Map"==a.text&&window.open("/exi/documentation/ispyb-api-ws/print.html"),"Job list"==a.text&&(location.hash="/tool/list")}return Ext.create("Ext.menu.Menu",{items:[{text:"Developer",checked:!1,group:"theme",menu:{items:[{text:"ISPyB Web services API Map",handler:a},{text:"How to retrieve data from ISPyB?",handler:a},{text:"EXI Router",handler:a},{text:"EXI List Views Objects",handler:a},{text:"EXI Main View Objects",handler:a}]}},"-",{text:"About",checked:!1,group:"theme",handler:a}]})},MainMenu.prototype.getAddCredentialMenu=function(){return null!=EXI.credentialManager.getCredentials()&&EXI.credentialManager.getCredentials().length>0?{icon:"../images/icon/rsz_1ic_input_black_24dp.png",height:30,text:"Add",handler:function(){window.location.href="#/login"}}:void 0},MainMenu.prototype.populateCredentialsMenu=function(){this.credentialsMenu.removeAll();var a="";if(null!=EXI.credentialManager.getCredentials())for(var b=0;b<EXI.credentialManager.getCredentials().length;b++)if(a=EXI.credentialManager.getCredentials()[b].username,EXI.credentialManager.getCredentials()[b].activeProposals.length>0)for(var c=0;c<EXI.credentialManager.getCredentials()[b].activeProposals.length;c++)a=EXI.credentialManager.getCredentials()[b].activeProposals[c]+"@"+EXI.credentialManager.getCredentials()[b].username,this.credentialsMenu.add({text:a,icon:"../images/icon/rsz_esrflogo80.gif",disabled:!0});else this.credentialsMenu.add({text:a,icon:"../images/icon/rsz_esrflogo80.gif",disabled:!0});EXI.credentialManager.getCredentials().length>0?(Ext.getCmp(this.loginButtonId).setText("<span style='color:white'>Log out <span style='font-weight:bold;'>"+a+" </span> </span>"),Ext.getCmp(this.loginButtonId).setIcon("../images/rsz_logout.png")):(Ext.getCmp(this.loginButtonId).setText("<span style='color:white'>Sign In</span>"),Ext.getCmp(this.loginButtonId).setIcon("../images/rsz_login.png"))},MainMenu.prototype._convertToHTMLWhiteSpan=function(a){return'<span style="color:white">'+a+"</span>"},MainMenu.prototype.isLoggedIn=function(){return EXI.credentialManager.getCredentials().length>0},MainMenu.prototype.getLoginButton=function(){var a="../images/rsz_login.png",b=this._convertToHTMLWhiteSpan("Sign In");return EXI.credentialManager.getCredentials().length>0&&(a="../images/rsz_logout.png",b=this._convertToHTMLWhiteSpan("log out")),{xtype:"splitbutton",id:this.loginButtonId,text:b,cls:"button_log_out",icon:a,menu:this.credentialsMenu,handler:function(){0==EXI.credentialManager.getCredentials().length?location.hash="/login":location.hash="/logout"}}},MainMenu.prototype.getPanel=function(){this.credentialsMenu=new Ext.menu.Menu({id:this.id+"menu",items:[this.getAddCredentialMenu()]});var a=this.getMenuItems();return a.push("->"),a.push(this.getLoginButton()),this.tb=Ext.create("Ext.toolbar.Toolbar",{cls:this.cssClass,items:a}),this.tb},ManagerMenu.prototype.populateCredentialsMenu=MainMenu.prototype.populateCredentialsMenu,ManagerMenu.prototype.init=MainMenu.prototype.init,ManagerMenu.prototype.getPanel=MainMenu.prototype.getPanel,ManagerMenu.prototype._convertToHTMLWhiteSpan=MainMenu.prototype._convertToHTMLWhiteSpan,ManagerMenu.prototype.getAddCredentialMenu=MainMenu.prototype.getAddCredentialMenu,ManagerMenu.prototype.getLoginButton=MainMenu.prototype.getLoginButton,ManagerMenu.prototype.setText=MainMenu.prototype.setText,ManagerMenu.prototype.getHelpMenu=MainMenu.prototype.getHelpMenu,ManagerMenu.prototype.getHomeItem=MainMenu.prototype.getHomeItem,ManagerMenu.prototype.getShipmentItem=MainMenu.prototype.getShipmentItem,ManagerMenu.prototype.getMenuItems=function(){return[this.getHomeItem(),this.getShipmentItem(),{text:this._convertToHTMLWhiteSpan("Prepare Experiment"),cls:"ExiSAXSMenuToolBar",hidden:this.isHidden,disabled:!0,menu:this.getPreparationMenu()},{text:this._convertToHTMLWhiteSpan("Data Explorer"),
cls:"ExiSAXSMenuToolBar",hidden:this.isHidden,menu:this.getDataExplorerMenu()},{text:this._convertToHTMLWhiteSpan("Help"),cls:"ExiSAXSMenuToolBar",menu:this.getHelpMenu()},"->",{xtype:"textfield",name:"field1",emptyText:"search macromolecule",hidden:this.isHidden,listeners:{specialkey:function(a,b){b.getKey()==b.ENTER&&(location.hash="/datacollection/macromoleculeAcronym/"+a.getValue()+"/main")}}}]},ManagerMenu.prototype.getPreparationMenu=function(){function a(a,b){"Macromolecules"==a.text&&(location.hash="/saxs/macromolecule/nav"),"Buffers"==a.text&&(location.hash="/saxs/buffer/nav"),"Sample Tracking"==a.text&&(location.hash="/saxs/shipping/nav"),"My Experiments"==a.text&&(location.hash="/saxs/template/nav")}return Ext.create("Ext.menu.Menu",{items:[{text:"Macromolecules",icon:"../images/icon/macromolecule.png",handler:a},{text:"Buffers",icon:"../images/icon/buffer.jpg",handler:a},"-",{text:"My Experiments",icon:"../images/icon/edit.png",handler:a}]})},ManagerMenu.prototype.getDataReductionMenu=function(){function a(a,c){"Sessions"==a.text&&b.onSessionClicked.notify(),"Subtraction"==a.text&&(location.hash="/tool/subtraction/main"),"Experiments"==a.text&&b.onExperimentClicked.notify()}var b=this;return Ext.create("Ext.menu.Menu",{items:[{text:'<span class="menuCategoryItem">SEC</span>'},"-",{text:"Background Test"},{text:"Baseline Checker"},{text:"Frame Merge"},"-",{text:'<span class="menuCategoryItem">INDIVIDUAL CONCENTRATION</span>'},"-",{text:"Subtraction",checked:!1,group:"theme",checkHandler:a},{text:"Average"},"-",{text:'<span class="menuCategoryItem">COMBINING</span>'},"-",{text:"Merging tool"}]})},ManagerMenu.prototype.getDataExplorerMenu=function(){function a(a,b){"Calendar"==a.text&&(location.hash="/session/nav"),"Experiments"==a.text&&(location.hash="/experiment/nav")}return Ext.create("Ext.menu.Menu",{items:[{text:"Calendar",icon:"../images/icon/sessions.png",handler:a}]})},ManagerMenu.prototype.getOnlineDataAnalisysMenu=function(){function a(a,b){"Structure Validation"==a.text&&(location.hash="/tool/crysol/main"),"Job list"==a.text&&(location.hash="/tool/list")}return Ext.create("Ext.menu.Menu",{items:[{text:"Structure Validation",checked:!1,group:"theme",handler:a},"-",{text:"Job list",checked:!1,group:"theme",handler:a}]})},ListView.prototype.getSorters=function(){return{}},ListView.prototype.getFilter=function(a){return null},ListView.prototype.load=function(a){this.data=a,null!=this.formatData?this.store.loadData(this.formatData(a)):this.store.loadData(a)},ListView.prototype.getColumns=function(){var a=this;return[{text:this.title,flex:1,dataIndex:"shippingId",renderer:function(b,c,d){return a.getRow(d)}}]},ListView.prototype.getFields=function(){return[]},ListView.prototype.getPanel=function(){var a=this;return this.store=Ext.create("Ext.data.Store",{fields:this.getFields(),data:[],sorters:this.sorters,proxy:{type:"memory",reader:{type:"json"}}}),this.panel=Ext.create("Ext.grid.Panel",{store:this.store,layout:"fit",columns:this.getColumns(),width:this.width,height:this.height,multiSelect:!0,dockedItems:[{xtype:"toolbar",dock:"bottom",cls:"x-toolbar",height:42,items:[{xtype:"textfield",name:"searchField",hideLabel:!0,width:200,hidden:null==a.getFilter(),emptyText:"Search...",listeners:{change:function(b,c){var d=b.getValue();""!=d?a.store.filter(a.getFilter(d)):(a.store.clearFilter(!0),a.load(a.data))}}}]}],viewConfig:{emptyText:"No items to display",enableTextSelection:!0,preserveScrollOnRefresh:!0,stripeRows:!0}}),this.panel.on("selectionchange",function(b,c){var d=[];for(var e in c)d.push(c[e].data);a.onSelect.notify(d)}),this.panel},AddressListView.prototype.getPanel=ListView.prototype.getPanel,AddressListView.prototype.load=ListView.prototype.load,AddressListView.prototype.getFields=ListView.prototype.getFields,AddressListView.prototype.getColumns=ListView.prototype.getColumns,AddressListView.prototype.getFilter=function(a){return[{property:"cardName",value:a,anyMatch:!0}]},AddressListView.prototype.getRow=function(a){var b="";return dust.render("address.listview",a.data,function(a,c){b=c}),b},RunListView.prototype.getPanel=ListView.prototype.getPanel,RunListView.prototype.load=ListView.prototype.load,RunListView.prototype.getFilter=function(a){return[{property:"name",value:a,anyMatch:!0}]},RunListView.prototype.formatStatus=function(a){return"FINISHED"==a?"<span style='color:green;font-weight:bold;'>"+a+"</span>":"<span style='color:orange;font-weight:bold;'>"+a+"</span>"},RunListView.prototype.formatJobs=function(a){for(var b="<table>",c=0;c<a.length;c++)b=b+"<tr><td>"+a[c].name+"</td></tr>";return b+"</table>"},RunListView.prototype.getRow=function(a){var b="<table class='listView'>";return b=b+"<tr><td>Name:</td><td>"+a.data.name+"</td></tr>",b=b+"<tr><td>Status:</td><td>"+this.formatStatus(a.data.status)+"</td></tr>",b=b+"<tr><td>Jobs:</td><td>"+this.formatJobs(a.data.jobs)+"</td></tr>",b=b+"<tr><td>Date:</td><td>"+a.data.creationDate+"</td></tr>",b+"</table>"},RunListView.prototype.getColumns=function(){var a=this;return[{text:"Jobs",flex:1,dataIndex:"sessionId",renderer:function(b,c,d){return a.getRow(d)}}]},RunListView.prototype.getFields=function(){return["name","status","creationDate","jobs"]},SessionListView.prototype.getPanel=ListView.prototype.getPanel,SessionListView.prototype.load=ListView.prototype.load,SessionListView.prototype.getFilter=function(a){return[{property:"beamlineName",value:a,anyMatch:!0}]},SessionListView.prototype.formatData=function(a){for(var b=0;b<a.length;b++)a[b].day=moment(a[b].BLSession_startDate).format("Do"),a[b].year=moment(a[b].BLSession_startDate).format("YYYY"),a[b].month=moment(a[b].BLSession_startDate).format("MMM");return a},SessionListView.prototype.getRow=function(a){var b="";return dust.render("session.listview",a.data,function(a,c){b+=c}),b},SessionListView.prototype.getColumns=function(){var a=this;return[{text:"Session",flex:1,dataIndex:"sessionId",renderer:function(b,c,d){return a.getRow(d)}}]},SessionListView.prototype.getFields=function(){return["date"]},ShippingListView.prototype.getPanel=ListView.prototype.getPanel,ShippingListView.prototype.load=ListView.prototype.load,ShippingListView.prototype.getFilter=ListView.prototype.getFilter,ShippingListView.prototype.getFields=ListView.prototype.getFields,ShippingListView.prototype.getColumns=ListView.prototype.getColumns,ShippingListView.prototype.getStatsByShippingId=function(a){if(this.dewars){var b=_.filter(this.dewars,function(b){return b.shippingId==a}),c=0;return _(b).forEach(function(a){c+=a.sampleCount}),{samples:c,dewars:Object.keys(_.groupBy(b,"dewarId")).length,containers:b.length}}return null},ShippingListView.prototype.getRow=function(a){var b="";return a.data.formattedCreationDate=moment(new Date(a.data.Shipping_creationDate)).format("DD-MM-YYYY"),a.data.stats=this.getStatsByShippingId(a.data.Shipping_shippingId),dust.render("shipping.listview",a.data,function(a,c){b=c}),b},WorkSpaceListView.prototype.loadProjects=function(a){null!=a&&this.projectStore.loadData(a),this.loadRuns()},WorkSpaceListView.prototype.loadRuns=function(){var a=this,b=new ExiDataAdapter;b.onSuccess.attach(function(b,c){a.runStore.loadData(c.reverse()),a.runGrid.setLoading(!1)}),this.runGrid.setLoading(),this.projectId=exiSAXS.localExtorage.userManager.getActiveProject().internalId,b.getRuns(exiSAXS.localExtorage.userManager.getActiveProject().internalId)},WorkSpaceListView.prototype.setSelectedItems=function(a){for(var b=0;b<a.length;b++)delete a[b].id;this.selection.loadData(a),this.projectGrid.collapse()},WorkSpaceListView.prototype.getSelectionPanel=function(){function a(a,b){if(null!=a&&null!=b){if(.3>a/b)return"<span style='color:red;'>"+a+"/"+b+"</span>";if(.7>a/b)return"<span style='color:orange;'>"+a+"/"+b+"</span>"}return a+"/"+b}function b(a){"yes"==a&&exiSAXS.localExtorage.selectedSubtractionsManager.remove(record.data)}return this.selection=Ext.create("Ext.data.Store",{fields:["subtractionId","scattering","macromoleculeAcronym","concentration","framesMerge","framesCount","exposureTemperature"]}),this.selectionGrid=Ext.create("Ext.grid.Panel",{store:this.selection,title:"Selection",emptyText:"No selection",tbar:this.selectionMenu.getPanel(),columns:[{text:"",dataIndex:"scattering",renderer:function(a,b,c){return"<img src="+(new DataAdapter).getImage(c.data.subtractionId,"scattering")+'   height="70" width="70" >'}},{text:"",dataIndex:"macromoleculeAcronym",flex:.8,renderer:function(b,c,d){return d.data.macromoleculeAcronym+"<br />"+BUI.formatValuesUnits(d.data.concentration,"mg/ml",7,2)+"<br />"+d.data.exposureTemperature+"<span class='key_subgrid'> C</span><br />"+a(d.data.framesMerge,d.data.framesCount)}},{text:"",id:"remove",dataIndex:"scattering",width:50,renderer:function(a){return'<br /><img style="cursor: pointer; height:30px;width:30px;" src="images/icon/ic_highlight_remove_black_24dp.png" />'}}],width:200,listeners:{cellclick:function(a,c,d,e,f,g,h,i){2==d&&Ext.Msg.show({title:"Discard subtraction?",msg:"Your are discarding a selected subtraction. You may re-add it afterwards. Would you like to discard it?",buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,fn:b,height:150})}}}),this.selectionGrid},WorkSpaceListView.prototype.getProjectPanel=function(){return this.projectStore=Ext.create("Ext.data.Store",{fields:["name"]}),this.projectGrid=Ext.create("Ext.grid.Panel",{store:this.projectStore,title:"Projects",emptyText:"No projects",columns:[{text:"Name",dataIndex:"name",flex:1,renderer:function(a,b,c){var d="<span class='projectName'>"+c.data.name+"</span><br/><span class='projectDescription'>"+c.data.description+"</span>";return null!=c.data.subtractions&&(d=d+"<br />"+c.data.subtractions.length+" datasets selected"),d}}],height:200}),this.projectGrid},WorkSpaceListView.prototype.getRunPanel=function(){var a=this;return this.runStore=Ext.create("Ext.data.Store",{fields:["name"]}),this.runGrid=Ext.create("Ext.grid.Panel",{store:this.runStore,title:"Run",emptyText:"No Runs",minHeight:600,dockedItems:[{xtype:"toolbar",dock:"bottom",ui:"footer",items:[{xtype:"component",flex:1},{xtype:"button",text:"Refresh",handler:function(b,c,d){a.loadRuns()}}]}],columns:[{text:"Name",dataIndex:"name",flex:1,renderer:function(a,b,c){var d=c.data.jobs,e="<table>";if(e=e+"<tr ><td  class='nameRun'>"+c.data.name+"</td></tr>",e=e+"<tr ><td  class='statusRun'>"+c.data.status+"</td></tr>",e=e+"<tr ><td  class='dateRun'>"+c.data.creationDate+"</td></tr>",null!=d)for(var f=0;f<d.length;f++)e=e+"<tr ><td class='jobRow'>"+d[f].name+"</td><td>"+d[f].status+"</td></tr>";return e+"</table>"}}],height:200}),this.runGrid.on("select",function(b,c,d,e){location.hash="/project/"+a.projectId+"/run/"+c.data.internalId+"/main"}),this.runGrid},WorkSpaceListView.prototype.getPanel=function(){var a=this;return this.panel=Ext.create("Ext.panel.Panel",{layout:"fit",autoScroll:!0,defaults:{bodyStyle:"padding:15px"},items:[a.getSelectionPanel(),a.getProjectPanel(),a.getRunPanel()]}),this.panel},Credential.prototype.isManager=function(){return this._checkRole("manager")},Credential.prototype.isLocalContact=function(){return this._checkRole("localcontact")},Credential.prototype._checkRole=function(a){return-1!=JSON.stringify(this.roles).toLowerCase().indexOf(a)},Credential.prototype.isValid=function(){return this.timeToExpire()>0},Credential.prototype.timeToExpire=function(){return moment.duration(moment(this.tokenExpires).diff(moment())).asHours()},CredentialManager.prototype.addCredential=function(a,b,c,d,e,f){var g=moment().add(3,"hour"),h=new Credential(a,b,c,d,e,[],g,f);null==localStorage.getItem("credentials")&&localStorage.setItem("credentials","[]");var i=this.getCredentials();i.push(h),localStorage.setItem("credentials",JSON.stringify(i)),this.onLogin.notify(h)},CredentialManager.prototype.credentialToObject=function(a){return new Credential(a.username,a.roles,a.token,a.url,a.exiUrl,a.activeProposals,a.tokenExpires,a.properties)},CredentialManager.prototype.getCredentials=function(){var a=[];null!=JSON.parse(localStorage.getItem("credentials"))&&(a=JSON.parse(localStorage.getItem("credentials")));for(var b=0;b<a.length;b++)a[b]=this.credentialToObject(a[b]);return a},CredentialManager.prototype.getTechniqueByBeamline=function(a){for(var b=this.getConnections(),c=0;c<b.length;c++){if(-1!=JSON.stringify(b[c].beamlines.MX).toUpperCase().indexOf(a.toUpperCase()))return"MX";if(-1!=JSON.stringify(b[c].beamlines.SAXS).toUpperCase().indexOf(a.toUpperCase()))return"SAXS"}return"UNKNOW"},CredentialManager.prototype.getBeamlineNames=function(){for(var a=this.getConnections(),b=[],c=0;c<a.length;c++)b=_.concat(_.keys(_.keyBy(a[c].beamlines.SAXS,"name")),_.keys(_.keyBy(a[c].beamlines.MX,"name")));return b},CredentialManager.prototype.getBeamlines=function(){for(var a=this.getConnections(),b=[],c=0;c<a.length;c++)b=_.concat(a[c].beamlines.SAXS,a[c].beamlines.MX);return b},CredentialManager.prototype.getBeamlinesByTechnique=function(a){for(var b=this.getConnections(),c=[],d=0;d<b.length;d++)c=_.concat(b[d].beamlines[a]);return c},CredentialManager.prototype.getConnections=function(){for(var a=this.getCredentials(),b=[],c=0;c<a.length;c++)if(a[c].activeProposals.length>0)for(var d=0;d<a[c].activeProposals.length;d++)b.push({username:a[c].username,url:a[c].url,exiUrl:a[c].exiUrl,token:a[c].token,beamlines:a[c].properties.beamlines,proposal:a[c].activeProposals[d]});else b.push({username:a[c].username,url:a[c].url,exiUrl:a[c].exiUrl,token:a[c].token,beamlines:a[c].properties.beamlines,proposal:null});return b},CredentialManager.prototype.getCredentialByUserName=function(a){var b=_.filter(this.getCredentials(),{username:a});return b.length>0?b[0]:void 0},CredentialManager.prototype.logout=function(a,b,c,d){localStorage.removeItem("credentials"),this.onLogout.notify()},CredentialManager.prototype.setActiveProposal=function(a,b){for(var c=this.getCredentials(),d=0;d<c.length;d++)c[d].username.toLowerCase()==a.toLowerCase()&&(c[d].activeProposals=[b],localStorage.setItem("credentials",JSON.stringify(c)),localStorage.removeItem("sessions"),this.onActiveProposalChanged.notify())},MainView.prototype.onBoxReady=function(){},MainView.prototype.getContainer=function(){return this.container},MainView.prototype.getPanel=function(){this.container=Ext.create("Ext.container.Container",{xtype:"container",items:[]}),this.panel=Ext.create("Ext.panel.Panel",{autoScroll:!0,title:this.title,closable:this.closable,icon:this.icon,bodyStyle:this.bodyStyle,items:[this.getContainer()]});var a=this;return this.panel.on("boxready",function(){a.onBoxReady&&a.onBoxReady()}),this.panel},AddressMainView.prototype.getPanel=MainView.prototype.getPanel,AddressMainView.prototype.getContainer=function(){return Ext.create("Ext.container.Container",{layout:{type:"fit"},margin:15,border:1,defaults:{labelWidth:80,flex:1},items:[this.addressForm.getPanel([])]})},AddressMainView.prototype.load=function(a){this.panel.setTitle("Address");var b=this,c=function(a,c){b.addressForm.load(c)};EXI.getDataAdapter({onSuccess:c}).proposal.labcontacts.getLabContactById(a)},ManagerWelcomeMainView.prototype.getPanel=MainView.prototype.getPanel,ManagerWelcomeMainView.prototype.activeProposal=function(a){EXI.credentialManager.setActiveProposal(this.username,a),EXI.proposalManager.clear()},ManagerWelcomeMainView.prototype.getContainer=function(){return this.container=Ext.create("Ext.panel.Panel",{autoScroll:!0,margin:20,cls:"border-grid",tbar:this.getToolbar(),items:[this.sessionGrid.getPanel()]}),this.container},ManagerWelcomeMainView.prototype.displayProposals=function(a){var b=this;this.container.removeAll(),this.proposalGrid.onSelected.attach(function(a,c){function d(a,c){b.displaySessions(c,c.length+" sessions for proposal "+e),b.panel.setLoading(!1)}b.panel.setLoading(!0);var e=c.Proposal_proposalCode+c.Proposal_proposalNumber;EXI.getDataAdapter({onSuccess:d}).proposal.session.getSessionsByProposal(e),b.activeProposal(c.Proposal_proposalCode+c.Proposal_proposalNumber)}),this.container.insert(this.proposalGrid.getPanel()),this.proposalGrid.load(a)},ManagerWelcomeMainView.prototype.displaySessionsByBeamlineOperator=function(a){var b=this;b.panel.setLoading(!0);var c=function(c,d){b.displaySessions(d,d.length+" sessions are scheduled for local contact: "+a),b.panel.setLoading(!1)},d=function(c,d){b.sessionGrid.panel.setTitle("No sessions are scheduled for local contact: "+a),b.panel.setLoading(!1)};EXI.getDataAdapter({onSuccess:c,onError:d}).proposal.session.getSessionsByBeamlineOperator(a)},ManagerWelcomeMainView.prototype.loadByDate=function(a,b,c){function d(a,c){e.displaySessions(c,c.length+" sessions scheduled on "+moment(b,"YYYYMMDD").format("MMMM Do YYYY")),e.panel.setLoading(!1)}var e=this;this.panel.setLoading(!0),c=moment(c,"YYYYMMDD").add(1,"days").format("YYYYMMDD"),this.isUser(a)?EXI.getDataAdapter({onSuccess:d}).proposal.session.getSessionsByProposalAndDate(b,c,a):EXI.getDataAdapter({onSuccess:d}).proposal.session.getSessionsByDate(b,c)},ManagerWelcomeMainView.prototype.filterSessions=function(a){a.length;return data=_.slice(a,0,500),_(a).forEach(function(a){a.ms=moment(a.BLSession_startDate,"MMM DD, YYYY h:mm:ss a").format("x")}),a=_.orderBy(a,["ms"],["desc"]),a.slice(0,300)},ManagerWelcomeMainView.prototype.displaySessions=function(a,b){var c=this;this.container.removeAll(),this.container.insert(this.sessionGrid.getPanel()),this.sessionGrid.onSelected.attach(function(a,b){EXI.proposalManager.clear(),c.activeProposal(b.proposalCode+b.proposalNumber)}),this.sessionGrid.load(this.filterSessions(a)),this.sessionGrid.panel.setTitle(b)},ManagerWelcomeMainView.prototype.getToolbar=function(){var a=this,b=Ext.create("Ext.menu.DatePicker",{handler:function(b,c){location.href="#/welcome/manager/"+a.username+"/date/"+Ext.Date.format(c,"Ymd")+"/"+Ext.Date.format(c,"Ymd")+"/main"}});return Ext.create("Ext.toolbar.Toolbar",{width:500,cls:"exi-top-bar",items:[{text:"Choose a Date",icon:"../images/icon/sessions.png",menu:b},{xtype:"textfield",name:"field1",width:300,emptyText:"enter search term (proposal or title)",listeners:{specialkey:function(b,c){if(c.getKey()==c.ENTER){var d=a.searchProposalByTerm(b.getValue());a.displayProposals(d)}}}},"->",{icon:"../images/icon/person.png",border:0},{xtype:"textfield",name:"field1",width:300,emptyText:"search by local contact",listeners:{specialkey:function(b,c){c.getKey()==c.ENTER&&a.displaySessionsByBeamlineOperator(b.getValue())}}}]})},ManagerWelcomeMainView.prototype.searchProposalByTerm=function(a){var b=[];if(null!=this.proposals)for(var c=0;c<this.proposals.length;c++){var d=this.proposals[c].Proposal_proposalCode+this.proposals[c].Proposal_proposalNumber,e=this.proposals[c].Proposal_title;null==e&&(e=""),(d.toUpperCase().match(a.toUpperCase())||e.toUpperCase().match(a.toUpperCase()))&&b.push(this.proposals[c])}return b},ManagerWelcomeMainView.prototype.loadProposals=function(a){var b=this,c=function(c,d){b.proposals=d,a&&a()};EXI.getDataAdapter({onSuccess:c}).proposal.proposal.getProposals()},ManagerWelcomeMainView.prototype.isUser=function(a){return!EXI.credentialManager.getCredentialByUserName(a).isManager()&&!EXI.credentialManager.getCredentialByUserName(a).isLocalContact()},ManagerWelcomeMainView.prototype.load=function(a){if(this.username=a,this.isUser(a))this.loadSessionsByProposal(a),this.activeProposal(a);else{var b=moment().format("YYYYMMDD");this.loadSessionsByDate(a,b,b)}EXI.setLoadingMainPanel(!1)},ManagerWelcomeMainView.prototype.loadSessionsByProposal=function(a){function b(b,d){c.displaySessions(d,"Sessions for proposal "+a),c.panel.setLoading(!1)}this.username=a;var c=this;this.panel.setLoading(!0),EXI.getDataAdapter({onSuccess:b}).proposal.session.getSessionsByProposal(a)},ManagerWelcomeMainView.prototype.loadSessionsByDate=function(a,b,c){this.username=a,this.loadByDate(a,b,c),this.loadProposals()},ManagerWelcomeMainView.prototype.loadSessionsByTerm=function(a,b){this.username=a;var c=this,d=function(a,d){c.proposals=d,c.searchProposalByTerm(b)};EXI.getDataAdapter({onSuccess:d}).proposal.proposal.getProposals()},RunMainView.prototype.getPanel=MainView.prototype.getPanel,RunMainView.prototype.getOutputPanel=function(){return this.outputStore=Ext.create("Ext.data.Store",{fields:["name","value","type","targetId","tool","i"],groupField:"tool",sorters:[{property:"i",direction:"DESC"}]}),Ext.create("Ext.grid.Panel",{store:this.outputStore,cls:"border-grid",features:[{ftype:"grouping"}],columns:[{text:"Tool",dataIndex:"tool",flex:1,hidden:!0},{text:"id",dataIndex:"i",flex:1,hidden:!0},{text:"Name",dataIndex:"name",flex:1},{text:"value",dataIndex:"value",flex:1},{text:"type",dataIndex:"type",flex:1},{text:"target",dataIndex:"targetId",flex:1,hidden:!0},{text:"",dataIndex:"targetId",flex:1,renderer:function(a,b,c){var d=EXI.credentialManager.getConnections()[0].exiUrl+"/file/"+c.data.targetId+"/download";return"<div><a style='color:blue;' href='"+d+"'>Download</a></div>"}}]})},RunMainView.prototype.getGeneralContainerList=function(a){var b="<ul class='generalContainerRunList'>";return b=b+"<li>Name: "+a.name+"</li>",b=b+"<li>Status: "+a.status+"</li>",b=b+"<li>"+a.creationDate+"</li>"},RunMainView.prototype.getGeneralContainer=function(a){return{xtype:"panel",title:"General",margin:10,border:1,style:{borderColor:"gray",borderStyle:"solid",borderWidth:"1px"},items:[{html:this.getGeneralContainerList(a),margin:"10 0 0 50"}]}},RunMainView.prototype.getMainPanel=function(){},RunMainView.prototype.getTabs=function(){return Ext.createWidget("tabpanel",{plain:!0,margin:"20 0 0 0",items:[this.getMainPanel(),{tabConfig:{title:"Output Files"},items:[{xtype:"container",layout:"fit",height:700,padding:20,cls:"border-grid",items:[this.getOutputPanel()]}]}]})},RunMainView.prototype.getContainer=function(){return Ext.create("Ext.container.Container",{layout:{type:"anchor"},defaults:{anchor:"100%",hideEmptyLabel:!1},margin:5,bodyStyle:{"background-color":"#E6E6E6"},items:[this.getTabs()]})},RunMainView.prototype.loadMain=function(a){},RunMainView.prototype.load=function(a){if(null!=a){this.panel.setTitle(a.name);for(var b=[],c=0;c<a.jobs.length;c++)for(var d=0;d<a.jobs[c].output.length;d++)a.jobs[c].output[d].tool=a.jobs[c].name+" "+a.jobs[c].version,a.jobs[c].output[d].i=c,b.push(a.jobs[c].output[d]);this.outputStore.loadData(b)}this.loadMain(a)},DimpleRunMainView.prototype.getPanel=RunMainView.prototype.getPanel,DimpleRunMainView.prototype.getOutputPanel=RunMainView.prototype.getOutputPanel,DimpleRunMainView.prototype.getTabs=RunMainView.prototype.getTabs,DimpleRunMainView.prototype.getContainer=RunMainView.prototype.getContainer,DimpleRunMainView.prototype.load=RunMainView.prototype.load,DimpleRunMainView.prototype.getFilesGrid=function(){var a=this;this.filesStore=Ext.create("Ext.data.Store",{fields:["name","targetId"]});var b=Ext.create("Ext.selection.RowModel",{allowDeselect:!0,listeners:{selectionchange:function(b,c){console.log(c[0].data);var d=function(b,c){document.getElementById(a.id+"display").innerHTML="<textarea rows='100' cols='100'> "+c+"</textarea>"};-1==c[0].data.name.indexOf(".mtz")?EXI.getDataAdapter({onSuccess:d}).exi.offline.getFileContent(c[0].data.targetId):d(this,"No text available")}}});return Ext.create("Ext.grid.Panel",{title:"Files",store:this.filesStore,selModel:b,cls:"border-grid",height:400,columns:[{text:"Name",dataIndex:"name",flex:1}]})},DimpleRunMainView.prototype.getMainPanel=function(){var a=Ext.create("Ext.data.Store",{fields:["key","value"]});return this.generalGrid=Ext.create("Ext.grid.Panel",{title:"General",store:a,layout:"fit",columns:[{text:"Name",dataIndex:"name"},{text:"Seniority",dataIndex:"seniority"}],flex:1}),{tabConfig:{title:"Dimple"},items:[{xtype:"container",height:700,cls:"border-grid",items:[{xtype:"container",layout:"hbox",items:[{xtype:"container",layout:"fit",flex:.4,margin:5,items:[this.getFilesGrid(),{html:"<br />"},{html:'<div id="'+this.id+'blobs";><div>'}]},{xtype:"container",layout:"fit",flex:.6,margin:5,height:400,cls:"border-grid",items:[{html:'<div id="'+this.id+'display";><div>'}]}]},{xtype:"container",margin:5,height:210,layout:"fit",flex:1,items:[{html:'<div style="height:200px"  id="'+this.id+'snapshots";><div>'}]}]}]}},DimpleRunMainView.prototype.loadBlobs=function(a){var b=[],c=0;for(c=0;c<a.output.length;c++)"blob"==a.output[c].type&&b.push(a.output[c]);var d=(document.createElement("div"),document.createElement("table")),e=document.createElement("tr");for(c=0;c<b.length;c++){var f=document.createElement("td"),g=document.createElement("img");g.setAttribute("src",EXI.getDataAdapter().exi.offline.getFileImage(b[c].targetId)),g.setAttribute("height","180px"),g.setAttribute("width","180px"),g.setAttribute("hspace","10"),g.setAttribute("onclick","window.open(this.src)"),f.appendChild(g),e.appendChild(f)}d.appendChild(e),document.getElementById(this.id+"snapshots").innerHTML=d.innerHTML},DimpleRunMainView.prototype.loadFiles=function(a){for(var b=[],c=0;c<a.output.length;c++)"blob"!=a.output[c].type&&b.push(a.output[c]);this.filesStore.loadData(b)},DimpleRunMainView.prototype.loadMain=function(a){if(console.log(a),null!=a&&null!=a.jobs&&a.jobs.length>0)for(var b=0;b<a.jobs.length;b++)this.loadBlobs(a.jobs[b]),this.loadFiles(a.jobs[b])},ScatteringForm.prototype.getPanel=function(){return this.panel=Ext.create("Ext.panel.Panel",{items:[{html:'<div id="'+this.id+'"></div>',autoScroll:!1,width:this.width,height:this.height}]}),this.panel},ScatteringForm.prototype.load=function(a){this.data=a,this.data||(this.data={}),this.data.id=this.id,this.data.keys&&(this.data.chunkedKeys=_.chunk(this.data.keys,Math.ceil(this.data.keys.length/3))),this.data.today=moment().format("YYYY-MM-DD"),this.data.tenDaysAgo=moment().subtract(10,"d").format("YYYY-MM-DD"),this.data.types||(this.data.types=[{display:"Overall",value:"overall"},{display:"InnerShell",value:"innerShell"},{display:"OutShell",value:"outShell"}]),this.data.beamlines||(this.data.beamlines=EXI.credentialManager.getBeamlinesByTechnique("MX"));var b="";dust.render("scattering.form.template",this.data,function(a,c){b=c}),$("#"+this.id).hide().html(b).fadeIn("fast"),this.panel.doLayout()},ScatteringForm.prototype.plot=function(){var a=$("#"+this.id+"-startDate").val(),b=$("#"+this.id+"-endDate").val(),c=[];$(".scattering-checkbox:checked").each(function(a){c.push($(this).val())});var d=$("#"+this.id+"-type").val(),e=$("#"+this.id+"-beamline").val();if(""!=a&&""!=b&&c.length>0){var f=moment(b,"YYYY-MM-DD").diff(moment(a,"YYYY-MM-DD"),"days");if(10>=f){url="",""!=e?url=EXI.getDataAdapter().mx.stats.getStatisticsByDateAndBeamline(d,a,b,e):url=EXI.getDataAdapter().mx.stats.getStatisticsByDate(d,a,b);var g="url="+url+"&/&title="+this.data.title+"&/&y="+c.toString()+"&/&x=recordTimeStamp&";window.open("../viewer/scatter/index.html?"+g,"_blank")}else $("#"+this.id+"-dates").notify("Date interval must be 10 days or lower.","error")}else $("#"+this.id+"-checkox-div").notify("Set the dates correctly and select the values to plot.",{className:"error",elementPosition:"top left"})},SessionMainView.prototype.getPanel=MainView.prototype.getPanel,SessionMainView.prototype.getContainer=function(){return _this=this,this.subpanel=Ext.create("Ext.container.Container",{layout:"fit",border:0,items:[]}),this.panel=Ext.create("Ext.container.Container",{layout:"hbox",margin:10,items:[{html:'<div style="height:600px" id="'+this.id+'"></div>',height:600,border:0,width:600},this.subpanel],listeners:{afterrender:function(){_this.showCalendar([])}}}),this.panel},SessionMainView.prototype.showCalendar=function(a){function b(a){c.loadByDate(moment(new Date(a.startDate)).format("YYYYMMDD"))}var c=this;$("#"+c.id).empty(),$("#"+this.id).calendar({enableContextMenu:!0,enableRangeSelection:!0,selectRange:function(a){b({startDate:a.startDate,endDate:a.endDate})},mouseOnDay:function(a){if(a.events.length>0){var b="";for(var c in a.events)b+="<div class='event-tooltip-content'><div class='event-name' style='color:"+a.events[c].color+"'>"+a.events[c].name+"</div><div class='event-location'>"+a.events[c].location+"</div></div>";$(a.element).popover({trigger:"manual",container:"body",html:!0,content:b}),$(a.element).popover("show")}},mouseOutDay:function(a){a.events.length>0&&$(a.element).popover("hide")},dayContextMenu:function(a){$(a.element).popover("hide")},dataSource:a})},SessionMainView.prototype.getBadge=function(a,b){return b&&0!=b?"<span>"+a+'  <span class="badge">'+b+"</span></span><br />":""},SessionMainView.prototype.getLocation=function(a){var b=this.getBadge("Collect",a.dataCollectionGroupCount);return b+=this.getBadge("Images",a.imagesCount),b+=this.getBadge("XRF",a.xrfSpectrumCount),b+=this.getBadge("Energy",a.energyScanCount),b+this.getBadge("Sample",a.sampleCount)},SessionMainView.prototype.load=function(a){for(var b=[],c=0;c<a.length;c++)b.push({id:a[c].sessionId,name:a[c].Proposal_proposalCode+a[c].Proposal_ProposalNumber+"( "+a[c].beamLineName+" )",location:this.getLocation(a[c]),startDate:new Date(a[c].BLSession_startDate),endDate:new Date(a[c].BLSession_endDate)});this.showCalendar(b),this.subpanel.insert(this.sessionGrid.getPanel());var d=this;if($("#"+this.id+"_header")&&EXI.proposalManager.getProposals().length>0){var e=EXI.proposalManager.getProposals()[0];e.sessionCount=a.length,dust.render("welcomemainviewproposalheader",e,function(a,b){$("#"+d.id+"_header").html(b),d.panel.insert(0,{html:b,border:0,margin:"10 0 0 10",width:600})})}},SessionMainView.prototype.loadByDate=function(a){function b(a,b){c.sessionGrid.load(b),c.panel.setLoading(!1)}var c=this;this.panel.setLoading(!0);var d=EXI.credentialManager.getCredentials()[0].activeProposals[0],e=moment(a,"YYYYMMDD").format("YYYYMMDD");EXI.getDataAdapter({onSuccess:b}).proposal.session.getSessionsByProposalAndDate(a,e,d)},SpreadSheet.prototype.getPanel=function(){var a=this;return this.panel=Ext.create("Ext.panel.Panel",{layout:"vbox",height:this.height+50,items:[{html:'<div  style="overflow: auto;overflow-y: hidden; border:1px solid gray;background-color:white;height:500px;width:'+(a.width-20)+'px"; id="'+this.id+'_samples"; ></div>',margin:"20 0 20 10",height:this.height,width:this.width,autoScroll:!0,resizable:!0}]}),this.panel},SpreadSheet.prototype.setLoading=function(a){this.panel.setLoading(a)},SpreadSheet.prototype.getAcronyms=function(){for(var a=EXI.proposalManager.getProteins(),b=[],c=0;c<a.length;c++)b.push(a[c].acronym);return b},SpreadSheet.prototype.setContainerType=function(a){this.containerType=a},SpreadSheet.prototype.getHeaderWidth=function(){for(var a=this.getHeader(),b=[],c=0;c<a.length;c++)b.push(a[c].column["with"]);return b},SpreadSheet.prototype.getHeaderId=function(a){for(var b=this.getHeader(a),c=[],d=0;d<b.length;d++)c.push(b[d].id);return c},SpreadSheet.prototype.getHeaderText=function(){for(var a=this.getHeader(),b=[],c=0;c<a.length;c++)b.push(a[c].text);return b},SpreadSheet.prototype.getColumns=function(){for(var a=[],b=0;b<this.getHeader().length;b++)a.push(this.getHeader()[b].column);return a},SpreadSheet.prototype.parseTableData=function(){var a=[],b=this.spreadSheet.getData();if(null!=b&&b.length>0)for(var c=this.getHeaderId(),d=0;d<b.length;d++)if(b[d].length>1){var e={};e.location=d+1;for(var f=0;f<c.length;f++){var g=c[f],h=b[d][this.getColumnIndex(g)];e[g]=h}e["Protein Acronym"]&&e["Protein Acronym"].length>0&&a.push(e)}for(var i=[],j=0;j<a.length;j++)null!=a[j]["Protein Acronym"]&&i.push(a[j]);return i},SpreadSheet.prototype.load=function(a){this.data=a;var b=document.getElementById(this.id+"_samples");this.spreadSheet=new Handsontable(b,{data:a,height:this.height,width:this.width,manualColumnResize:!0,colWidths:this.getHeaderWidth(),colHeaders:this.getHeaderText(),stretchH:"last",columns:this.getColumns()})},SpreadSheet.prototype.getData=function(){return this.spreadSheet.getData()},SpreadSheet.prototype.loadData=function(a){return this.spreadSheet.loadData(a)},SpreadSheet.prototype.setDataAtCell=function(a,b,c){this.spreadSheet.setDataAtCell(a,b,c);
},SpreadSheet.prototype.getColumnIndex=function(a){return _.findIndex(this.getHeader(),{id:a})},SpreadSheet.prototype.updateNumberOfRows=function(a){if(this.spreadSheet){var b=this.spreadSheet.getData();if(b.length<a)for(var c=b.length+1;a>=c;c++)b.push([c]);else b=b.slice(0,a);this.spreadSheet.loadData(b)}},SpreadSheet.prototype.emptyRow=function(a){for(var b=this.getHeaderId(),c=1;c<b.length;c++)this.setDataAtCell(a,c,"")},AddContainerForm.prototype.getPanel=function(a){return this.panel=Ext.create("Ext.form.Panel",{width:this.width-10,height:this.height,padding:10,buttons:this.getButtons(),items:[{xtype:"container",margin:"2 2 2 2",collapsible:!1,defaultType:"textfield",layout:"anchor",items:[{xtype:"container",margin:"5 0 5 5",layout:"vbox",items:[{xtype:"textfield",fieldLabel:"Name",name:"code",id:this.id+"container_code",labelWidth:200,width:500}]},this.containerTypeComboBox.getPanel()]}]}),this.panel},AddContainerForm.prototype.getButtons=function(){var a=this;return[{text:"Save",id:this.id+"-save-button",handler:function(){a.onSave.notify(a.getContainer())}},{text:"Cancel",handler:function(){a.onCancel.notify()}}]},AddContainerForm.prototype.getContainer=function(){return this.container.code=Ext.getCmp(this.id+"container_code").getValue(),this.container.containerType=this.containerTypeComboBox.getSelectedType(),this.container.capacity=this.containerTypeComboBox.getSelectedCapacity(),this.container},AddContainerForm.prototype.addStockSolutionsList=function(){var a=_.filter(EXI.proposalManager.getStockSolutions(),{boxId:null});this.panel.insert(this.stockSolutionsGrid.getPanel()),this.stockSolutionsGrid.load(a)},CaseForm.prototype.fillStores=function(){var a=this;this.panel.setLoading("Loading Labcontacts from database");var b=BUI.getProposal();b.onDataRetrieved.attach(function(b,c){a.labContactForSendingStore.loadData(c,!1),a.labContactForReturnStore.loadData(c,!1),a.panel.setLoading(!1)}),b.getLabContactsByProposalId()},CaseForm.prototype.refresh=function(a){this.setDewar(a)},CaseForm.prototype.getDewar=function(){return this.dewar.code=Ext.getCmp(this.id+"dewar_code").getValue(),this.dewar.comments=Ext.getCmp(this.id+"dewar_comments").getValue(),this.dewar.transportValue=Ext.getCmp(this.id+"dewar_transportValue").getValue(),this.dewar.storageLocation=this.storageLocationComboBox.getValue(),this.dewar},CaseForm.prototype.setDewar=function(a){this.dewar=a,null==this.dewar&&(this.dewar={},this.dewar.code="",this.dewar.transportValue="",this.dewar.storageLocation="",this.dewar.comments=""),Ext.getCmp(this.id+"dewar_code").setValue(this.dewar.code),Ext.getCmp(this.id+"dewar_comments").setValue(this.dewar.comments),Ext.getCmp(this.id+"dewar_transportValue").setValue(this.dewar.transportValue),this.storageLocationComboBox.setValue(this.dewar.storageLocation)},CaseForm.prototype.getStorageLocationCombo=function(){return this.storageLocationComboBox=BIOSAXS_COMBOMANAGER.getComboStorageTemperature(),this.storageLocationComboBox},CaseForm.prototype.getPanel=function(a){return this.panel=Ext.create("Ext.form.Panel",{width:this.width-10,padding:10,height:320,items:[{xtype:"container",margin:"2 2 2 2",collapsible:!1,defaultType:"textfield",layout:"anchor",items:[{xtype:"container",layout:"vbox",items:[{xtype:"requiredtextfield",fieldLabel:"Name",allowBlank:!1,name:"code",id:this.id+"dewar_code",labelWidth:200,width:500}]},this.getStorageLocationCombo(),{xtype:"numberfield",width:500,labelWidth:200,margin:"10 0 0 0",fieldLabel:"Transport Value",id:this.id+"dewar_transportValue"},{xtype:"textareafield",name:"comments",fieldLabel:"Comments",labelWidth:200,width:500,margin:"10 0 0 0",height:100,id:this.id+"dewar_comments"}]}]}),this.refresh(a),this.panel},ContainerSpreadSheet.prototype.getPanel=SpreadSheet.prototype.getPanel,ContainerSpreadSheet.prototype.setLoading=SpreadSheet.prototype.setLoading,ContainerSpreadSheet.prototype.getAcronyms=SpreadSheet.prototype.getAcronyms,ContainerSpreadSheet.prototype.getHeaderWidth=SpreadSheet.prototype.getHeaderWidth,ContainerSpreadSheet.prototype.getHeaderId=SpreadSheet.prototype.getHeaderId,ContainerSpreadSheet.prototype.getHeaderText=SpreadSheet.prototype.getHeaderText,ContainerSpreadSheet.prototype.getColumns=SpreadSheet.prototype.getColumns,ContainerSpreadSheet.prototype.parseTableData=SpreadSheet.prototype.parseTableData,ContainerSpreadSheet.prototype.getData=SpreadSheet.prototype.getData,ContainerSpreadSheet.prototype.loadData=SpreadSheet.prototype.loadData,ContainerSpreadSheet.prototype.setDataAtCell=SpreadSheet.prototype.setDataAtCell,ContainerSpreadSheet.prototype.getColumnIndex=SpreadSheet.prototype.getColumnIndex,ContainerSpreadSheet.prototype.disableAll=SpreadSheet.prototype.disableAll,ContainerSpreadSheet.prototype.setContainerType=SpreadSheet.prototype.setContainerType,ContainerSpreadSheet.prototype.updateNumberOfRows=SpreadSheet.prototype.updateNumberOfRows,ContainerSpreadSheet.prototype.emptyRow=SpreadSheet.prototype.emptyRow,ContainerSpreadSheet.prototype.load=function(a){function b(a,b,d,e,f,g,h){return Handsontable.renderers.TextRenderer.apply(this,arguments),a.getDataAtRow(d)[1]?(2==e&&(g&&""!=g||(b.className="custom-row-text-required")),void(e==c.spaceGroupIndex&&(b.style.background="#EEE"))):void(b.style.background="#EEE")}var c=this;this.puck=a;var d=document.getElementById(this.id+"_samples");this.crystalFormIndex=this.getColumnIndex("Crystal Form"),this.spaceGroupIndex=this.getColumnIndex("Space Group");var e=this.getSamplesData(a);Handsontable.renderers.registerRenderer("ValueRenderer",b),this.spreadSheet=new Handsontable(d,{afterCreateRow:function(a,b){e.splice(a,b)},beforeChange:function(a,b){lastChange=a},afterChange:function(a,b){if($(".htInvalid").removeClass("htInvalid"),$(".edit-crystal-button").click(function(a){var b=a.target.id.split("-")[2],d=c.parseCrystalFormColumn(c.getData()[b][c.crystalFormIndex],b);c.showEditForm(d,b)}),"edit"==b){if(a)for(var d=0;d<a.length;d++){var e=a[d];e[2]!=e[3]&&c.manageChange(e,b)}}else if("autofill"==b&&a){var f=Math.sign(a[0][0]-c.spreadSheet.getSelected()[0]);if(1==f)for(var d=0;d<a.length;d++){var e=a[d];e[2]!=e[3]&&c.manageChange(e,b,f)}else for(var d=a.length-1;d>=0;d--){var e=a[d];e[2]!=e[3]&&c.manageChange(e,b,f)}}},data:e,height:this.height,width:this.width,manualColumnResize:!0,colWidths:this.getHeaderWidth(),colHeaders:this.getHeaderText(),stretchH:"last",columns:this.getColumns()})},ContainerSpreadSheet.prototype.getSamplesData=function(a){function b(a,b){for(var c=0;c<a.length;c++)if(a[c].location==Number(b))return a[c]}function c(a){return a?a:""}var d=[],e=a.sampleVOs;e.sort(function(a,b){return Number(a.location)-Number(b.location)});for(var f=0;f<a.capacity;f++){var g=b(e,f+1);if(null!=g){var h=g.crystalVO,i=h.proteinVO,j=g.diffractionPlanVO;null==j&&(j={}),d.push([f+1,i.acronym,g.name,this.getCrystalInfo(h),j.experimentKind,g.BLSample_code,c(j.observedResolution),j.requiredResolution,j.preferredBeamDiameter,j.numberOfPositions,j.radiationSensitivity,j.requiredMultiplicity,j.requiredCompleteness,h.spaceGroup,g.smiles,g.comments])}else d.push([f+1])}return d},ContainerSpreadSheet.prototype.getHeader=function(){var a=this,b=[],c=function(a,b,c,d,e,f,g){void 0!=f&&(b.innerHTML=f),b.style.background="#DDD"},d=function(a,b,c,d,e,f,g){void 0!=f&&(b.innerHTML=f)};return b=[{text:"#",id:"position",column:{width:20}},{text:"Protein <br />Acronym",id:"Protein Acronym",column:{width:80,type:"dropdown",source:this.getAcronyms()}},{text:"Sample<br /> Name",id:"Sample Name",column:{width:120}},{text:"Crystal<br /> Form",id:"Crystal Form",column:{width:250,type:"dropdown",source:function(b,c){var d=a.getColumnIndex("Protein Acronym"),e=EXI.proposalManager.getProteinByAcronym(this.instance.getDataAtCell(this.row,d));c(e.length>0?a.getCrystalInfoByProtein(e[0]):[])}}},{text:"Exp.<br /> Type",id:"Experiment Type",column:{width:80,type:"dropdown",source:["Default","MXPressE","MXPressO","MXPressI","MXPressE_SAD","MXScore","MXPressM"]}},{text:"Pin <br />BarCode",id:"Pin BarCode",column:{width:60}},{text:"Pre-observed <br />resolution",id:"Pre-observed resolution",column:{width:80}},{text:"Needed<br /> resolution",id:"Needed resolution",column:{width:60}},{text:"Pref. <br />Diameter",id:"Pref. Diameter",column:{width:60}},{text:"Number of<br /> positions",id:"Number Of positions",column:{width:80}},{text:"Radiation<br /> Sensitivity",id:"Radiation Sensitivity",column:{width:80}},{text:"Required<br /> multiplicity",id:"Required multiplicity",column:{width:60}},{text:"Required<br /> Completeness",id:"Required Completeness",column:{width:80}},{text:"Space <br /> Group",id:"Space Group",column:{width:55,renderer:c,editor:!1,readOnly:!0}},{text:"Smiles",id:"Smiles",column:{width:140}},{text:"Comments",id:"Comments",column:{width:200}}],this.renderCrystalFormColumn&&b.push({text:"Edit Crystal Form",id:"editCrystalForm",column:{width:200,renderer:d,editor:!1,readOnly:!0}}),b},ContainerSpreadSheet.prototype.getPuck=function(){function a(a){return _.filter(a,function(a){return a.location==c[e].location})}for(var b=JSON.parse(JSON.stringify(this.puck)),c=this.parseTableData(),d=[],e=0;e<c.length;e++){var f={},g=a(b.sampleVOs);g.length>0&&(f=g[0]),f.name=c[e]["Sample Name"],f.BLSample_code=c[e]["Pin BarCode"],f.smiles=c[e].Smiles,f.location=c[e].location,f.comments=c[e].Comments;var h=[];null==f.crystalVO?(f.crystalVO={},h=EXI.proposalManager.getProteinByAcronym(c[e]["Protein Acronym"]),null!=h&&(f.crystalVO.proteinVO=h[0])):(h=EXI.proposalManager.getProteinByAcronym(c[e]["Protein Acronym"]),null!=h&&(f.crystalVO.proteinVO=h[0]));var i=this.parseCrystalFormColumn(c[e]["Crystal Form"],e);f.crystalVO.spaceGroup=i.spaceGroup?i.spaceGroup:"",f.crystalVO.cellA=i.cellA,f.crystalVO.cellB=i.cellB,f.crystalVO.cellC=i.cellC,f.crystalVO.cellAlpha=i.cellAlpha,f.crystalVO.cellBeta=i.cellBeta,f.crystalVO.cellGamma=i.cellGamma,f.diffractionPlanVO={},f.diffractionPlanVO.radiationSensitivity=Number(c[e]["Radiation Sensitivity"]),f.diffractionPlanVO.requiredCompleteness=Number(c[e]["Required Completeness"]),f.diffractionPlanVO.requiredMultiplicity=Number(c[e]["Required multiplicity"]),f.diffractionPlanVO.requiredResolution=Number(c[e]["Needed resolution"]),f.diffractionPlanVO.observedResolution=Number(c[e]["Pre-observed resolution"]),f.diffractionPlanVO.preferredBeamDiameter=Number(c[e]["Pref. Diameter"]),f.diffractionPlanVO.numberOfPositions=Number(c[e]["Number Of positions"]),f.diffractionPlanVO.experimentKind=c[e]["Experiment Type"],d.push(f)}return b.sampleVOs=d,b},ContainerSpreadSheet.prototype.setRenderCrystalFormColumn=function(a){this.renderCrystalFormColumn=a},ContainerSpreadSheet.prototype.parseCrystalFormColumn=function(a,b){var c={spaceGroup:null,cellA:null,cellB:null,cellC:null,cellAlpha:null,cellBeta:null,cellGamma:null};if(""!=a&&null!=a){var d=EXI.proposalManager.getProteinByAcronym(this.spreadSheet.getDataAtCell(b,this.getColumnIndex("Protein Acronym")));if(d&&d.length>0&&(c.proteinVO=d[0]),"NEW"==a)c.spaceGroup="NEW",c.crystalId="";else{this.crystalInfoToIdMap[a]?c.crystalId=this.crystalInfoToIdMap[a]:(this.getCrystalInfoByProtein(d[0]),c.crystalId=this.crystalInfoToIdMap[a]);var e=a.split("-");if(c.spaceGroup=e[0].trim(),e.length>1){var f=(e[1]+"-"+e[2]).trim().replace(/[{()}]/g,"").replace(/\s+/g,"");c.cellA="null"==f.split("-")[0].split(",")[0]?null:f.split("-")[0].split(",")[0],c.cellB="null"==f.split("-")[0].split(",")[1]?null:f.split("-")[0].split(",")[1],c.cellC="null"==f.split("-")[0].split(",")[1]?null:f.split("-")[0].split(",")[2],c.cellAlpha="null"==f.split("-")[1].split(",")[0]?null:f.split("-")[1].split(",")[0],c.cellBeta="null"==f.split("-")[1].split(",")[1]?null:f.split("-")[1].split(",")[1],c.cellGamma="null"==f.split("-")[1].split(",")[2]?null:f.split("-")[1].split(",")[2]}else c.cellA=0,c.cellB=0,c.cellC=0,c.cellAlpha=0,c.cellBeta=0,c.cellGamma=0}}return c},ContainerSpreadSheet.prototype.getCrystalInfo=function(a){try{return null==a.cellA?a.spaceGroup+" - undefined":0==a.cellA&&0==a.cellB&&0==a.cellC&&0==a.cellAlpha&&0==a.cellBeta&&0==a.cellGamma?a.spaceGroup:a.spaceGroup+" - ("+a.cellA+" , "+a.cellB+" , "+a.cellC+" - "+a.cellAlpha+" , "+a.cellBeta+" , "+a.cellGamma+")"}catch(b){return""}},ContainerSpreadSheet.prototype.getUnitCellInfo=function(a){var b="";return dust.render("shipping.edit.form.unit.cell.template",a,function(a,c){b=c}),b},ContainerSpreadSheet.prototype.showEditForm=function(a,b){var c=this,d=new EditCrystalFormView;d.onSaved.attach(function(a,d){var f=c.parseTableData();c.updateCrystalGroup(b,d);for(var g=0;g<f.length;g++)f[g].location-1!=b&&c.crystalInfoToIdMap[f[g]["Crystal Form"]]==d.crystalId&&c.updateCrystalGroup(f[g].location-1,d);e.close()});var e=Ext.create("Ext.window.Window",{title:"Crystal Form",height:460,width:600,modal:!0,closable:!1,layout:"fit",items:[d.getPanel()],buttons:[{text:"Save",handler:function(){d.save()}},{text:"Cancel",handler:function(){"NEW"==a.spaceGroup&&c.resetCrystalGroup(b),e.close()}}]}).show();d.load(a)},ContainerSpreadSheet.prototype.addEditCrystalFormButton=function(a,b){b||(b=this.getColumnIndex("editCrystalForm"));var c="<a id='edit-button-"+a+"' class='btn btn-xs edit-crystal-button'><span class='glyphicon glyphicon-edit'></span> Edit Crystal Form</a>";this.setDataAtCell(a,b,c)},ContainerSpreadSheet.prototype.updateCrystalGroup=function(a,b){b?(this.setDataAtCell(a,this.crystalFormIndex,this.getCrystalInfo(b)),this.setDataAtCell(a,this.spaceGroupIndex,b.spaceGroup),this.addEditCrystalFormButton(a)):this.resetCrystalGroup(a)},ContainerSpreadSheet.prototype.resetCrystalGroup=function(a){this.setDataAtCell(a,this.crystalFormIndex,""),this.setDataAtCell(a,this.spaceGroupIndex,""),this.setDataAtCell(a,this.getColumnIndex("editCrystalForm"),"")},ContainerSpreadSheet.prototype.disableAll=function(){this.spreadSheet.updateSettings({readOnly:!0})},ContainerSpreadSheet.prototype.manageChange=function(a,b,c){switch(a[1]){case this.crystalFormIndex:var d=this.parseCrystalFormColumn(a[3],a[0]);void 0!=d.spaceGroup?"NEW"==d.spaceGroup?this.showEditForm(d,a[0]):this.isCrystalFormAvailable(d,this.getData()[a[0]][this.getColumnIndex("Protein Acronym")])?this.updateCrystalGroup(a[0],d):this.resetCrystalGroup(a[0]):this.resetCrystalGroup(a[0]);break;case this.getColumnIndex("Protein Acronym"):if(""==a[3])this.emptyRow(a[0]);else{if(a[0]>0){var e=this.getColumnIndex("Sample Name"),f=this.spreadSheet.getDataAtCell(a[0],e);if(void 0==f||""==f){var g=this.spreadSheet.getDataAtCell(a[0]-1,e);if(null!=g&&""!=g){var h=this.autoIncrement(g,1);""!=h&&this.setDataAtCell(a[0],e,h)}}}var d=this.parseCrystalFormColumn(this.getData()[a[0]][this.crystalFormIndex],a[0]);if(!this.isCrystalFormAvailable(d,a[3])){this.resetCrystalGroup(a[0]);var i=EXI.proposalManager.getProteinByAcronym(a[3]);if(i&&i.length>0){var j=_.filter(EXI.proposalManager.getCrystals(),function(a){return a.proteinVO.proteinId==i[0].proteinId});if(j&&j.length>0){var k=_.maxBy(j,"crystalId");this.updateCrystalGroup(a[0],k)}}}}break;case this.getColumnIndex("Sample Name"):if("autofill"==b&&""!=a[3]){var h=this.autoIncrement(this.spreadSheet.getDataAtCell(a[0]-c,a[1]),c);""!=h&&this.setDataAtCell(a[0],a[1],h)}}a[1]!=this.getColumnIndex("editCrystalForm")&&this.onModified.notify(a),$(".htInvalid").removeClass("htInvalid")},ContainerSpreadSheet.prototype.autoIncrement=function(a,b){var c="",d=/(\d+)/g,e=a.match(d);if(e){var f=e[e.length-1];a.lastIndexOf(f)==a.length-f.length&&(c=a.substring(0,a.length-f.length)+(parseInt(f)+b))}return c},ContainerSpreadSheet.prototype.isCrystalFormAvailable=function(a,b){var c=_.filter(_.filter(EXI.proposalManager.getCrystals(),{spaceGroup:a.spaceGroup}),function(a){return a.proteinVO.acronym==b});if(c.length>0)for(var d=0;d<c.length;d++){var e=c[d];if(e.cellA==a.cellA&&e.cellB==a.cellB&&e.cellC==a.cellC&&e.cellAlpha==a.cellAlpha&&e.cellBeta==a.cellBeta&&e.cellGamma==a.cellGamma)return!0}return!1},ContainerSpreadSheet.prototype.getCrystalInfoByProtein=function(a){var b=[],c=_.filter(EXI.proposalManager.getCrystals(),function(b){return b.proteinVO.proteinId==a.proteinId});if(c)for(var d=0;d<c.length;d++){var e=this.getCrystalInfo(c[d]);this.crystalInfoToIdMap[e]=c[d].crystalId,b.push(e)}return _.union(b,["NEW"])},CrystalFormView.prototype.getPanel=function(){return this.panel=Ext.create("Ext.panel.Panel",{buttons:this.getToolBar(),items:[{html:'<div id="'+this.id+'" ></div>'},this.uploaderWidget.getForm(),{xtype:"button",margin:"0 0 0 2",text:"Test",handler:function(){window.open("#/shipping/edv","_newtab")}}]}),this.panel},CrystalFormView.prototype.getToolBar=function(){var a=this;return[{text:"Return to shipment",width:200,height:30,handler:function(){location.href="#/shipping/"+a.shippingId+"/main"}}]},CrystalFormView.prototype.load=function(a,b,c){var d=this;this.containerId=a,this.sampleId=b,this.shippingId=c,this.panel.setTitle("Shipment");var e=function(a,b){if(b){var c=_.filter(b.sampleVOs,function(a){return a.blSampleId==d.sampleId});if(c.length>0){d.sample=c[0];var e="";dust.render("crystal.form.template",d.sample,function(a,b){e+=b}),$("#"+d.id).hide().html(e).fadeIn("fast"),$("#"+d.id).css("padding",d.padding),d.panel.doLayout()}}};EXI.getDataAdapter({onSuccess:e}).proposal.shipping.getContainerById(this.containerId,this.containerId,this.containerId)},EditCrystalFormView.prototype.getPanel=function(){return this.panel=Ext.create("Ext.panel.Panel",{items:[{html:'<div id="'+this.id+'"></div>',autoScroll:!1,padding:this.padding,width:this.width}]}),this.panel},EditCrystalFormView.prototype.load=function(a){var b=this;if(this.crystal=a,null!=a.crystalId)if(""!=a.crystalId){var c=function(a,c){b.crystal=c,b.render()};EXI.getDataAdapter({onSuccess:c}).mx.crystal.getCrystalById(a.crystalId)}else this.render();else $("#"+this.id).hide().html("<div id='"+this.id+"-error' style='margin:30px;'><h4>There was an error loading the crystal</h4></div>").fadeIn("fast"),this.panel.doLayout()},EditCrystalFormView.prototype.render=function(){var a=this;this.crystal.spaceGroups=ExtISPyB.spaceGroups,this.crystal.id=this.id;var b="";dust.render("crystal.edit.form.template",this.crystal,function(a,c){b=c}),$("#"+this.id).hide().html(b).fadeIn("fast"),this.panel.doLayout(),$("#"+this.id+"-space-group").on("change",function(){a.setCellValuesBySpaceGroup(this.value)}),this.setCellValuesBySpaceGroup($("#"+this.id+"-space-group").val())},EditCrystalFormView.prototype.save=function(){var a=this,b={spaceGroup:$("#"+this.id+"-space-group").val(),cellA:$("#"+this.id+"-cellA").val(),cellB:$("#"+this.id+"-cellB").val(),cellC:$("#"+this.id+"-cellC").val(),cellAlpha:$("#"+this.id+"-cellAlpha").val(),cellBeta:$("#"+this.id+"-cellBeta").val(),cellGamma:$("#"+this.id+"-cellGamma").val(),name:$("#"+this.id+"-name").val(),comments:$("#"+this.id+"-comments").val()};if(""!=b.cellA&&""!=b.cellB&&""!=b.cellC){this.panel.setLoading();var c=function(b,c){EXI.proposalManager.get(!0),a.onSaved.notify(c),a.panel.setLoading(!1)};EXI.getDataAdapter({onSuccess:c}).mx.crystal.save(this.crystal.proteinVO.proteinId,this.crystal.crystalId,b.name,b.spaceGroup,b.cellA,b.cellB,b.cellC,b.cellAlpha,b.cellBeta,b.cellGamma,b.comments)}else $("#"+this.id+"-cellsABC").notify("The values A, B and C must be filled",{className:"error"})},EditCrystalFormView.prototype.setCellValuesBySpaceGroup=function(a){var b=this,c=function(a,c){var d="",e="",f="";if(c&&c.length>0&&c[0].geometryClassnameVO){switch(c[0].geometryClassnameVO.geometryClassname){case"Primitive triclinic":break;case"Primitive monoclinic":d=90,f=90;break;case"Centred monoclinic":d=90,f=90;break;case"Primitive orthohombic":d=90,e=90,f=90;break;case"C-centred orthohombic":d=90,e=90,f=90;break;case"I-centred orthohombic":d=90,e=90,f=90;break;case"F-centred orthohombic":d=90,e=90,f=90;break;case"Primitive tetragonal":d=90,e=90,f=90;break;case"I-centred tetragonal":d=90,e=90,f=90;break;case"Primitive trigonal":d=90,e=90,f=120;break;case"Primitive hexagonal":d=90,e=90,f=120;break;case"Rhombohedral":d=90,e=90,f=120;break;case"Primitive cubic":d=90,e=90,f=90;break;case"I-centred cubic":d=90,e=90,f=90;break;case"F-centred cubic":d=90,e=90,f=90}b.manageCellValueUpdate("#"+b.id+"-cellAlpha",d),b.manageCellValueUpdate("#"+b.id+"-cellBeta",e),b.manageCellValueUpdate("#"+b.id+"-cellGamma",f)}};EXI.getDataAdapter({onSuccess:c}).mx.crystal.getGeometryclassBySpacegroup(a)},EditCrystalFormView.prototype.manageCellValueUpdate=function(a,b){""!=b?($(a).prop("disabled",!0),$(a).val(b)):$(a).prop("disabled",!1)},GenericContainerSpreadSheet.prototype.getPanel=SpreadSheet.prototype.getPanel,GenericContainerSpreadSheet.prototype.setLoading=SpreadSheet.prototype.setLoading,GenericContainerSpreadSheet.prototype.getAcronyms=SpreadSheet.prototype.getAcronyms,GenericContainerSpreadSheet.prototype.getHeaderWidth=SpreadSheet.prototype.getHeaderWidth,GenericContainerSpreadSheet.prototype.getHeaderId=SpreadSheet.prototype.getHeaderId,GenericContainerSpreadSheet.prototype.getHeaderText=SpreadSheet.prototype.getHeaderText,GenericContainerSpreadSheet.prototype.getColumns=SpreadSheet.prototype.getColumns,GenericContainerSpreadSheet.prototype.parseTableData=SpreadSheet.prototype.parseTableData,GenericContainerSpreadSheet.prototype.getData=SpreadSheet.prototype.getData,GenericContainerSpreadSheet.prototype.loadData=SpreadSheet.prototype.loadData,GenericContainerSpreadSheet.prototype.setDataAtCell=SpreadSheet.prototype.setDataAtCell,GenericContainerSpreadSheet.prototype.getColumnIndex=SpreadSheet.prototype.getColumnIndex,GenericContainerSpreadSheet.prototype.disableAll=SpreadSheet.prototype.disableAll,GenericContainerSpreadSheet.prototype.setContainerType=SpreadSheet.prototype.setContainerType,GenericContainerSpreadSheet.prototype.updateNumberOfRows=SpreadSheet.prototype.updateNumberOfRows,GenericContainerSpreadSheet.prototype.emptyRow=SpreadSheet.prototype.emptyRow,GenericContainerSpreadSheet.prototype.load=function(a){function b(a,b,d,e,f,g,h){return Handsontable.renderers.TextRenderer.apply(this,arguments),a.getDataAtRow(d)[1]?(2==e&&(g&&""!=g||(b.className="custom-row-text-required")),void(e!=c.unitCellIndex&&e!=c.spaceGroupIndex||(b.style.background="#EEE"))):void(b.style.background="#EEE")}var c=this;this.container=a;var d=document.getElementById(this.id+"_samples"),e=this.getSamplesData(a);Handsontable.renderers.registerRenderer("ValueRenderer",b),this.spreadSheet=new Handsontable(d,{afterCreateRow:function(a,b){e.splice(a,b)},beforeChange:function(a,b){lastChange=a},data:e,height:this.height,width:this.width,manualColumnResize:!0,colWidths:this.getHeaderWidth(),colHeaders:this.getHeaderText(),stretchH:"last",columns:this.getColumns()})},GenericContainerSpreadSheet.prototype.getSamplesData=function(a){for(var b=[],c=0;c<a.capacity;c++)if(a.samples)if(c<a.samples.length){var d=a.samples[c];b.push([c+1,d.Protein_acronym,d.BLSample_name,d.BLSample_comments])}else b.push([c+1]);else b.push([c+1]);return b},GenericContainerSpreadSheet.prototype.getHeader=function(){var a=[];return a=[{text:"#",id:"position",column:{width:20}},{text:"Samplesheet <br />Acronym",id:"Protein Acronym",column:{width:100,type:"dropdown",source:this.getAcronyms()}},{text:"Sample<br /> Name",id:"Sample Name",column:{width:120}},{text:"Comments",id:"Comments",column:{width:200}}]},GenericContainerSpreadSheet.prototype.getPuck=function(){function a(a){return _.filter(a,function(a){return a.BLSample_location==b[d].location})}var b=this.parseTableData(),c={};c.sampleVOs=[];for(var d=0;d<b.length;d++){var e={},f=a(this.container.samples);f.length>0&&(e=f[0]),e.Protein_acronym=b[d]["Protein Acronym"],e.BLSample_name=b[d]["Sample Name"],e.location=b[d].location,e.BLSample_comments=b[d].Comments,e.crystalVO={proteinVO:EXI.proposalManager.getProteinByAcronym(b[d]["Protein Acronym"])[0]},e.diffractionPlanVO={},c.sampleVOs.push(e)}return c},OtherContainerForm.prototype.load=function(a){a&&(this.container=a,this.container.samples||(this.container.samples=[]),this.container.capacity||(this.container.capacity=a.samples.length),Ext.getCmp(this.id+"container_name").setValue(a.code),Ext.getCmp(this.id+"capacity").setValue(this.container.capacity),this.containerSpreadSheet.load(this.container),this.panel.doLayout())},OtherContainerForm.prototype.getPanel=function(){var a=this;return this.panel=Ext.create("Ext.form.Panel",{autoScroll:!0,buttons:this.getButtons(),items:[{xtype:"container",margin:"5 0 2 5",layout:"hbox",items:[{xtype:"container",margin:"12 0 2 0",layout:"hbox",items:[{xtype:"requiredtextfield",id:this.id+"container_name",fieldLabel:"Name",name:"name",width:250,margin:"5 5 5 5",labelWidth:100},{xtype:"numberfield",id:this.id+"capacity",fieldLabel:"Capacity",width:250,disabled:!1,margin:"5 5 5 10",labelWidth:100,minValue:0,listeners:{change:function(b,c,d){a.panel.setLoading(!0),a.containerSpreadSheet.updateNumberOfRows(c),a.panel.setLoading(!1)}}}]}]},this.containerSpreadSheet.getPanel()]}),this.panel},OtherContainerForm.prototype.getButtons=function(){var a=this;return[{text:"Save",id:this.id+"-save-button",handler:function(){a.save()}},{text:"Cancel",handler:function(){a.onCancel.notify()}}]},OtherContainerForm.prototype.getContainer=function(){return this.container.code=Ext.getCmp(this.id+"container_code").getValue(),this.container.containerType="OTHER",this.container.capacity=this.container.samples.length,this.container},OtherContainerForm.prototype.save=function(){var a=this;this.panel.setLoading("Saving Puck");var b=this.containerSpreadSheet.getPuck();b.code=Ext.getCmp(a.id+"container_name").getValue(),b.capacity=Ext.getCmp(a.id+"capacity").getValue(),b.containerType="OTHER",b.containerId=this.container.containerId;var c=function(b,c){a.panel.setLoading(!1),EXI.setError(c.responseText)},d=function(c){a.panel.setLoading(!1),a.onSave.notify(b)};EXI.getDataAdapter({onSuccess:d,onError:c}).proposal.shipping.saveContainer(this.container.containerId,this.container.containerId,this.container.containerId,b)},ParcelGrid.prototype._getTopButtons=function(){var a=this;return Ext.create("Ext.Action",{id:this.id+"-add-button",icon:"../images/icon/add.png",text:"Add",disabled:!0,handler:function(b,c){a.edit()}})},ParcelGrid.prototype.load=function(a,b,c,d){var e=this;this.shipment=a,this.dewars=a.dewarVOs,this.hasExportedData=b,this.samples=_.groupBy(c,"Dewar_dewarId"),this.withoutCollection=_.groupBy(d,"Dewar_dewarId"),this.dewars.sort(function(a,b){return a.dewarId-b.dewarId}),$("#"+this.id+"-label").html("Content ("+this.dewars.length+" Parcels)"),$("#"+this.id+"-add-button").removeClass("disabled"),$("#"+this.id+"-add-button").unbind("click").click(function(a){e.edit()}),this.fillTab("content",this.dewars),this.attachCallBackAfterRender()},ParcelGrid.prototype.fillTab=function(a,b){function c(a,b){d.panel.setLoading(),b.sessionId=b.firstExperimentId,b.shippingId=d.shipment.shippingId;var c=function(a,b){d.panel.setLoading(!1),d.panel.doLayout()};EXI.getDataAdapter({onSuccess:c}).proposal.dewar.saveDewar(d.shipment.shippingId,b)}var d=this;$("#"+a+"-"+this.id).html(""),this.parcelPanels[a]=Ext.create("Ext.panel.Panel",{autoScroll:!0,autoHeight:!0,maxHeight:this.height,renderTo:a+"-"+this.id});for(var e in b){var f=new ParcelPanel({height:90,width:this.width-60,shippingId:this.shipment.shippingId,shippingStatus:this.shipment.shippingStatus,index:Number(e)+1,currentTab:a});this.parcelPanels[a].insert(f.getPanel()),f.load(this.dewars[e],this.shipment,this.samples[this.dewars[e].dewarId],this.withoutCollection[this.dewars[e].dewarId]),f.onSavedClick.attach(c)}this.parcelPanels[a].doLayout(),this.panel.doLayout()},ParcelGrid.prototype.edit=function(a){var b=this,c=new CaseForm,d=Ext.create("Ext.window.Window",{title:"Parcel",height:450,width:600,modal:!0,layout:"fit",items:[c.getPanel(a)],listeners:{afterrender:function(a,c){null!=b.puck&&b.render(b.puck)}},buttons:[{text:"Save",handler:function(){new DataAdapter;b.panel.setLoading();var a=c.getDewar(),e=function(a,c){b.load(c),b.panel.setLoading(!1),d.close()};a.sessionId=a.firstExperimentId,a.shippingId=b.shipment.shippingId,EXI.getDataAdapter({onSuccess:e}).proposal.dewar.saveDewar(b.shipment.shippingId,a)}},{text:"Cancel",handler:function(){d.close()}}]});d.show()},ParcelGrid.prototype.getPanel=function(){var a="";return dust.render("parcel.grid.template",{id:this.id},function(b,c){a=c}),this.panel=Ext.create("Ext.panel.Panel",{items:{html:'<div id="'+this.id+'">'+a+"</div>",width:this.width,autoScroll:!1,autoHeight:!0,padding:this.padding}}),this.panel},ParcelGrid.prototype.attachCallBackAfterRender=function(){var a=this,b=function(b){this.grid=b,$('a[data-toggle="tab"]').on("shown.bs.tab",function(b){var c=$(b.target).attr("href");c.startsWith("#co")&&a.fillTab("content",a.dewars),c.startsWith("#st")&&a.fillTab("statistics",a.dewars),a.panel.doLayout()})};setTimeout(b,500,this)},PuckFormView.prototype.load=function(a,b,c){var d=this;this.shippingId=b,this.shippingStatus=c,this.containerId=a,this.panel.setTitle("Shipment");var e=function(a,b){d.puck=b,null!=b&&(Ext.getCmp(d.id+"puck_name").setValue(d.puck.code),d.puck.capacity?d.capacityCombo.setValue(d.puck.capacity):$.notify("ERROR: The capacity of the container is not defined.","error"),Ext.getCmp(d.id+"puck_beamline").setValue(d.puck.beamlineLocation),Ext.getCmp(d.id+"puck_sampleChangerLocation").setValue(d.puck.sampleChangerLocation),Ext.getCmp(d.id+"puck_status").setValue(d.puck.containerStatus)),d.fillSamplesGrid(b)};EXI.getDataAdapter({onSuccess:e}).proposal.shipping.getContainerById(this.containerId,this.containerId,this.containerId)},PuckFormView.prototype.fillSamplesGrid=function(a){var b=this;this.containerSpreadSheet.setLoading(!0);var c=function(c,d){if(d){if(d.length>0?b.containerSpreadSheet.setRenderCrystalFormColumn(!0):b.containerSpreadSheet.setRenderCrystalFormColumn(!1),b.containerSpreadSheet.setContainerType(a.containerType),b.containerSpreadSheet.load(a),"processing"!=b.shippingStatus){var e=_.filter(d,{DataCollectionGroup_dataCollectionGroupId:null});e.length==d.length&&(Ext.getCmp(b.id+"_save_button").enable(),Ext.getCmp(b.id+"_remove_button").enable(),b.capacityCombo.enable())}else b.containerSpreadSheet.disableAll();b.containerSpreadSheet.setLoading(!1),b.containerSpreadSheet.renderCrystalFormColumn&&b.setValuesForEditCrystalColumn()}};EXI.getDataAdapter({onSuccess:c}).mx.sample.getSamplesByContainerId(a.containerId)},PuckFormView.prototype.getPanel=function(){return this.panel=Ext.create("Ext.panel.Panel",{autoScroll:!0,buttons:this.getToolBar(),items:[{xtype:"container",margin:"5 0 2 5",layout:"hbox",items:[{xtype:"container",margin:"12 0 2 0",layout:"hbox",items:[{xtype:"requiredtextfield",id:this.id+"puck_name",fieldLabel:"Name",name:"name",width:250,margin:"5 5 5 5",labelWidth:100},this.capacityCombo.getPanel(),{xtype:"textfield",id:this.id+"puck_beamline",fieldLabel:"Beamline",width:250,disabled:!0,margin:"5 5 5 10",labelWidth:100},{xtype:"textfield",id:this.id+"puck_sampleChangerLocation",fieldLabel:"#Sample Changer",width:300,disabled:!0,margin:"5 5 5 5",labelWidth:150},{xtype:"textfield",id:this.id+"puck_status",fieldLabel:"Status",width:250,disabled:!0,margin:"5 5 5 5",labelWidth:100}]}]},this.containerSpreadSheet.getPanel()]}),this.panel},PuckFormView.prototype.getToolBar=function(){var a=this;return[{text:"Remove",id:this.id+"_remove_button",width:100,height:30,disabled:!0,cls:"btn-red",handler:function(){function b(b){"yes"==b&&a.removePuck()}Ext.MessageBox.show({title:"Remove",msg:"Removing a puck from this parcel will remove also its content. <br />Are you sure you want to continue?",buttons:Ext.MessageBox.YESNO,fn:b,animateTarget:"mb4",icon:Ext.MessageBox.QUESTION})}},"->",{text:"Save",id:this.id+"_save_button",width:100,height:30,disabled:!0,handler:function(){a.save()}},{text:"Return to shipment",width:200,height:30,handler:function(){a.returnToShipment()}}]},PuckFormView.prototype.removePuck=function(){var a=this;this.panel.setLoading();var b=function(b,c){a.panel.setLoading(!1),location.href="#/shipping/"+a.shippingId+"/main";
};EXI.getDataAdapter({onSuccess:b}).proposal.shipping.removeContainerById(this.containerId,this.containerId,this.containerId)},PuckFormView.prototype.returnToShipment=function(){this.puck.code!=Ext.getCmp(this.id+"puck_name").getValue()&&(this.unsavedChanges=!0),this.unsavedChanges?this.showReturnWarning():location.href="#/shipping/"+this.shippingId+"/main"},PuckFormView.prototype.save=function(a){var b=this,c=this.containerSpreadSheet.getPuck();if(c.sampleVOs&&c.sampleVOs.length>0){var d=_.map(c.sampleVOs,"name");if(d.indexOf(null)>=0||d.indexOf("")>=0)return void $.notify("There are samples without a Sample Name","error")}c.code=Ext.getCmp(b.id+"puck_name").getValue(),c.capacity=b.capacityCombo.getSelectedCapacity(),c.containerType=b.capacityCombo.getSelectedType();var e=function(a,c){b.panel.setLoading(!1),EXI.setError(c.responseText)},f=function(c,d){b.unsavedChanges=!1,b.panel.setLoading(!1),a?location.href="#/shipping/"+b.shippingId+"/main":b.load(b.containerId,b.shippingId)};this.panel.setLoading("Saving Puck"),EXI.getDataAdapter({onSuccess:f,onError:e}).proposal.shipping.saveContainer(this.containerId,this.containerId,this.containerId,c)},PuckFormView.prototype.containerTypeChanged=function(a){var b=(this.capacityCombo.getTypeByCapacity(this.puck.capacity),this.capacityCombo.getTypeByCapacity(a));this.puck.capacity=a,this.containerSpreadSheet.setContainerType(b),this.containerSpreadSheet.updateNumberOfRows(a)},PuckFormView.prototype.setValuesForEditCrystalColumn=function(a){for(var b=this.containerSpreadSheet.parseTableData(),c=this.containerSpreadSheet.getColumnIndex("editCrystalForm"),d=0;d<b.length;d++)this.containerSpreadSheet.addEditCrystalFormButton(b[d].location-1,c);this.panel.doLayout()},PuckFormView.prototype.showReturnWarning=function(){var a=this,b=Ext.create("Ext.window.Window",{title:"Container",width:250,layout:"fit",modal:!0,items:[{html:'<div class="container-fluid" style="margin:10px;"><div class="row"><span style="font-size:14px;color: #666;">Do you want to save the changes to the container '+a.puck.code+"?</span></div></div>"}],buttons:[{text:"Yes",handler:function(){b.close(),a.save(!0)}},{text:"No",handler:function(){b.close(),location.href="#/shipping/"+a.shippingId+"/main"}},{text:"Cancel",handler:function(){b.close()}}]});b.show()},ShipmentEditForm.prototype.load=function(a){this.shipment=a;var b="";try{var c=EXI.proposalManager.getLabcontacts(),d=$.extend(EXI.proposalManager.getLabcontacts(),[{cardName:"Same as for shipping to beamline",labContactId:-1},{cardName:"No return requested",labContactId:0}]),e="",f="";a&&a.sessions.length>0&&(e=a.sessions[0].beamlineName,f=new Date(a.sessions[0].startDate).toLocaleDateString());var g=function(a,b){var c=new Date(a.BLSession_startDate),d=new Date(b.BLSession_startDate);return c===d?0:d>c?1:-1},h=EXI.proposalManager.getSessions();h.sort(g);for(var i=[],j=new Date((new Date).toDateString()),k=0;k<h.length;k++){var l=h[k],m=new Date(l.BLSession_startDate);if(j<=new Date(m.toDateString())){var n=m.getDate(),o=m.getMonth()+1,p=m.getFullYear();10>n&&(n="0"+n),10>o&&(o="0"+o);var q=n+"/"+o+"/"+p;i.push({sessionId:l.sessionId,date:m.toLocaleDateString(),formattedDate:q,beamLineName:l.beamLineName})}}dust.render("shipping.edit.form.template",{id:this.id,sessions:i,to:d,from:c,beamlineName:e,startDate:f,shipment:a},function(a,c){b=c})}catch(r){b="There was an error loading the lab contacts."}$("#"+this.id).hide().html(b).fadeIn("fast"),this.panel.doLayout()},ShipmentEditForm.prototype.getPanel=function(){return this.panel=Ext.create("Ext.panel.Panel",{items:[{html:'<div id="'+this.id+'"></div>',autoScroll:!1,width:this.width,height:this.height}]}),this.panel},ShipmentEditForm.prototype.saveShipment=function(){var a=this,b=$("#"+this.id+"-to").val(),c=$("#"+this.id+"-from").val(),d=null;if(this.shipment&&(d=this.shipment.shippingId),null==b)return void BUI.showError("User contact information for shipping to beamline is mandatory");"No return requested"==c&&(c=0),"Same as for shipping to beamline"==c&&(c=-1);var e=EXI.proposalManager.getLabcontactById(b),f={shippingId:d,name:$("#"+this.id+"-name").val(),status:"Not set",sendingLabContactId:b,returnLabContactId:c,returnCourier:c,courierAccount:e.courierAccount,billingReference:e.billingReference,dewarAvgCustomsValue:e.dewarAvgCustomsValue,dewarAvgTransportValue:e.dewarAvgTransportValue,comments:$("#"+this.id+"-comments").val(),sessionId:$("#"+this.id+"-date").val()},g=function(b,c){a.panel.setLoading(!1),a.onSaved.notify(c)};return""==f.name?void BUI.showError("Name field is mandatory"):null==f.sendingLabContactId?void BUI.showError("Lab contact for sending field is mandatory"):(this.panel.setLoading(),void EXI.getDataAdapter({onSuccess:g}).proposal.shipping.saveShipment(f))},ShipmentForm.prototype.load=function(a,b){this.shipment=a,this.hasExportedData=b;var c=this,d=EXI.proposalManager.getLabcontacts(),e=$.extend(EXI.proposalManager.getLabcontacts(),[{cardName:"Same as for shipping to beamline",labContactId:-1},{cardName:"No return requested",labContactId:0}]),f="",g="",h="";a&&a.sessions.length>0&&(g=a.sessions[0].beamlineName,h=moment(a.sessions[0].startDate).format("DD/MM/YYYY")),dust.render("shipping.form.template",{id:this.id,to:d,from:e,beamlineName:g,startDate:h,shipment:a},function(a,b){f=b}),$("#"+c.id).hide().html(f).fadeIn("fast"),null!=a&&"processing"==a.shippingStatus||($("#"+c.id+"-edit-button").prop("disabled",!1),$("#"+c.id+"-edit-button").unbind("click").click(function(a){c.edit()}),this.hasExportedData||($("#"+c.id+"-remove-button").removeClass("disabled"),$("#"+c.id+"-remove-button").unbind("click").click(function(a){alert("Not implemented")}))),this.panel.doLayout(),this.attachCallBackAfterRender()},ShipmentForm.prototype.getPanel=function(){return this.panel=Ext.create("Ext.panel.Panel",{layout:"fit",items:[{html:'<div id="'+this.id+'"></div>',autoScroll:!1,padding:this.padding,width:this.width}]}),this.panel},ShipmentForm.prototype.edit=function(a){var b=this,c=new ShipmentEditForm;c.onSaved.attach(function(a,c){b.shipment?b.load(c):b.onSaved.notify(c),d.close()});var d=Ext.create("Ext.window.Window",{title:"Shipment",height:450,width:600,modal:!0,layout:"fit",items:[c.getPanel()],buttons:[{text:"Save",handler:function(){c.saveShipment()}},{text:"Cancel",handler:function(){d.close()}}]}).show();c.load(this.shipment)},ShipmentForm.prototype.attachCallBackAfterRender=function(){var a=this,b=function(b){this.grid=b,$('a[data-toggle="tab"]').on("shown.bs.tab",function(b){a.panel.doLayout()})};setTimeout(b,500,this)},ShippingMainView.prototype.getPanel=function(){return this.panel=Ext.create("Ext.panel.Panel",{layout:{type:"vbox",align:"center"},autoScroll:!0,cls:"border-grid",items:[this.shipmentForm.getPanel(),this.parcelGrid.getPanel()]}),this.panel},ShippingMainView.prototype.load=function(a){var b=this;if(this.shippingId=a,this.panel.setTitle("Shipment"),null!=a){this.panel.setLoading();var c=function(a,c){var d=_.map(_.union(_.flatten(_.map(c.dewarVOs,"containerVOs"))),"containerId");if(d.length>0){var e=function(a,d){var e=!1;if(d){var f=_.filter(d,{DataCollectionGroup_dataCollectionGroupId:null});e=!(f.length==d.length)}b.shipmentForm.load(c,e),b.parcelGrid.load(c,e,d,f),b.panel.setLoading(!1)};EXI.getDataAdapter({onSuccess:e}).mx.sample.getSamplesByContainerId(d)}else b.shipmentForm.load(c,!1),b.parcelGrid.load(c,!1),b.panel.setLoading(!1)};EXI.getDataAdapter({onSuccess:c}).proposal.shipping.getShipment(a)}else b.shipmentForm.load(),b.panel.setLoading(!1)},WelcomeMainView.prototype.getPanel=MainView.prototype.getPanel,WelcomeMainView.prototype.getContainer=function(){return{layout:{type:"fit"},items:[{html:"<iframe style='width:900px;height:900px;' frameBorder='0' src='../html/welcome.html'></iframe>",margin:"50 0 0 50"}]}},WelcomeMainView.prototype.load=function(){},AddressEditForm.prototype.load=function(a){this.address={},a&&(this.address=a),this.address.id=this.id;var b="";dust.render("address.edit.form.template",this.address,function(a,c){b=c}),$("#"+this.id).hide().html(b).fadeIn("fast"),this.panel.doLayout()},AddressEditForm.prototype.getPanel=function(){return this.panel=Ext.create("Ext.panel.Panel",{items:[{html:'<div id="'+this.id+'"></div>',autoScroll:!1,margin:10,padding:this.padding,width:this.width}]}),this.panel},AddressEditForm.prototype.save=function(){var a=this,b=this.getAddress(),c=function(c,d){a.onSaved.notify(b)};EXI.getDataAdapter({onSuccess:c}).proposal.labcontacts.saveLabContact(b)},AddressEditForm.prototype.getAddress=function(){var a={};return a=this.address,a.labContactId||(a.labContactId=null),a.personVO||(a.personVO={},a.personVO.personId=null),a.personVO.laboratoryVO||(a.personVO.laboratoryVO={},a.personVO.laboratoryVO.laboratoryId=null),a.personVO.emailAddress=$("#"+this.id+"-emailAddress").val(),a.personVO.familyName=$("#"+this.id+"-familyName").val(),a.personVO.givenName=$("#"+this.id+"-givenName").val(),a.personVO.phoneNumber=$("#"+this.id+"-phoneNumber").val(),a.personVO.faxNumber=$("#"+this.id+"-faxNumber").val(),a.personVO.laboratoryVO.name=$("#"+this.id+"-labName").val(),a.personVO.laboratoryVO.address=$("#"+this.id+"-labAddress").val(),a.cardName=$("#"+this.id+"-cardName").val(),a.courierAccount=$("#"+this.id+"-courierAccount").val(),a.defaultCourrierCompany=$("#"+this.id+"-defaultCourrierCompany").val(),a.dewarAvgCustomsValue=$("#"+this.id+"-dewarAvgCustomsValue").val(),a.dewarAvgTransportValue=$("#"+this.id+"-dewarAvgTransportValue").val(),a.billingReference=$("#"+this.id+"-billingReference").val(),a.labName=$("#"+this.id+"-labName").val(),a.labAddress=$("#"+this.id+"-labAddress").val(),a},AddressForm.prototype.getAddress=function(){return null==this.address&&(this.address={}),this.address.billingReference=Ext.getCmp(this.id+"billingReference").getValue(),this.address.cardName=Ext.getCmp(this.id+"cardName").getValue(),this.address.courierAccount=Ext.getCmp(this.id+"courierAccount").getValue(),this.address.defaultCourrierCompany=Ext.getCmp(this.id+"courrierCompany").getValue(),this.address.dewarAvgCustomsValue=Ext.getCmp(this.id+"dewarAvgCustomsValue").getValue(),this.address.dewarAvgTransportValue=Ext.getCmp(this.id+"dewarAvgTransportValue").getValue(),null==this.address.personVO&&(this.address.personVO={}),this.address.personVO.emailAddress=Ext.getCmp(this.id+"emailAddress").getValue(),this.address.personVO.familyName=Ext.getCmp(this.id+"familyName").getValue(),this.address.personVO.givenName=Ext.getCmp(this.id+"name").getValue(),this.address.personVO.faxNumber=Ext.getCmp(this.id+"faxNumber").getValue(),this.address.personVO.phoneNumber=Ext.getCmp(this.id+"phoneNumber").getValue(),this.address},AddressForm.prototype.load=function(a){this.address=a;var b="";dust.render("address.form.template",a,function(a,c){b=c}),$("#"+this.id).hide().html(b).fadeIn("fast"),this.panel.doLayout()},AddressForm.prototype.getPanel=function(){return this.panel=Ext.create("Ext.panel.Panel",{cls:"border-grid",title:"Shipping Address Card",buttons:this.getToolBar(),icon:"../images/icon/ic_email_black_24dp.png",items:[{html:'<div id="'+this.id+'"></div>',autoScroll:!1,margin:10,padding:this.padding,width:this.width}]}),this.panel},AddressForm.prototype.getToolBar=function(){var a=this;return[{text:"Edit",hidden:a.isSaveButtonHidden,width:100,handler:function(){a.edit()}}]},AddressForm.prototype.edit=function(a){var b=this,c=new AddressEditForm;c.onSaved.attach(function(a,c){d.close(),b.load(c)});var d=Ext.create("Ext.window.Window",{title:"Shipping Address Card",height:550,width:750,modal:!0,layout:"fit",items:[c.getPanel()],buttons:[{text:"Save",handler:function(){c.save()}},{text:"Cancel",handler:function(){d.close()}}]}).show();c.load(this.address)},AuthenticationForm.prototype.show=function(){this.window=Ext.create("Ext.window.Window",{title:"Login",height:250,closable:!1,width:450,modal:!0,layout:"fit",items:[this.getPanel()]}),this.window.show()},AuthenticationForm.prototype.getAuthenticationForm=function(){if(ExtISPyB.sites&&ExtISPyB.sites.length>1){var a=Ext.create("Ext.data.Store",{fields:["name","url","exiUrl"],data:ExtISPyB.sites});return{xtype:"container",layout:"vbox",items:[{xtype:"textfield",fieldLabel:"User",name:"user",margin:"10 0 0 10",allowBlank:!1},{xtype:"textfield",fieldLabel:"Password",margin:"10 0 0 10",name:"password",allowBlank:!1,inputType:"password"},{xtype:"combo",fieldLabel:"Choose site",name:"site",store:a,allowBlank:!1,valueField:"url",displayField:"name",margin:"10 0 0 10"}]}}return{xtype:"container",layout:"vbox",items:[{xtype:"textfield",fieldLabel:"User",name:"user",margin:"30 0 0 10",allowBlank:!1},{xtype:"textfield",fieldLabel:"Password",margin:"10 0 0 10",name:"password",allowBlank:!1,inputType:"password"}]}},AuthenticationForm.prototype.getIconForm=function(){return this.singleSite?{xtype:"image",src:this.site.icon,width:75,height:75,margin:"30 0 0 10"}:void 0},AuthenticationForm.prototype.getPanel=function(){var a=this;return ExtISPyB.sites&&1==ExtISPyB.sites.length&&(this.singleSite=!0,this.siteURL=ExtISPyB.sites[0].url,this.site=ExtISPyB.sites[0],this.icon=ExtISPyB.sites[0].icon),Ext.create("Ext.form.Panel",{bodyPadding:5,width:370,layout:"vbox",defaults:{anchor:"90%"},defaultType:"textfield",items:[{xtype:"container",layout:"hbox",items:[this.getIconForm(),this.getAuthenticationForm()]}],buttons:[{text:"Login",formBind:!0,disabled:!0,handler:function(){var b=this.up("form").getForm(),c=null;a.singleSite||(a.siteURL=b.getFieldValues().site);for(var d=0;d<ExtISPyB.sites.length;d++)ExtISPyB.sites[d].url==a.siteURL&&(c=ExtISPyB.sites[d]);a.onAuthenticate.notify({user:b.getFieldValues().user,password:b.getFieldValues().password,site:a.siteURL,exiUrl:c.exiUrl,properties:c})}}]})},ContainerParcelPanel.prototype.getPanel=function(){this.container=this.createContainer(this.data);var a=2*this.data.mainRadius+5;return this.containerPanel=Ext.create("Ext.panel.Panel",{width:this.width,height:a,items:[this.container.getPanel()]}),this.panel=Ext.create("Ext.panel.Panel",{layout:{type:"vbox",align:"center",pack:"center"},width:this.width,height:this.height,items:[this.containerPanel]}),this.height>=45&&this.panel.insert({html:"<div class='container-fluid' align='center'><span id='"+this.id+"-name' style='font-size:"+.15*this.height+"px;'>"+this.data.code+"</span></div>",height:.25*this.height,width:this.width}),this.panel},ContainerParcelPanel.prototype.load=function(a){if(null!=a&&a.length>0){"Puck"==this.data.puckType&&(_.map(a,function(a){a.location=parseInt(a.BLSample_location)}),_.maxBy(a,"location").location>10&&(this.data.puckType="Unipuck",this.container=this.createContainer(this.data))),this.containerPanel.removeAll(),this.containerPanel.add(this.container.getPanel()),a.length>0&&(this.container.loadSamples(a),this.container.containerId||(this.container.containerId=this.containerId));var b=_.filter(a,{DataCollectionGroup_dataCollectionGroupId:null});b.length<a.length&&(this.withoutCollection=!1)}},ContainerParcelPanel.prototype.removePuck=function(){if(this.panel.setLoading(),"StockSolution"==this.data.puckType)this.onContainerRemoved.notify(this.containerId);else{var a=this,b=function(b,c){a.panel.setLoading(!1),a.onContainerRemoved.notify(a.containerId)},c=this.containerId;EXI.getDataAdapter({onSuccess:b}).proposal.shipping.removeContainerById(c,c,c)}},ContainerParcelPanel.prototype.removeButtonClicked=function(){function a(a){"yes"==a&&b.removePuck()}var b=this;Ext.MessageBox.show({title:"Remove",msg:"Removing a container from this parcel will remove also its content. <br />Are you sure you want to continue?",buttons:Ext.MessageBox.YESNO,fn:a,animateTarget:"mb4",icon:Ext.MessageBox.QUESTION})},ContainerParcelPanel.prototype.openEditOtherContainerForm=function(){var a=this,b=new OtherContainerForm;b.onSave.attach(function(b,d){$("#"+a.id+"-name").html(d.code),a.container.samples=d.sampleVOs,a.container.capacity=d.capacity,c.close()}),b.onCancel.attach(function(a){c.close()});var c=Ext.create("Ext.window.Window",{title:"Container",height:600,width:1500,modal:!0,layout:"fit",items:[b.getPanel()],listeners:{afterrender:function(c,d){b.load(a.container)}}});c.show()},ContainerParcelPanel.prototype.createContainer=function(a){var b=this,c=new ContainerWidget(a);return"Puck"==a.puckType||"Unipuck"==a.puckType||"Spinepuck"==a.puckType?c=new PuckWidgetContainer(a):"StockSolution"==a.puckType?(a.stockSolutionId=this.containerId,c=new StockSolutionContainer(a)):"StatisticsPuck"==a.puckType&&(c=new PuckStatisticsContainer(a)),c.onClick.attach(function(c,d){var e=a.code;""==e&&(e="-");var f=Ext.create("Ext.window.Window",{title:"Container",width:250,layout:"fit",modal:!0,items:[{html:'<div class="container-fluid" style="margin:10px;"><div class="row"><span style="font-size:14px;color: #666;"><b>Code:</b> '+e+'</span></div><div class="row"><span style="font-size:12px;color: #666;">Select one of the options below:</span></div></div>'}],buttons:[{text:"Edit",handler:function(){"StockSolution"==a.puckType?location.href="#/stocksolution/"+b.containerId+"/main":"OTHER"==a.puckType?b.openEditOtherContainerForm():location.href="#/shipping/"+b.shippingId+"/"+b.shippingStatus+"/containerId/"+b.containerId+"/edit",f.close()}},{text:"Remove",disabled:"processing"==b.shippingStatus||!b.withoutCollection,handler:function(){b.removeButtonClicked(),f.close()}},{text:"Cancel",handler:function(){f.close()}}]});f.show()}),c.onMouseOver.attach(function(a,b){b.focus(!0)}),c.onMouseOut.attach(function(a,b){b.focus(!1)}),c},ContainerTypeComboBox.prototype.getPanel=function(){var a=this,b=Ext.create("Ext.data.Store",{fields:["type","capacity"],data:this.data});return this.panel=Ext.create("Ext.form.ComboBox",{layout:"fit",margin:"5 0 5 5",fieldLabel:this.label,store:b,labelStyle:"padding:5px",labelWidth:this.labelWidth,displayField:"type",value:"SPINE",width:this.width,disabled:this.initDisabled}),this.panel.on("select",function(b,c){a.onSelected.notify(c[0].data)}),this.panel},ContainerTypeComboBox.prototype.getValue=function(){return this.panel.getValue()},ContainerTypeComboBox.prototype.getSelectedType=function(){var a=this.panel.getValue();return"UNIPUCK"==a?a="Unipuck":"SPINE"==a&&(a="Spinepuck"),a},ContainerTypeComboBox.prototype.getSelectedCapacity=function(){return _.filter(this.data,{type:this.getValue()})[0].capacity},ContainerTypeComboBox.prototype.getTypeByCapacity=function(a){return _.filter(this.data,{capacity:a})[0].type},ContainerTypeComboBox.prototype.setValue=function(a){var b=this.getTypeByCapacity(a);this.panel.setValue(b)},ContainerTypeComboBox.prototype.enable=function(){this.panel.enable()},ContainerWidget.prototype.getPanel=function(){var a=this;return this.panel=Ext.create("Ext.panel.Panel",{id:this.id+"-container",x:this.templateData.xMargin,y:this.templateData.yMargin,width:this.templateData.width+1,height:this.templateData.height+1,frame:!1,border:!1,bodyStyle:"background:transparent;",items:[{html:this.getSVG(),width:this.templateData.width+1,height:this.templateData.height+1}]}),this.panel.on("boxready",function(){a.templateData.enableMainClick&&$("#"+a.id).unbind("click").click(function(b){a.onClick.notify(b.target.id)}),a.templateData.enableMainMouseOver&&($("#"+a.id).unbind("mouseover").mouseover(function(b){a.onMouseOver.notify(a)}),$("#"+a.id).unbind("mouseout").mouseout(function(b){a.onMouseOut.notify(a)}))}),this.panel},ContainerWidget.prototype.loadSamples=function(a){this.samples=a,a&&a.length>0&&(this.containerId=a[0].Container_containerId)},ContainerWidget.prototype.getSVG=function(a){var b="";return dust.render("container.widget.template",this.templateData,function(a,c){b=c}),b},ContainerWidget.prototype.focus=function(a){a?$("#"+this.id).addClass("puck-selected"):$("#"+this.id).removeClass("puck-selected")},CurvePlotter.prototype.getPanel=function(){return this.plotPanel=Ext.create("Ext.container.Container",{layout:{type:"hbox"},flex:.7,margin:this.margin,items:[{html:'<div id="'+this.targetId+'"></div>',id:this.id}]}),this.plotPanel.on("afterrender",function(){}),this.plotPanel.on("resize",function(){}),this.plotPanel},CurvePlotter.prototype.getPointCount=function(){return this.dygraph.rawData_.length},CurvePlotter.prototype.getColors=function(){return this.dygraph.getColors()},CurvePlotter.prototype.getLabels=function(){return this.dygraph.getLabels()},CurvePlotter.prototype.render=function(a){var b=this;null!=document.getElementById(this.targetId)&&(document.getElementById(this.targetId).innerHTML="",this.width=this.plotPanel.getWidth(),this.height=this.plotPanel.getHeight(),document.getElementById(this.targetId).setAttribute("style","border: 1px solid #000000; height:"+(this.plotPanel.getHeight()-1)+"px;width:"+(this.plotPanel.getWidth()-2)+"px;"),Ext.getCmp(this.id).setHeight(this.plotPanel.getHeight()),Ext.getCmp(this.id).setWidth(this.plotPanel.getWidth()),this.dygraph=new Dygraph(document.getElementById(this.targetId),a,{title:this.title,titleHeight:20,legend:this.legend,labelsSeparateLines:!0,errorBars:!0,connectSeparatedPoints:!0,pointClickCallback:function(a,c){b.onPointClickCallback.notify(c.name)}}),this.dygraph.ready(function(){b.onRendered.notify()}))},CurvePlotter.prototype.loadMerge=function(a,b,c,d){this.render(EXI.getDataAdapter().saxs.hplc.getFramesMergeURL(a,b,c,d))},CurvePlotter.prototype.loadHPLCFrame=function(a,b){this.render(EXI.getDataAdapter().saxs.hplc.getHPLCFramesScatteringURL(a,b))},CurvePlotter.prototype.loadUrl=function(a){this.render(a)},CurvePlotter.prototype.load=function(a){this.render(EXI.getDataAdapter().saxs.frame.getFramesURL(a.frame,a.average,a.subtracted,a.sampleaverage,a.bufferaverage))},AutoProcIntegrationCurvePlotter.prototype.getPointCount=CurvePlotter.prototype.getPointCount,AutoProcIntegrationCurvePlotter.prototype.getLabels=CurvePlotter.prototype.getLabels,AutoProcIntegrationCurvePlotter.prototype.toCSV=function(a,b){for(var c=a.toString()+"\n",d=0;d<b.length;d++){for(var e=0;e<b[d].length;e++)c=c+b[d][e]+",";c=c.substring(0,c.length-1),c+="\n"}return c},AutoProcIntegrationCurvePlotter.prototype.render=function(a,b){var c=this,d=new Dygraph(document.getElementById(this.targetId),this.toCSV(a,b),{title:this.title,titleHeight:20,legend:"always",height:this.height-100,hideOverlayOnMouseOut:!0,labelsSeparateLines:!0,labelsDiv:c.targetId+"_legend",labelsDivStyles:" { 'fontSize': 6 } ",axisLabelWidth:20,connectSeparatedPoints:!0,pointClickCallback:function(a,b){c.onPointClickCallback.notify(b.name)},axes:{x:{pixelsPerXLabel:30,axisLabelFormatter:function(a,b,d){return c.xLabels[a]}}}});d.ready(function(){})},AutoProcIntegrationCurvePlotter.prototype.loadUrl=function(a){$.ajax({url:a,context:this}).done(function(a){var b=0,c=this;if(c.xLabels=[],!a)return void EXI.setError("CSV is empty");var d=a.split("\n");if(d){if(!d[0])return void EXI.setError("No labels on csv");this.data.labels=d[0].split(",");var e=function(a){return a&&""!=a?parseFloat(a):""},f=function(a){var d=[],f=a.split(",");f=_.map(f,e),d.push(b),c.xLabels.push(f[0]);for(var g=1;g<f.length;g++)g%2!=0&&d.push(f[g]);return b+=1,d};d=d.reverse(),this.data.data=_.map(_.slice(d,1,d.length-1),f);try{this.render(this.data.labels,this.data.data)}catch(g){EXI.setError(g.message)}}})},AutoProcIntegrationCurvePlotter.prototype.getHTML=function(){return'<div  id="'+this.targetId+'"></div><div  style="height:20px" id="'+this.targetId+'_legend"></div>'},AutoProcIntegrationCurvePlotter.prototype.getPanel=function(){return this.plotPanel=Ext.create("Ext.panel.Panel",{layout:{type:"fit"},height:this.height,margin:this.margin,items:[{html:this.getHTML(),id:this.id,style:{border:"1px solid black"},height:this.height,border:1}]}),this.plotPanel},ParcelPanel.prototype.load=function(a,b,c,d){var e=this;this.dewar=a,this.dewar.index=this.index,this.shipment=b,b&&b.sessions.length>0&&(this.dewar.beamlineName=b.sessions[0].beamlineName),this.samples=c,this.withoutCollection=d;var f="";dust.render("parcel.panel.template",{id:this.id,dewar:this.dewar,height:this.height,width:this.width},function(a,b){f=b}),$("#"+this.id).hide().html(f).fadeIn("fast"),this.panel.doLayout(),"processing"!=this.shippingStatus&&($("#"+this.id+"-add-button").removeClass("disabled"),$("#"+this.id+"-add-button").click(function(){e.showAddContainerForm()}),$("#"+this.id+"-edit-button").removeClass("disabled"),$("#"+this.id+"-edit-button").click(function(){e.showCaseForm()})),$("#"+this.id+"-print-button").click(function(){var a=e.dewar.dewarId,b=EXI.getDataAdapter().proposal.shipping.getDewarLabelURL(a,a);location.href=b}),this.containersPanel=Ext.create("Ext.panel.Panel",{id:this.id+"-containers-panel",cls:"border-grid-light",margin:0*this.height+" 0 "+.05*this.height+" 0",width:this.containersPanelWidth,height:this.containersPanelHeight,autoScroll:!1,items:[],renderTo:this.id+"-container-panel-div"}),"content"==this.currentTab?this.renderDewarParameters(a):this.renderDewarStatistics(a),this.renderDewarComments(a),this.renderPucks(a)},ParcelPanel.prototype.renderDewarParameters=function(a){var b="";dust.render("parcel.panel.parameter.table.template",{id:this.id,dewar:a,height:this.height},function(a,c){b=c}),$("#"+this.id+"-parameters-div").hide().html(b).fadeIn("fast")},ParcelPanel.prototype.renderDewarStatistics=function(a){var b="",c=0;a.containerVOs&&(c=a.containerVOs.length);var d=0,e=0;this.samples&&(d=this.samples.length);var e=d;this.withoutCollection&&(e=d-this.withoutCollection.length),dust.render("parcel.panel.statistics.template",{id:this.id,height:this.height,dewar:a,nContainers:c,nSamples:d,nMeasured:e},function(a,c){b=c}),$("#"+this.id+"-parameters-div").hide().html(b).fadeIn("fast")},ParcelPanel.prototype.renderDewarComments=function(a){""!=a.comments&&null!=a.comments?($("#"+this.id+"-comments").hide().html("Comments: "+a.comments).fadeIn("fast"),$("#"+this.id+"-index-td").attr("rowspan",2),$("#"+this.id+"-buttons-td").attr("rowspan",2),this.panel.setHeight(this.height+25)):($("#"+this.id+"-comments").hide().html("").fadeIn("fast"),$("#"+this.id+"-index-td").attr("rowspan",1),$("#"+this.id+"-buttons-td").attr("rowspan",1),this.panel.setHeight(this.height))},ParcelPanel.prototype.renderPucks=function(a){var b=this;if(this.containersPanel.setLoading(!1),null!=a&&null!=a.containerVOs){this.containersPanel.removeAll();var c=EXI.proposalManager.getStockSolutionsByDewarId(a.dewarId);if(a.containerVOs.length)var d=Math.floor(this.containersPanel.width/this.containersParcelWidth);null==d&&(d=Math.floor(this.containersPanel.width/this.containersParcelWidth));for(var e=Math.ceil((this.dewar.containerVOs.length+c.length)/d),f=[],g=0;e>g;g++){var h=Ext.create("Ext.panel.Panel",{layout:"hbox",width:this.containersPanelWidth,height:this.containersPanelHeight/e,autoScroll:!1,items:[]});f.push(h),this.containersPanel.insert(h)}a.containerVOs.sort(function(a,b){return a.containerId-b.containerId});for(var i=[],g=0;g<a.containerVOs.length;g++){var j=a.containerVOs[g],k=j.containerType;"statistics"==this.currentTab&&(k="StatisticsPuck");var l=new ContainerParcelPanel({type:k,height:this.containersPanelHeight/e,width:this.containersParcelWidth,containerId:j.containerId,shippingId:this.shippingId,shippingStatus:this.shippingStatus,capacity:j.capacity,code:j.code});l.onContainerRemoved.attach(function(a,c){_.remove(b.dewar.containerVOs,{containerId:c}),b.renderPucks(b.dewar)}),i.push(j.containerId),f[Math.floor(g/d)].insert(l.getPanel()),l.load(_.filter(this.samples,{BLSample_containerId:j.containerId}))}for(var g=0;g<c.length;g++){$("#hoveringTooltipDiv-"+c[g].stockSolutionId).remove();var l=new ContainerParcelPanel({type:"StockSolution",height:this.containersPanelHeight/e,width:this.containersParcelWidth,containerId:c[g].stockSolutionId,shippingId:this.shippingId,shippingStatus:this.shippingStatus,code:c[g].name});i.push(c[g].boxId),l.onContainerRemoved.attach(function(a,c){var d=EXI.proposalManager.getStockSolutionById(c);d.boxId=null;var e=function(a,c){EXI.proposalManager.get(!0),b.renderPucks(b.dewar)};EXI.getDataAdapter({onSuccess:e}).saxs.stockSolution.saveStockSolution(d)}),f[Math.floor((g+a.containerVOs.length)/d)].insert(l.getPanel())}}},ParcelPanel.prototype.addContainerToDewar=function(a){var b=this;if(this.containersPanel.setLoading(),"STOCK SOLUTION"==a.containerType){var c=EXI.proposalManager.getStockSolutionById(a.data.stockSolutionId);c.boxId=this.dewar.dewarId,""!=a.code&&(c.name=a.code);var d=function(a,c){EXI.proposalManager.get(!0),b.renderPucks(b.dewar)};EXI.getDataAdapter({onSuccess:d}).saxs.stockSolution.saveStockSolution(c)}else{var d=function(c,d){d.code=a.code,d.containerStatus=b.dewar.dewarStatus,d.sampleChangerLocation=b.dewar.storageLocation,b.shipment&&b.shipment.sessions&&b.shipment.sessions.length>0&&(d.beamlineLocation=b.shipment.sessions[0].beamlineName),d.sampleVOs=[],b.dewar.containerVOs.push(d);var e=function(a){b.renderPucks(b.dewar)},f=function(a,c){EXI.setError(c.responseText),b.renderPucks(b.dewar)};EXI.getDataAdapter({onSuccess:e,onError:f}).proposal.shipping.saveContainer(b.shippingId,b.dewar.dewarId,d.containerId,d)};EXI.getDataAdapter({onSuccess:d}).proposal.shipping.addContainer(this.shippingId,this.dewar.dewarId,a.containerType,a.capacity)}},ParcelPanel.prototype.showCaseForm=function(){var a=this,b=new CaseForm,c=Ext.create("Ext.window.Window",{title:"Parcel",height:450,width:600,modal:!0,layout:"fit",items:[b.getPanel(a.dewar)],buttons:[{text:"Save",handler:function(){a.onSavedClick.notify(b.getDewar()),c.close(),"content"==a.currentTab&&a.renderDewarParameters(a.dewar),a.renderDewarComments(a.dewar),a.panel.doLayout()}},{text:"Cancel",handler:function(){c.close()}}]});c.show()},ParcelPanel.prototype.showAddContainerForm=function(){var a=this,b=new AddContainerForm;b.onSave.attach(function(b,d){a.addContainerToDewar(d),c.close()}),b.onCancel.attach(function(a){c.close()});var c=Ext.create("Ext.window.Window",{title:"Container",height:450,width:600,modal:!0,layout:"fit",items:[b.getPanel(a.dewar)]});c.show()},ParcelPanel.prototype.getPanel=function(){return this.panel=Ext.create("Ext.panel.Panel",{cls:"border-grid-light",margin:10,height:this.height,width:this.width,autoScroll:!1,items:[{html:'<div id="'+this.id+'"></div>',autoScroll:!1,padding:this.padding,width:this.width}]}),this.panel},ProposalGrid.prototype.load=function(a){this.data=a,this.store.loadData(a,!1)},ProposalGrid.prototype.getFilter=function(a){return[{property:"Proposal_proposalNumber",value:a,anyMacth:!0}]},ProposalGrid.prototype.filter=function(a){},ProposalGrid.prototype._getTbar=function(){var a=this,b=[];return b.push({xtype:"textfield",name:"field1",emptyText:"search by number",hidden:this.isHidden,listeners:{change:function(b,c){var d=b.getValue();""!=d?a.store.filter(a.getFilter(b.getValue())):(a.store.clearFilter(!0),a.load(a.data))}}}),b},ProposalGrid.prototype.getPanel=function(){var a=this;return this.store=Ext.create("Ext.data.Store",{fields:["Proposal_proposalId","Proposal_title","Proposal_proposalCode","Proposal_proposalNumber","Proposal_proposalType"]}),this.store.sort(["Proposal_proposalCode","Proposal_proposalNumber"]),this.panel=Ext.create("Ext.grid.Panel",{title:"Proposals",store:this.store,tbar:this._getTbar(),layout:"fit",cls:"border-grid",height:this.height,margin:this.margin,emptyText:"No proposals",columns:[{text:"Proposal",dataIndex:"Proposal_code",width:125,renderer:function(a,b,c){return"<a href='#'>"+c.data.Proposal_proposalCode+c.data.Proposal_proposalNumber+"</a>"}},{text:"Code",dataIndex:"Proposal_number",width:75,hidden:!0},{text:"Number",dataIndex:"number",width:75,hidden:!0},{text:"Title",dataIndex:"Proposal_title",flex:1}],flex:1,viewConfig:{stripeRows:!0,listeners:{cellclick:function(b,c,d,e,f,g,h,i){a.onSelected.notify(e.data)}}}}),this.tbar&&this.panel.addDocked({xtype:"toolbar",cls:"toolBarGrid",height:48,items:this._getTbar()}),this.panel},PuckStatisticsContainer.prototype.getPanel=function(){var a=this;return this.panel=Ext.create("Ext.panel.Panel",{id:this.id+"-container",
x:this.templateData.xMargin,y:this.templateData.yMargin,width:this.templateData.width+1,height:this.templateData.height+1,cls:"border-grid",frame:!1,border:!1,bodyStyle:"background:transparent;",items:[{html:this.getHTML(),width:this.templateData.width+1,height:this.templateData.height+1}]}),this.panel.on("boxready",function(){a.templateData.enableMainClick&&$("#"+a.id).unbind("click").click(function(b){a.onClick.notify(b.target.id)}),a.setOnMouseOverEvent()}),this.panel},PuckStatisticsContainer.prototype.loadSamples=function(a){if(this.samples=a,a&&a.length>0){this.templateData.nSamples=a.length,this.templateData.nMeasured=a.length;var b=_.filter(a,{DataCollectionGroup_dataCollectionGroupId:null});b&&(this.templateData.nMeasured=a.length-b.length),$("#"+this.id+"-samples").html(this.templateData.nSamples),$("#"+this.id+"-measured").html(this.templateData.nMeasured)}},PuckStatisticsContainer.prototype.getHTML=function(a){var b="";return this.templateData.height<40?this.templateData.fillPanel=!1:this.templateData.fillPanel=!0,dust.render("puck.statistics.container.template",this.templateData,function(a,c){b=c}),b},PuckStatisticsContainer.prototype.setOnMouseOverEvent=function(){var a=this;$("#"+this.id).unbind("mouseover").mouseover(function(b){if(a.onMouseOver.notify(a),a.templateData.height<40){var c=b.currentTarget.id;$("#"+c).addClass("stock-solution-focus");var d="";dust.render("puck.statistics.tooltip.template",a.templateData,function(a,b){d=b}),$("body").append(d),$("#hoveringTooltipDiv-"+a.id).css({top:$(this).offset().top,left:$(this).offset().left+a.templateData.width})}}),$("#"+this.id).unbind("mouseout").mouseout(function(b){if(a.onMouseOut.notify(a),a.templateData.height<40){var c=b.currentTarget.id;$("#"+c).removeClass("stock-solution-focus"),$("#hoveringTooltipDiv-"+a.id).remove()}})},PuckStatisticsContainer.prototype.focus=function(a){a?$("#"+this.id+"-container").addClass("stock-solution-selected"):$("#"+this.id+"-container").removeClass("stock-solution-selected")},SessionGrid.prototype.load=function(a){this.sessions=_.filter(a,function(a){return _.includes(EXI.credentialManager.getBeamlineNames(),a.beamLineName)}),this.store.loadData(this.sessions,!1)},SessionGrid.prototype.filterByBeamline=function(a){if(console.log(a),a)if(a.length>0){for(var b=[],c=0;c<a.length;c++)b=_.concat(b,_.filter(this.sessions,{beamLineName:a[c]}));this.store.loadData(b,!1)}else this.store.loadData(this.sessions,!1)},SessionGrid.prototype.getToolbar=function(a){for(var b=this,c=[],d=function(a,c,d){c?b.beamlineFilter.push(a.boxLabel):b.beamlineFilter=_.remove(b.beamlineFilter,function(b){return b!=a.boxLabel}),b.filterByBeamline(b.beamlineFilter)},e=0;e<EXI.credentialManager.getBeamlines().length;e++)c.push({xtype:"checkbox",boxLabel:EXI.credentialManager.getBeamlines()[e].name,name:EXI.credentialManager.getBeamlines()[e].name,handler:d});return Ext.create("Ext.toolbar.Toolbar",{items:c})},SessionGrid.prototype.getPanel=function(){var a=this;return this.store=Ext.create("Ext.data.Store",{fields:["Proposal_ProposalNumber","beamLineName","beamLineOperator","Proposal_title","Person_emailAddress","Person_familyName","Person_givenName","nbShifts","comments"],emptyText:"No sessions",data:[]}),this.panel=Ext.create("Ext.grid.Panel",{title:this.title,store:this.store,tbar:this.getToolbar(),icon:"../images/icon/sessions.png",cls:"border-grid",minHeight:300,width:this.width,height:this.height,margin:this.margin,layout:this.layout,columns:[{text:"",dataIndex:"BLSession_startDate",flex:1,hidden:!0,renderer:function(a,b,c){var d="";return c.data.BLSession_startDate&&(c.data.start=moment(c.data.BLSession_startDate,"MMMM Do YYYY, h:mm:ss a").format("MMMM Do YYYY"),c.data.day=moment(c.data.BLSession_startDate,"MMMM Do YYYY, h:mm:ss a").format("Do"),c.data.month=moment(c.data.BLSession_startDate,"MMMM Do YYYY, h:mm:ss a").format("MMMM"),c.data.year=moment(c.data.BLSession_startDate,"MMMM Do YYYY, h:mm:ss a").format("YYYY")),dust.render("session.grid",c.data,function(a,b){d+=b}),d}},{text:"Start",dataIndex:"BLSession_startDate",flex:2,hidden:!1,renderer:function(a,b,c){var d="#";return d="SAXS"==EXI.credentialManager.getTechniqueByBeamline(c.data.beamLineName)?"#/session/nav/"+c.data.sessionId+"/session":"#/mx/datacollection/session/"+c.data.sessionId+"/main",c.data.BLSession_startDate?"<a href='"+d+"'>"+moment(c.data.BLSession_startDate,"MMMM Do YYYY, h:mm:ss a").format("MMMM Do YYYY")+"</a>":void 0}},{text:"Beamline",dataIndex:"beamLineName",width:125,hidden:!1,renderer:function(a,b,c){var d="#";return d="SAXS"==EXI.credentialManager.getTechniqueByBeamline(c.data.beamLineName)?"#/session/nav/"+c.data.sessionId+"/session":"#/mx/datacollection/session/"+c.data.sessionId+"/main","<a href='"+d+"'>"+c.data.beamLineName+"</a>"}},{text:"Proposal",dataIndex:"Proposal_ProposalNumber",flex:1,hidden:!1,renderer:function(a,b,c){var d=c.data.Proposal_proposalCode+c.data.Proposal_ProposalNumber;return"<a href='#/session/nav' data-toggle='tooltip' title='Open proposal "+d+"'>"+d+"</a>"}},{text:"Shifts",dataIndex:"nbShifts",hidden:this.isHiddenNumberOfShifts,flex:1},{text:"Local Contact",dataIndex:"beamLineOperator",width:200,hidden:this.isHiddenLocalContact,flex:1},{text:"Title",dataIndex:"Proposal_title",width:200,hidden:this.isHiddenTitle,flex:4},{text:"PI",dataIndex:"Proposal_title",width:200,hidden:this.isHiddenPI,renderer:function(a,b,c){return c.data.Person_familyName+", "+c.data.Person_givenName}},{text:"e-mail",dataIndex:"Person_emailAddress",width:200,hidden:!0,flex:1},{text:"Data Collections",dataIndex:"Person_emailAddress",width:200,renderer:function(a,b,c){function d(a,b){return b&&0!=b?'<tr><td><span style="margin-left:10px;margin-top:2px;background-color:#207a7a;" class="badge">'+b+'</span></td><td style="padding-left:10px;">'+a+"</td></tr>":""}function e(a){var b="<table>";return b=b+=d("Energy",a.data.energyScanCount),b+=d("XRF",a.data.xrfSpectrumCount),b+=d("Samples",a.data.sampleCount),b+=d("Test",a.data.testDataCollectionGroupCount),b+=d("Collects",a.data.dataCollectionGroupCount),b+=d("Calibration",a.data.calibrationCount),b+=d("Sample Changer",a.data.sampleChangerCount),b+=d("HPLC",a.data.hplcCount),b+"</table>"}return e(c)}},{text:"End",dataIndex:"BLSession_endDate",hidden:!0,flex:1,renderer:function(a,b,c){return c.data.BLSession_endDate}},{text:"Comments",dataIndex:"comments",hidden:!1,flex:3,renderer:function(a,b,c){return c.data.comments?"<div style='width:50px; wordWrap: break-word;'>"+c.data.comments+"</div>":void 0}}],viewConfig:{stripeRows:!0,getRowClass:function(a,b,c,d){}},listeners:{cellclick:function(b,c,d,e,f,g,h,i){a.onSelected.notify({proposalCode:e.data.Proposal_proposalCode,proposalNumber:e.data.Proposal_ProposalNumber})}}}),this.panel},StockSolutionContainer.prototype.getPanel=function(){var a=this;return this.panel=Ext.create("Ext.panel.Panel",{id:this.id+"-container",x:this.templateData.xMargin,y:this.templateData.yMargin,width:this.templateData.width+1,height:this.templateData.height+1,cls:"border-grid",frame:!1,border:!1,bodyStyle:"background:transparent;",items:[{html:this.getHTML(),width:this.templateData.width+1,height:this.templateData.height+1}]}),this.panel.on("boxready",function(){a.templateData.enableMainClick&&$("#"+a.id).unbind("click").click(function(b){a.onClick.notify(b.target.id)}),a.setOnMouseOverEvent()}),this.panel},StockSolutionContainer.prototype.loadSamples=function(a){this.samples=a,a&&a.length>0&&(this.containerId=a[0].Container_containerId)},StockSolutionContainer.prototype.getHTML=function(a){var b="";return this.templateData.height<40?this.templateData.fillPanel=!1:this.templateData.fillPanel=!0,dust.render("stock.solution.container.template",this.templateData,function(a,c){b=c}),b},StockSolutionContainer.prototype.setOnMouseOverEvent=function(){var a=this;$("#"+this.id).unbind("mouseover").mouseover(function(b){if(a.onMouseOver.notify(a),a.templateData.height<40){var c=b.currentTarget.id;$("#"+c).addClass("stock-solution-focus");var d="";dust.render("stock.solution.tooltip.template",a.templateData,function(a,b){d=b}),$("body").append(d),$("#hoveringTooltipDiv-"+a.stockSolutionId).css({top:$(this).offset().top,left:$(this).offset().left+a.templateData.width})}}),$("#"+this.id).unbind("mouseout").mouseout(function(b){if(a.onMouseOut.notify(a),a.templateData.height<40){var c=b.currentTarget.id;$("#"+c).removeClass("stock-solution-focus"),$("#hoveringTooltipDiv-"+a.stockSolutionId).remove()}})},StockSolutionContainer.prototype.focus=function(a){a?$("#"+this.id+"-container").addClass("stock-solution-selected"):$("#"+this.id+"-container").removeClass("stock-solution-selected")},StockSolutionsGrid.prototype.getPanel=function(){var a=this;return this.store=Ext.create("Ext.data.Store",{storeId:"stockSolutionsGridStore",fields:["acronym","buffer","concentration","volume"],data:[]}),this.panel=Ext.create("Ext.grid.Panel",{width:this.width,border:1,store:this.store,disableSelection:!1,flex:.5,columns:[{header:"Acronym",dataIndex:"acronym",type:"text",flex:1,readOnly:!0},{header:"Buffer",dataIndex:"buffer",type:"text",flex:1,readOnly:!0},{header:"Concentration (mg/ml)",dataIndex:"concentration",type:"text",flex:1,readOnly:!0},{header:"Volume (&#956l)",dataIndex:"volume",type:"text",flex:1,readOnly:!0}],listeners:{itemclick:function(b,c,d,e,f){a.onSelected.notify(c)}}}),this.panel},StockSolutionsGrid.prototype.load=function(a){this.stockSolutions=a;for(var b=[],c=0;c<a.length;c++)b.push({acronym:EXI.proposalManager.getMacromoleculeById(a[c].macromoleculeId).acronym,buffer:EXI.proposalManager.getBufferById(a[c].bufferId).acronym,concentration:a[c].concentration,volume:a[c].volume,stockSolutionId:a[c].stockSolutionId});this.store.loadData(b)},UploaderWidget.prototype.getFileName=function(){var a=Ext.getCmp(this.id).value;return a.split("\\")[a.split("\\").length-1]},UploaderWidget.prototype.getForm=function(){var a=this;return Ext.create("Ext.form.Panel",{layout:{type:"hbox",align:"stretch"},bodyPadding:20,border:0,frame:!0,items:[{xtype:"filefield",name:"file",width:400,id:this.id,fieldLabel:"File",labelWidth:30,msgTarget:"side",allowBlank:!1,buttonText:"Browse..."},{xtype:"button",margin:"0 0 0 2",text:"Upload",handler:function(){var b=this.up("form").getForm();b.isValid()&&b.submit({url:a.url,waitMsg:"Uploading your file...",success:function(b,c){a.window.close(),a.onUploaded.notify()},failure:function(b,c){a.window.close(),a.onUploaded.notify()}})}}]})},UploaderWidget.prototype.show=function(){this.window=Ext.create("Ext.window.Window",{title:"ISPyB File Uploader Manager",height:200,modal:!0,icon:"../images/icon/upload.svg",width:600,layout:"fit",items:this.getForm()}),this.window.show()},AutoprocIntegrationController.prototype.setPageBackground=ExiGenericController.prototype.setPageBackground,AutoprocIntegrationController.prototype.notFound=ExiGenericController.prototype.notFound,AutoprocIntegrationController.prototype.openFiles=function(a){var b=new AutoProcessingFileManager;b.show(),b.load(a)},AutoprocIntegrationController.prototype.init=function(){var a=this;Path.map("#/autoprocintegration/datacollection/:datacollectionId/main").to(function(){var a=new AutoProcIntegrationMainView;EXI.addMainPanel(a),a.panel.setLoading(!0);var b=new AutoProcIntegrationListView;EXI.addNavigationPanel(b),b.onSelect.attach(function(b,c){a.load(c)});var c=function(c,d){a.load(d[0]),console.log(d[0]),a.panel.setLoading(!1),b.load(d[0])};EXI.getDataAdapter({onSuccess:c}).mx.autoproc.getViewByDataCollectionId(this.params.datacollectionId)}).enter(this.setPageBackground),Path.map("#/autoprocintegration/datacollection/:datacollectionId/files").to(function(){a.openFiles(this.params.datacollectionId)}).enter(this.setPageBackground),Path.map("#/autoprocintegration/datacollection/:datacollectionId/phasingviewer/main").to(function(){var a=new PhasingViewerMainView;EXI.addMainPanel(a),a.load(this.params.datacollectionId)}).enter(this.setPageBackground)},BeamlineParameterController.prototype.setPageBackground=ExiGenericController.prototype.setPageBackground,BeamlineParameterController.prototype.notFound=ExiGenericController.prototype.notFound,BeamlineParameterController.prototype.init=function(){Path.map("#/mx/beamlineparameter/datacollection/:dataCollectionId/main").to(function(){var a=new BeamlineParameterMainView;EXI.addMainPanel(a),a.load(this.params.dataCollectionId)}).enter(this.setPageBackground)},CrystalController.prototype.setPageBackground=ExiGenericController.prototype.setPageBackground,CrystalController.prototype.notFound=ExiGenericController.prototype.notFound,CrystalController.prototype.init=function(){var a;Path.map("#/crystal/nav").to(function(){EXI.clearNavigationPanel(),EXI.setLoadingNavigationPanel(!0),a=new CrystalListView,a.onSelect.attach(function(a,b){location.hash="/mx/crystal/"+b[0].crystalId+"/main"}),EXI.addNavigationPanel(a);var b=function(b,c){a.load(c),EXI.setLoadingNavigationPanel(!1)};EXI.getDataAdapter({onSuccess:b}).mx.crystal.getCrystalsByProposalId()}).enter(this.setPageBackground),Path.map("#/mx/crystal/:crystalId/main").to(function(){var a=new CrystalMainView;EXI.addMainPanel(a),EXI.setLoadingMainPanel(!0);var b=function(b,c){a.load(c),EXI.setLoadingMainPanel(!1)};EXI.getDataAdapter({onSuccess:b}).mx.crystal.getCrystalById(this.params.crystalId)}).enter(this.setPageBackground)},ImageController.prototype.setPageBackground=ExiGenericController.prototype.setPageBackground,ImageController.prototype.notFound=ExiGenericController.prototype.notFound,ImageController.prototype.init=function(){},MxDataCollectionController.prototype.setPageBackground=ExiGenericController.prototype.setPageBackground,MxDataCollectionController.prototype.notFound=ExiGenericController.prototype.notFound,MxDataCollectionController.prototype.init=function(){Path.map("#/mx/datacollection/protein_acronym/:acronmys/main").to(function(){var a=new DataCollectionMxMainView;EXI.addMainPanel(a),EXI.hideNavigationPanel();var b=function(b,c){a.loadCollections(c)};EXI.getDataAdapter({onSuccess:b}).mx.dataCollection.getByAcronymList(this.params.acronmys)}).enter(this.setPageBackground),Path.map("#/mx/datacollection/session/:sessionId/main").to(function(){var a=new DataCollectionMxMainView;EXI.addMainPanel(a),EXI.hideNavigationPanel(),EXI.setLoadingMainPanel(!0);var b=function(b,c){a.loadCollections(c),EXI.setLoadingMainPanel(!1)};EXI.getDataAdapter({onSuccess:b}).mx.dataCollection.getDataCollectionViewBySessionId(this.params.sessionId);var c=function(b,c){a.loadEnergyScans(c)};EXI.getDataAdapter({onSuccess:c}).mx.energyscan.getEnergyScanListBySessionId(this.params.sessionId);var d=function(b,c){a.loadFXEScans(c)};EXI.getDataAdapter({onSuccess:d}).mx.xfescan.getXFEScanListBySessionId(this.params.sessionId)}).enter(this.setPageBackground),Path.map("#/mx/datacollection/datacollectionid/:datacollectionid/main").to(function(){var a=new DataCollectionMxMainView;EXI.addMainPanel(a),EXI.hideNavigationPanel(),EXI.setLoadingMainPanel(!0);var b=function(b,c){a.loadCollections(c),EXI.setLoadingMainPanel(!1)};EXI.getDataAdapter({onSuccess:b}).mx.dataCollection.getByDataCollectionId(this.params.datacollectionid)}).enter(this.setPageBackground),Path.map("#/mx/datacollection/:dataCollectionId/image/:imageId/main").to(function(){var a=new ImageMainView;EXI.hideNavigationPanel(),EXI.addMainPanel(a),a.load(this.params.imageId,this.params.dataCollectionId)}).enter(this.setPageBackground)},MxPrepare.prototype.setPageBackground=ExiGenericController.prototype.setPageBackground,MxPrepare.prototype.notFound=ExiGenericController.prototype.notFound,MxPrepare.prototype.init=function(){Path.map("#/mx/prepare/main").to(function(){EXI.clearNavigationPanel();var a=new PrepareMainView({currentStep:1});EXI.addMainPanel(a),a.load()}).enter(this.setPageBackground),Path.map("#/mx/prepare/main/loadSampleChanger").to(function(){EXI.clearNavigationPanel();var a=new PrepareMainView({currentStep:2});EXI.addMainPanel(a),a.load()}).enter(this.setPageBackground),Path.map("#/mx/prepare/:dewarIds/main").to(function(){var a=new PrepareMainView,b=this.params.dewarIds.split(",");EXI.addMainPanel(a),EXI.setLoadingMainPanel();var c=function(c,d){for(var e=[],f=0;f<b.length;f++)e.push(_.find(d,{dewarId:Number(b[f])}));EXI.setLoadingMainPanel(!1),a.load(e),EXI.setLoadingNavigationPanel(!1)};EXI.getDataAdapter({onSuccess:c}).proposal.dewar.getDewarsByProposal()}).enter(this.setPageBackground)},PhasingController.prototype.setPageBackground=ExiGenericController.prototype.setPageBackground,PhasingController.prototype.notFound=ExiGenericController.prototype.notFound,PhasingController.prototype.getChilds=function(a,b){for(var c=_.filter(b,function(b){return b.previousPhasingStepId==a.phasingStepId}),d=0;d<c.length;d++)c[d].children=this.getChilds(c[d],b);return c},PhasingController.prototype.tableToTree=function(a,b){for(var c=_.filter(a,function(a){return null==a.previousPhasingStepId}),d=0;d<c.length;d++)c[d].children=this.getChilds(c[d],a);return b&&(c=_.filter(c,function(a){return a.phasingStepId==b})),c},PhasingController.prototype.init=function(){function a(a){var c=new PhasingListView;EXI.addNavigationPanel(c);var d=function(a,d){var e=b.tableToTree(_.flatten(d));EXI.setLoadingNavigationPanel(!1),c.load(e)};return EXI.getDataAdapter({onSuccess:d}).mx.phasing.getPhasingViewByAutoProcIntegrationId(a),c}var b=this;this.phasingSteps=[],Path.map("#/phasing/autoprocintegrationId/:autoprocintegrationId/main").to(function(){var c=this.params.autoprocintegrationId;EXI.clearNavigationPanel();var d=new PhasingViewerMainView,e=a(c);e.onSelect.attach(function(a,c){0==c.length?d.load(b.phasingSteps):d.load(b.phasingSteps,c[0].prepare.phasingStepId)}),EXI.addMainPanel(d),EXI.setLoadingMainPanel();var f=function(a,c){b.phasingSteps=_.flatten(c),EXI.setLoadingMainPanel(!1),d.load(b.phasingSteps)};EXI.getDataAdapter({onSuccess:f}).mx.phasing.getPhasingViewByAutoProcIntegrationId(c)}).enter(this.setPageBackground)},ProteinController.prototype.setPageBackground=ExiGenericController.prototype.setPageBackground,ProteinController.prototype.notFound=ExiGenericController.prototype.notFound,ProteinController.prototype.init=function(){var a;Path.map("#/protein/nav").to(function(){EXI.clearNavigationPanel(),EXI.setLoadingNavigationPanel(!0),a=new ProteinListView,a.onSelect.attach(function(a,b){}),EXI.addNavigationPanel(a);var b=function(b,c){console.log(c),a.load(c),EXI.setLoadingNavigationPanel(!1)};EXI.getDataAdapter({onSuccess:b}).mx.protein.getProteinByProposalId()}).enter(this.setPageBackground),Path.rescue(this.notFound)},PuckController.prototype.setPageBackground=ExiGenericController.prototype.setPageBackground,PuckController.prototype.notFound=ExiGenericController.prototype.notFound,PuckController.prototype.init=function(){var a;Path.map("#/puck/nav").to(function(){EXI.addMainPanel(new PuckWelcomeMainView),EXI.clearNavigationPanel(),EXI.setLoadingNavigationPanel(!0),a=new PuckListView,a.onSelect.attach(function(a,b){location.hash="/mx/puck/"+b[0].Container_containerId+"/main"}),EXI.addNavigationPanel(a);var b=function(b,c){a.load(c.slice(0,100)),EXI.setLoadingNavigationPanel(!1)};EXI.getDataAdapter({onSuccess:b}).proposal.proposal.getDewarByProposalId()}).enter(this.setPageBackground),Path.map("#/mx/puck/:containerId/main").to(function(){EXI.setLoadingMainPanel(!0);var a=function(a,b){try{var c=new PuckMainView;EXI.addMainPanel(c),c.load(b)}catch(d){EXI.setError(d.message)}EXI.setLoadingMainPanel(!1)};EXI.getDataAdapter({onSuccess:a}).proposal.shipping.getContainerById(this.params.containerId,this.params.containerId,this.params.containerId)}).enter(this.setPageBackground),Path.map("#/mx/puck/add").to(function(){var a=new PuckMainView;EXI.addMainPanel(a);var b={containerId:"",code:null,containerType:"Puck",capacity:16,beamlineLocation:null,sampleChangerLocation:null,containerStatus:null,timeStamp:"Jan 15, 2016 2:29:39 PM",sampleVOs:[]};a.load(b)}).enter(this.setPageBackground)},WorkflowController.prototype.setPageBackground=ExiGenericController.prototype.setPageBackground,WorkflowController.prototype.notFound=ExiGenericController.prototype.notFound,WorkflowController.prototype.init=function(){var a;Path.map("#/mx/workflow/step/:workflowStepIdList/main").to(function(){EXI.clearNavigationPanel(),EXI.setLoadingNavigationPanel(!0),a=new WorkflowStepListView,a.onSelect.attach(function(a,c){null!=c&&b.load(c[0])}),EXI.addNavigationPanel(a);var b=new WorkflowStepMainView;EXI.addMainPanel(b);var c=function(b,c){a.load(JSON.parse(c)),EXI.setLoadingNavigationPanel(!1)};EXI.getDataAdapter({onSuccess:c}).mx.workflowstep.getWorkflowstepByIdList(this.params.workflowStepIdList)}).enter(this.setPageBackground),Path.map("#/mx/workflow/steps/:workflowStepIdList/step/:workflowStepId/main").to(function(){var b=this.params.workflowStepId;EXI.clearNavigationPanel(),EXI.setLoadingNavigationPanel(!0),a=new WorkflowStepListView,a.onSelect.attach(function(a,b){null!=b&&c.load(b[0])}),EXI.addNavigationPanel(a);var c=new WorkflowStepMainView;EXI.addMainPanel(c);var d=function(d,e){a.load(JSON.parse(e)),EXI.setLoadingNavigationPanel(!1),c.load(_.find(JSON.parse(e),{workflowStepId:Number(b)}))};EXI.getDataAdapter({onSuccess:d}).mx.workflowstep.getWorkflowstepByIdList(this.params.workflowStepIdList)}).enter(this.setPageBackground)},XfeController.prototype.setPageBackground=ExiGenericController.prototype.setPageBackground,XfeController.prototype.notFound=ExiGenericController.prototype.notFound,XfeController.prototype.init=function(){Path.map("#/mx/xfe/:xfeFluorescenceSpectrumId/main").to(function(){var a=new XfeViewerMainView;EXI.addMainPanel(a),a.load(this.params.xfeFluorescenceSpectrumId)}).enter(this.setPageBackground)},ExiMX.prototype.loadSelected=Exi.prototype.loadSelected,ExiMX.prototype.addMainPanel=Exi.prototype.addMainPanel,ExiMX.prototype.getSelectedDataCollections=Exi.prototype.getSelectedDataCollections,ExiMX.prototype.addNavigationPanel=Exi.prototype.addNavigationPanel,ExiMX.prototype.clearNavigationPanel=Exi.prototype.clearNavigationPanel,ExiMX.prototype.clearMainPanel=Exi.prototype.clearMainPanel,ExiMX.prototype.setLoadingNavigationPanel=Exi.prototype.setLoadingNavigationPanel,ExiMX.prototype.setLoadingMainPanel=Exi.prototype.setLoadingMainPanel,ExiMX.prototype.setError=Exi.prototype.setError,ExiMX.prototype.setLoading=Exi.prototype.setLoading,ExiMX.prototype.show=Exi.prototype.show,ExiMX.prototype.setAnonymousMenu=Exi.prototype.setAnonymousMenu,ExiMX.prototype.setUserMenu=Exi.prototype.setUserMenu,ExiMX.prototype.setManagerMenu=Exi.prototype.setManagerMenu,ExiMX.prototype.manageMenu=Exi.prototype.manageMenu,ExiMX.prototype.appendDataAdapterParameters=Exi.prototype.appendDataAdapterParameters,ExiMX.prototype.hideNavigationPanel=Exi.prototype.hideNavigationPanel,ExiMX.prototype.showNavigationPanel=Exi.prototype.showNavigationPanel,ExiMX.prototype.showNavigationPanel=Exi.prototype.showNavigationPanel,ExiMX.prototype.addTimer=Exi.prototype.addTimer,ExiMX.prototype.clearTimers=Exi.prototype.clearTimers,ExiMX.prototype.addMainPanelWithTimer=Exi.prototype.addMainPanelWithTimer,ExiMX.prototype.addNavigationPanelWithTimer=Exi.prototype.addNavigationPanelWithTimer,ExiMX.prototype.getHeader=function(){var a="",b={version:ExtISPyB.version,release_date:ExtISPyB.release_date};return dust.render("mxheader",b,function(b,c){a=c}),a},ExiMX.prototype.getDataAdapter=function(a){return new MxDataAdapterFactory(this.appendDataAdapterParameters(a))},MXMainMenu.prototype.populateCredentialsMenu=MainMenu.prototype.populateCredentialsMenu,MXMainMenu.prototype.init=MainMenu.prototype.init,MXMainMenu.prototype.getPanel=MainMenu.prototype.getPanel,MXMainMenu.prototype._convertToHTMLWhiteSpan=MainMenu.prototype._convertToHTMLWhiteSpan,MXMainMenu.prototype.getAddCredentialMenu=MainMenu.prototype.getAddCredentialMenu,MXMainMenu.prototype.getLoginButton=MainMenu.prototype.getLoginButton,MXMainMenu.prototype.setText=MainMenu.prototype.setText,MXMainMenu.prototype.getHomeItem=MainMenu.prototype.getHomeItem,MXMainMenu.prototype.getHelpMenu=MainMenu.prototype.getHelpMenu,MXMainMenu.prototype.getShipmentItem=MainMenu.prototype.getShipmentItem,MXMainMenu.prototype.getMenuItems=function(){return[this.getHomeItem(),this.getShipmentItem(),{text:this._convertToHTMLWhiteSpan("Proteins and Crystals"),cls:"ExiSAXSMenuToolBar",disabled:!0,menu:this.getProteinCrystalsMenu()},{text:this._convertToHTMLWhiteSpan("Prepare Experiment"),cls:"ExiSAXSMenuToolBar",disabled:!1,handler:function(){location.hash="/mx/prepare/main"}},{text:this._convertToHTMLWhiteSpan("Data Explorer"),cls:"ExiSAXSMenuToolBar",menu:this.getDataExplorerMenu()},{text:this._convertToHTMLWhiteSpan("Offline Data Analysis"),cls:"ExiSAXSMenuToolBar",disabled:!0,menu:this.getOnlineDataAnalisysMenu()},{text:this._convertToHTMLWhiteSpan("Help"),cls:"ExiSAXSMenuToolBar",disabled:!0,menu:this.getHelpMenu()},"->",{xtype:"textfield",name:"field1",value:"",emptyText:"search by protein acronym",listeners:{specialkey:function(a,b){b.getKey()==b.ENTER&&(location.hash="/mx/datacollection/protein_acronym/"+a.getValue()+"/main")}}}]},MXMainMenu.prototype.getOnlineDataAnalisysMenu=function(){function a(a,b){"Dimple"==a.text&&(location.hash="/tool/dimple/main"),"Job list"==a.text&&(location.hash="/tool/list")}return Ext.create("Ext.menu.Menu",{items:[{text:"Dimple",checked:!1,group:"theme",handler:a},"-",{text:"Job list",checked:!1,group:"theme",handler:a}]})},MXMainMenu.prototype.getProteinCrystalsMenu=function(){function a(a,b){"My Crystals"==a.text&&(location.hash="/crystal/nav"),"My Proteins"==a.text&&(location.hash="/protein/nav"),"Puck"==a.text&&(location.hash="/puck/nav")}return Ext.create("Ext.menu.Menu",{items:[{text:"My Crystals",icon:"../images/icon/macromolecule.png",handler:a},{text:"My Proteins",icon:"../images/icon/testtube.png",handler:a},{text:"Puck",icon:"../images/icon/testtube.png",handler:a}]})},MXMainMenu.prototype.getDataExplorerMenu=function(){function a(a,b){"Calendar"==a.text&&(location.hash="/session/nav"),"Experiments"==a.text&&(location.hash="/experiment/nav")}return Ext.create("Ext.menu.Menu",{items:[{text:"Calendar",icon:"../images/icon/sessions.png",handler:a}]})},MXManagerMenu.prototype.populateCredentialsMenu=ManagerMenu.prototype.populateCredentialsMenu,MXManagerMenu.prototype.init=ManagerMenu.prototype.init,MXManagerMenu.prototype.getPanel=ManagerMenu.prototype.getPanel,MXManagerMenu.prototype._convertToHTMLWhiteSpan=ManagerMenu.prototype._convertToHTMLWhiteSpan,MXManagerMenu.prototype.getAddCredentialMenu=ManagerMenu.prototype.getAddCredentialMenu,MXManagerMenu.prototype.getLoginButton=ManagerMenu.prototype.getLoginButton,MXManagerMenu.prototype.setText=ManagerMenu.prototype.setText,MXManagerMenu.prototype.getHelpMenu=ManagerMenu.prototype.getHelpMenu,MXManagerMenu.prototype.getHomeItem=ManagerMenu.prototype.getHomeItem,MXManagerMenu.prototype.getShipmentItem=ManagerMenu.prototype.getShipmentItem,MXManagerMenu.prototype.getPreparationMenu=ManagerMenu.prototype.getPreparationMenu,MXManagerMenu.prototype.getDataReductionMenu=ManagerMenu.prototype.getDataReductionMenu,MXManagerMenu.prototype.getDataExplorerMenu=ManagerMenu.prototype.getDataExplorerMenu,MXManagerMenu.prototype.getOnlineDataAnalisysMenu=ManagerMenu.prototype.getOnlineDataAnalisysMenu,MXManagerMenu.prototype.getMenuItems=function(){return[this.getHomeItem(),this.getShipmentItem(),{text:this._convertToHTMLWhiteSpan("Prepare Experiment"),cls:"ExiSAXSMenuToolBar",disabled:!1,handler:function(){location.hash="/mx/prepare/main"}},{text:this._convertToHTMLWhiteSpan("Data Explorer"),cls:"ExiSAXSMenuToolBar",hidden:this.isHidden,menu:this.getDataExplorerMenu()},{text:this._convertToHTMLWhiteSpan("Manager"),cls:"ExiSAXSMenuToolBar",menu:this.getManagerMenu()},{text:this._convertToHTMLWhiteSpan("Help"),cls:"ExiSAXSMenuToolBar",menu:this.getHelpMenu()},"->",{xtype:"textfield",name:"field1",value:"",emptyText:"search by protein acronym",listeners:{specialkey:function(a,b){b.getKey()==b.ENTER&&(location.hash="/mx/datacollection/protein_acronym/"+a.getValue()+"/main")}}}]},MXManagerMenu.prototype.getManagerMenu=function(){function a(a,b){if("Autoproc Scaling Statistics"==a.text){var c=new ScatteringForm({width:650,height:560}),d=Ext.create("Ext.window.Window",{height:560,width:650,modal:!0,layout:"fit",items:[c.getPanel()],buttons:[{text:"Plot",handler:function(){c.plot()}},{text:"Cancel",handler:function(){d.close()}}]}).show(),e=["ISA","rPimWithinIPlusIMinus","anomalousMultiplicity","multiplicity","resolutionLimitLow","ccHalf","strategySubWedgeOrigId","completeness","rMerge","anomalous","meanIOverSigI","ccAno","autoProcScalingId","nTotalObservations","sigAno","rMeasWithinIPlusIMinus","anomalousCompleteness","resolutionLimitHigh","fractionalPartialBias","rMeasAllIPlusIMinus","nTotalUniqueObservations","rPimAllIPlusIMinus"],f={title:"AutoprocIntegrator",keys:e};c.load(f)}}return Ext.create("Ext.menu.Menu",{items:[{text:"Statistics",icon:"../images/icon/ic_insert_chart_black_36dp.png",menu:{items:[{text:"Autoproc Scaling Statistics",icon:"../images/icon/ic_insert_chart_black_36dp.png",handler:a,disabled:!1}]}}]})},AutoProcIntegrationListView.prototype.getPanel=ListView.prototype.getPanel,AutoProcIntegrationListView.prototype.load=ListView.prototype.load,AutoProcIntegrationListView.prototype.getFilter=ListView.prototype.getFilter,AutoProcIntegrationListView.prototype.getFields=ListView.prototype.getFields,AutoProcIntegrationListView.prototype.getColumns=ListView.prototype.getColumns,AutoProcIntegrationListView.prototype.getRow=function(a){var b="";return dust.render("autoprocintegration.listview",a.data,function(a,c){b=c}),b},CrystalListView.prototype.getPanel=ListView.prototype.getPanel,CrystalListView.prototype.load=ListView.prototype.load,CrystalListView.prototype.getFilter=ListView.prototype.getFilter,CrystalListView.prototype.getFields=ListView.prototype.getFields,CrystalListView.prototype.getColumns=ListView.prototype.getColumns,CrystalListView.prototype.getRow=function(a){var b="";return dust.render("crystal.listview",a.data,function(a,c){b=c}),b},DewarListView.prototype.getPanel=ListView.prototype.getPanel,DewarListView.prototype.load=ListView.prototype.load,DewarListView.prototype.getFields=ListView.prototype.getFields,DewarListView.prototype.getColumns=ListView.prototype.getColumns,DewarListView.prototype.getRow=function(a){var b="";return dust.render("dewarlistview",a.data,function(a,c){b=c}),b},PhasingListView.prototype.getPanel=ListView.prototype.getPanel,PhasingListView.prototype.load=ListView.prototype.load,PhasingListView.prototype.getFields=ListView.prototype.getFields,PhasingListView.prototype.getColumns=ListView.prototype.getColumns,PhasingListView.prototype.getFilter=ListView.prototype.getFilter,PhasingListView.prototype.getRow=function(a){var b="";return dust.render("phasinglistview",a.data,function(a,c){b=c}),b},PhasingListView.prototype.analysizeStep=function(a){return console.log(a),{type:a.phasingStepType}},PhasingListView.prototype.parsePrepareNode=function(a){return{type:"PREPARE",spaceGroupShortName:a.spaceGroupShortName,spaceGroup:a.spaceGroup,status:"Success",phasingStepId:a.phasingStepId}},PhasingListView.prototype.parseSubstructureNode=function(a){if(a&&a.children){var b="Failure";return a.children.length>0&&(b="Success"),0==a.children.length&&(b="Not found"),{type:"SUBS. DETERMINATION",spaceGroupShortName:a.spaceGroupShortName,spaceGroup:a.spaceGroup,runs:a.children.length,status:b}}},PhasingListView.prototype.getSubstructureStep=function(a){return a&&a.children?a.children:[]},PhasingListView.prototype.getPhasingSteps=function(a){var b=[];if(a)for(var c=this.getSubstructureStep(a),d=0;d<c.length;d++)b=_.concat(b,c[d].children);return b},PhasingListView.prototype.getModelSteps=function(a){for(var b=[],c=this.getPhasingSteps(a),d=0;d<c.length;d++)c[d].children&&(b=_.concat(b,c[d].children));return b},PhasingListView.prototype.decideGoodStatus=function(a,b){for(var c=!1,d=!1,e=0;e<a.length;e++)-1!=a[e].indexOf("CC of partial")&&Number(b[e])>24&&(c=!0),
-1!=a[e].indexOf("Pseudo_free_CC")&&Number(b[e])>65&&(d=!0);return d&&c?1:0},PhasingListView.prototype.analizePhasingNodes=function(a){for(var b={withStatistics:0,withoutStatistics:0,successCondition:0},c=0;c<a.length;c++)if(null!=a[c].statisticsValue){b.withStatistics=b.withStatistics+1;try{var d=a[c].statisticsValue.split(","),e=a[c].metric.split(",");b.successCondition=b.successCondition+this.decideGoodStatus(e,d)}catch(f){console.log(f)}}else b.withoutStatistics=b.withoutStatistics+1;return b},PhasingListView.prototype.parsePhasingNode=function(a){if(a&&a.children){var b=this.getPhasingSteps(a),c="Failure";return b.length>0&&(c="Success"),0==b.length&&(c="Not found"),{type:"PHASING",runs:b.length,status:c,stats:this.analizePhasingNodes(b)}}},PhasingListView.prototype.parseModelNode=function(a){var b=this.getModelSteps(a),c="Failure";return b.length>0&&(c="Success"),0==b.length&&(c="Not found"),{type:"MODEL BUILDING",runs:b.length,status:c}},PhasingListView.prototype.formatData=function(a){var b=[];if(a)for(var c=0;c<a.length;c++)b.push({prepare:this.parsePrepareNode(a[c]),substructure:this.parseSubstructureNode(a[c]),phasing:this.parsePhasingNode(a[c]),models:this.parseModelNode(a[c])});return b},ProteinListView.prototype.getPanel=ListView.prototype.getPanel,ProteinListView.prototype.load=ListView.prototype.load,ProteinListView.prototype.getRow=function(a){var b="<table class='listView'>";return b=b+"<tr><td>Acronym:</td><td style='color:#207a7a;font-weight:bold;'>"+a.data.acronym+"</td></tr>",b=b+"<tr><td>Name:</td><td>"+a.data.name+"</td></tr>",b+"</table>"},ProteinListView.prototype.getFilter=function(a){return[{property:"acronym",value:a,anyMacth:!0}]},ProteinListView.prototype.getColumns=function(){var a=this;return[{text:"Proteins",flex:1,dataIndex:"bufferId",renderer:function(b,c,d){return a.getRow(d)}}]},ProteinListView.prototype.getFields=function(){return["acronym","name"]},PuckListView.prototype.getPanel=ListView.prototype.getPanel,PuckListView.prototype.load=ListView.prototype.load,PuckListView.prototype.getFilter=ListView.prototype.getFilter,PuckListView.prototype.getFields=ListView.prototype.getFields,PuckListView.prototype.getColumns=ListView.prototype.getColumns,PuckListView.prototype.getRow=function(a){var b="";return dust.render("puck.listview",a.data,function(a,c){b=c}),b},WorkflowStepListView.prototype.getPanel=ListView.prototype.getPanel,WorkflowStepListView.prototype.load=ListView.prototype.load,WorkflowStepListView.prototype.getRow=function(a){var b="";return a.data.imageURL=EXI.getDataAdapter().mx.workflowstep.getImageByWorkflowStepId(a.data.workflowStepId),dust.render("workflowstepmain_steps",a.data,function(a,c){b=c}),b},WorkflowStepListView.prototype.getFilter=function(a){return[{property:"acronym",value:a,anyMacth:!0}]},WorkflowStepListView.prototype.getColumns=function(){var a=this;return[{text:"Workflows",flex:1,dataIndex:"bufferId",renderer:function(b,c,d){return a.getRow(d)}}]},WorkflowStepListView.prototype.getFields=function(){return["acronym","name"]},AutoprocessingRanker.prototype.rank=function(a,b){function c(a,c){var d=a[b].replace(/\s/g,""),e=c[b].replace(/\s/g,"");return _.indexOf(ExtISPyB.spaceGroups,d)==_.indexOf(ExtISPyB.spaceGroups,e)?parseFloat(a.innerShell.rMerge)-parseFloat(c.innerShell.rMerge):_.indexOf(ExtISPyB.spaceGroups,e)-_.indexOf(ExtISPyB.spaceGroups,d)}function d(a,b){return parseFloat(a.innerShell.rMerge)-parseFloat(b.innerShell.rMerge)}var e=_.filter(a,function(a){return!!(a.innerShell&&a.innerShell.rMerge&&Number(a.innerShell.rMerge)<=10&&Number(a.innerShell.rMerge)>0)}),f=_.filter(a,function(a){return!!(a.innerShell&&a.innerShell.rMerge&&(Number(a.innerShell.rMerge)>10||Number(a.innerShell.rMerge)<=0))});if(e.sort(c),f.sort(d),e[0]&&(e[0].label="BEST"),f)for(var g=0;g<f.length;g++)f[g].label="rMerge > 10";return _.concat(e,f)},AutoprocessingRanker.prototype.sortBySpaceGroup=function(a,b){try{for(var c=0;c<a.length;c++){var d=a[c][b].replace(/\s+/g,"");a[c].rank=_.indexOf(ExtISPyB.spaceGroups,d)}}catch(e){return a}return a},AutoprocessingRanker.prototype.sortByRMergeLower=function(a,b){try{for(var c=0;c<a.length;c++){var d=a[c][b].replace(/\s+/g,"");a[c].rank=_.indexOf(ExtISPyB.spaceGroups,d)}}catch(e){return a}return a},AutoProcIntegrationAttachmentGrid.prototype.load=function(a){a&&this.store.loadData(a,!1)},AutoProcIntegrationAttachmentGrid.prototype.getPanel=function(){return this.store=Ext.create("Ext.data.Store",{fields:[]}),this.panel=Ext.create("Ext.grid.Panel",{title:"Auto-Processing Files",store:this.store,cls:"border-grid",margin:5,overflow:"auto",height:500,columns:[{text:"fileName",dataIndex:"fileName",flex:1,renderer:function(a,b,c,d,e){var f=EXI.getDataAdapter().mx.autoproc.getDownloadAttachmentUrl(c.data.autoProcProgramAttachmentId);return'<a href="'+f+'">'+c.data.fileName+"</a>"}}],flex:1,viewConfig:{stripeRows:!0}}),this.panel},AutoProcIntegrationGrid.prototype.parseData=function(a){for(var b=0;b<a.length;b++)try{a[b].statistics=this.getStatistics(a[b]),a[b].collapsed=this.getCollapseStatistics(a[b]),a[b].phasing=this.getPhasing(a[b]),a[b].downloadFilesUrl=EXI.getDataAdapter().mx.autoproc.downloadAttachmentListByautoProcProgramsIdList(a[b].v_datacollection_summary_phasing_autoProcProgramId),console.log(a[b].downloadFilesUrl)}catch(c){console.log(c)}var d=_.filter(a,function(a){return a.v_datacollection_summary_phasing_anomalous}),e=_.filter(a,function(a){return 0==a.v_datacollection_summary_phasing_anomalous});return anomalousdata=(new AutoprocessingRanker).rank(d,"v_datacollection_summary_phasing_autoproc_space_group"),nonanomalousdata=(new AutoprocessingRanker).rank(e,"v_datacollection_summary_phasing_autoproc_space_group"),_.concat(nonanomalousdata,anomalousdata)},AutoProcIntegrationGrid.prototype.load=function(a){this.data=this.parseData(a),this.collapsed?this.loadCollapsed(this.data):this.store.loadData(this.data,!1)},AutoProcIntegrationGrid.prototype.loadCollapsed=function(a){this.store.loadData([{collapsed:!0,items:a}],!1)},AutoProcIntegrationGrid.prototype.selectRowByAutoProcIntegrationId=function(a){this.preventSelection=!0,this.panel.getSelectionModel().select(this.store.find("v_datacollection_summary_phasing_autoProcIntegrationId",a))},AutoProcIntegrationGrid.prototype.getPhasing=function(a){var b=[];if(a.spaceGroupShortName)for(var c=a.spaceGroupShortName.split(","),d=a.phasingStepType.split("PREPARE"),e=0;e<c.length;e++)b.push({spaceGroup:c[e],prepare:!0,sub:-1!=d[e+1].indexOf("SUBSTRUCTUREDETERMINATION"),phasing:-1!=d[e+1].indexOf("PHASING"),model:-1!=d[e+1].indexOf("MODEL"),autoProcIntegrationId:a.v_datacollection_summary_phasing_autoProcIntegrationId});return b},AutoProcIntegrationGrid.prototype.getCollapseStatistics=function(a){function b(a,b,c){if(a){var d=a.split(",");if(d[b]){if(c)try{return Number(d[b]).toFixed(c)}catch(e){return"NaN"}return d[b]}}return""}for(var c=a.scalingStatisticsType.split(","),d=0;d<c.length;d++)c[d]&&(a[c[d]]={type:c[d],resolutionLimitLow:b(a.resolutionLimitLow,d,1),resolutionLimitHigh:b(a.resolutionLimitHigh,d,1),multiplicity:b(a.multiplicity,d,1),meanIOverSigI:b(a.meanIOverSigI,d,1),completeness:b(a.completeness,d,1),rMerge:b(a.rMerge,d,1),ccHalf:b(a.ccHalf,d,1),rPimWithinIPlusIMinus:b(a.rPimWithinIPlusIMinus,d,1),rMeasAllIPlusIMinus:b(a.rMeasAllIPlusIMinus,d,1),ccAno:b(a.ccAno,d),sigAno:b(a.sigAno,d)});return a},AutoProcIntegrationGrid.prototype.getStatistics=function(a){function b(a,b,c){if(a){var d=a.split(",");if(d[b]){if(c)try{return Number(d[b]).toFixed(c)}catch(e){return"NaN"}return d[b]}}return""}for(var c=a.scalingStatisticsType.split(","),d=[],e=0;e<c.length;e++)d.push({type:c[e],resolutionLimitLow:b(a.resolutionLimitLow,e),resolutionLimitHigh:b(a.resolutionLimitHigh,e),multiplicity:b(a.multiplicity,e),meanIOverSigI:b(a.meanIOverSigI,e),completeness:b(a.completeness,e),rMerge:b(a.rMerge,e),ccHalf:b(a.ccHalf,e),rPimWithinIPlusIMinus:b(a.rPimWithinIPlusIMinus,e),rMeasAllIPlusIMinus:b(a.rMeasAllIPlusIMinus,e),ccAno:b(a.ccAno,e),sigAno:b(a.sigAno,e)});return d},AutoProcIntegrationGrid.prototype.getPanel=function(){var a=this;return this.store=Ext.create("Ext.data.Store",{fields:["autoProcId","refinedCellA","v_datacollection_summary_phasing_autoProcIntegrationId","autoProcIntegrationId","v_datacollection_summary_phasing_anomalous","v_datacollection_summary_phasing_processingPrograms","v_datacollection_summary_phasing_autoproc_space_group"]}),this.panel=Ext.create("Ext.grid.Panel",{store:this.store,margin:10,height:this.height,layout:"fit",columns:[{text:"autoProcIntegrationId",dataIndex:"processingPrograms",flex:1,hidden:!0,renderer:function(a,b,c){return c.data.v_datacollection_summary_phasing_autoProcIntegrationId}},{dataIndex:"dataCollectionGroup",name:"dataCollectionGroup",flex:1.5,hidden:!1,renderer:function(b,c,d){var e=d.data,f="";return a.collapsed?dust.render("collapsed.autoprocintegrationgrid.template",e.items,function(a,b){f+=b}):dust.render("autoprocintegrationgrid.template",e,function(a,b){f+=b}),f}}],flex:1,viewConfig:{preserveScrollOnRefresh:!0,stripeRows:!1}}),this.panel.on("boxready",function(){a.attachCallBackAfterRender()}),this.panel},AutoProcIntegrationGrid.prototype.attachCallBackAfterRender=function(){setTimeout(function(){$('a[data-toggle="tab"]').on("shown.bs.tab",function(a){var b=$(a.target).attr("href"),c=null;if(b.startsWith("#tab_files_")){var d=function(a,c){var d="";if(c){for(var e=0;e<c[0].length;e++){var f=c[0][e];f.url=EXI.getDataAdapter().mx.autoproc.getDownloadAttachmentUrl(c[0][e].autoProcProgramAttachmentId)}dust.render("files.autoprocintegrationgrid.template",c[0],function(a,b){d+=b}),$(b).html(d)}},e=function(a,c){$(b).html("Error retrieving data")};c=b.slice(11),EXI.getDataAdapter({onSuccess:d,onError:e}).mx.autoproc.getAttachmentListByautoProcProgramsIdList(c)}if(b.startsWith("#plots")){c=b.slice(6);var f=new AutoProcIntegrationCurvePlotter({height:250,title:"Rfactor vs Resolution",legend:"never",targetId:"rFactor_"+c+"_plot"});$("#rFactor_"+c).html(f.getHTML()),f.loadUrl(EXI.getDataAdapter().mx.autoproc.getXScaleRfactor(c));var g=new AutoProcIntegrationCurvePlotter({height:250,title:"Completeness vs Resolution",legend:"never",targetId:" completeness_"+c+"_plot"});$("#completeness_"+c).html(g.getHTML()),g.loadUrl(EXI.getDataAdapter().mx.autoproc.getXScaleCompleteness(c));var h=new AutoProcIntegrationCurvePlotter({height:250,title:"I/SigmaI vs Resolution",legend:"never",targetId:" sigmaI_"+c+"_plot"});$("#sigmaI_"+c).html(h.getHTML()),h.loadUrl(EXI.getDataAdapter().mx.autoproc.getXScaleISigma(c));var i=new AutoProcIntegrationCurvePlotter({height:250,title:"CC/2 vs Resolution",legend:"never",targetId:"cc2_"+c+"_plot"});$("#cc2_"+c).html(i.getHTML()),i.loadUrl(EXI.getDataAdapter().mx.autoproc.getXScaleCC2(c));var j=new AutoProcIntegrationCurvePlotter({height:250,title:"SigAno vs Resolution",legend:"never",targetId:"sigmaAnno_"+c+"_plot"});$("#sigmaAnno_"+c).html(j.getHTML()),j.loadUrl(EXI.getDataAdapter().mx.autoproc.getXScaleSigmaAno(c));var k=new AutoProcIntegrationCurvePlotter({height:250,title:"Anom Corr vs Resolution",legend:"never",targetId:"anno_"+c+"_plot"});$("#anno_"+c).html(k.getHTML()),k.loadUrl(EXI.getDataAdapter().mx.autoproc.getXScaleAnnoCorrection(c))}})},1e3)},AutoProcIntegrationMainView.prototype.getPanel=MainView.prototype.getPanel,AutoProcIntegrationMainView.prototype.getContainer=function(){var a=200,b=300;return this.panel=Ext.create("Ext.container.Container",{layout:{type:"fit"},items:[this.autoProcIntegrationGrid.getPanel(),{xtype:"container",layout:"hbox",margin:20,items:[{html:'<div id="rfactor">rfactor</div>',width:b,height:a},{html:'<div id="completeness">completeness</div>',width:b,height:a},{html:'<div id="sigmaI">sigmaI</div>',width:b,height:a}]},{xtype:"container",layout:"hbox",margin:20,items:[{html:'<div id="cc2">cc2</div>',width:b,height:a},{html:'<div id="sigmaAnno">sigmaAnno</div>',width:b,height:a},{html:'<div id="anno">anno</div>',width:b,height:a}]}]}),this.panel},AutoProcIntegrationMainView.prototype.load=function(a){this.panel.setTitle("Autoprocessing"),this.autoProcIntegrationGrid.load(a);for(var b=[],c=0;c<a.length;c++)a[c].v_datacollection_summary_phasing_autoProcProgramId&&b.push(a[c].v_datacollection_summary_phasing_autoProcProgramId);var d=new AutoProcIntegrationCurvePlotter({height:250,title:"Anom Corr vs Resolution",targetId:"anno"});$("#anno").html(d.getHTML()),d.loadUrl(EXI.getDataAdapter().mx.autoproc.getXScaleAnnoCorrection(b));var e=new AutoProcIntegrationCurvePlotter({height:250,title:"SigAno vs Resolution",targetId:"sigmaAnno"});$("#sigmaAnno"+b).html(e.getHTML()),e.loadUrl(EXI.getDataAdapter().mx.autoproc.getXScaleSigmaAno(b));var f=new AutoProcIntegrationCurvePlotter({height:250,title:"CC/2 vs Resolution",targetId:"cc2"});$("#cc2").html(f.getHTML()),f.loadUrl(EXI.getDataAdapter().mx.autoproc.getXScaleCC2(b));var g=new AutoProcIntegrationCurvePlotter({height:250,title:"Rfactor vs Resolution",targetId:"rfactor"});$("#rfactor").html(g.getHTML()),g.loadUrl(EXI.getDataAdapter().mx.autoproc.getXScaleRfactor(b));var h=new AutoProcIntegrationCurvePlotter({height:250,title:"Completeness vs Resolution",targetId:" completeness"});$("#completeness").html(h.getHTML()),h.loadUrl(EXI.getDataAdapter().mx.autoproc.getXScaleCompleteness(b));var i=new AutoProcIntegrationCurvePlotter({height:250,title:"I/SigmaI vs Resolution",targetId:" sigmaI"});$("#sigmaI").html(i.getHTML()),i.loadUrl(EXI.getDataAdapter().mx.autoproc.getXScaleISigma(b))},ImageMainView.prototype.getPanel=MainView.prototype.getPanel,ImageMainView.prototype.getContainer=function(){return Ext.createWidget("tabpanel",{plain:!0,margin:"10 30 10 10",items:[{tabConfig:{title:"2D"},items:[{xtype:"container",layout:"hbox",paddding:5,style:{borderColor:"gray",borderStyle:"solid",borderWidth:"1px","background-color":"white"},items:[this.imageViewer.getPanel(),{html:"<div id='"+this.id+"detector' ></div>",margin:"0 0 0 5",height:800}]}]}]})},ImageMainView.prototype.loadDetectorPanel=function(a,b){var c=this.makeHTMLTable("Detector",[["Model",b.Detector_detectorModel],["Manufacturer",b.Detector_detectorManufacturer],["Mode",b.Detector_detectorMode],["Pixel Size",a.pixelSize.x+" x "+a.pixelSize.y],["sensitive Area",a.sensitiveArea.x+" x "+a.sensitiveArea.y]],null,a.img),d=this.makeHTMLTable("Data Collection",[["Collected on",b.DataCollectionGroup_endTime],["Experiment Type",b.DataCollectionGroup_experimentType],["Centering",b.DataCollection_centeringMethod],["Exposure Timee",b.DataCollection_exposureTime],["Directory",b.DataCollection_imageDirectory],["BeamLine",b.BLSession_beamLineName],["Detector Distance",b.DataCollection_detectorDistance],["Flux",b.DataCollection_flux],["Resolution",b.DataCollection_resolution],["Transmission",b.DataCollection_transmission],["WaveLength",b.DataCollection_wavelength]]);return"<span style='color:orange;font-weight:bold;'>WARNING: If image is not displayed please, refresh the page (F5)</span><br />"+d+c},ImageMainView.prototype.makeHTMLTable=function(a,b,c,d){var e=800;null!=c&&null!=c["with"]&&(e=c["with"]);var f="<table>";if(null!=b)for(var g=0;g<b.length;g++){f+="<tr>";for(var h=0;h<b[g].length;h++){var i="key_subgrid";1==h&&(i="value_subgrid"),f=f+"<td class='"+i+"'>"+b[g][h]+"</td>",null!=d&&0==g&&h==b[g].length-1&&(f=f+'<td rowspan="'+b.length+'"><img src='+d+"/></td>")}f+="</tr>"}return f+="</table>",null!=a&&(f='<div  class="header-component-table" >'+a+'</div><div  style="margin:0px 0px 0px 0px !important;width:'+e+'px;">'+f+"</div>"),f},ImageMainView.prototype.load=function(a,b){var c=this;this.panel.setTitle("Image");var d=EXI.getDataAdapter().mx.dataCollection.getImageById(a),e=function(a,b){var e=(b[0],b[0].DataCollection_wavelength),f=b[0].DataCollection_detectorDistance,g=b[0].DataCollection_xBeam,h=b[0].DataCollection_yBeam;null!=ExtISPyB.detectors[b[0].detectorModel]?c.detectorResolution=ExtISPyB.detectors[b[0].detectorModel]:alert("Not detector loaded"),c.imageViewer.load(d,e,f,g,h,c.detectorResolution),document.getElementById(c.id+"detector").innerHTML=c.loadDetectorPanel(c.detectorResolution,b[0])};EXI.getDataAdapter({onSuccess:e}).mx.dataCollection.getByDataCollectionId(b)},CrystalMainView.prototype.getPanel=MainView.prototype.getPanel,CrystalMainView.prototype.getContainer=function(){return this.panel=Ext.createWidget("tabpanel",{plain:!0,margin:"10 30 10 10",items:[{tabConfig:{title:"Samples list"},items:[{xtype:"container",layout:"fit",style:{borderColor:"gray",borderStyle:"solid",borderWidth:"1px","background-color":"white"},items:[this.samplesGrid.getPanel()]}]},{tabConfig:{title:"Create a new CrystalForm"},items:[{xtype:"container",layout:"fit",style:{borderColor:"gray",borderStyle:"solid",borderWidth:"1px","background-color":"white"},items:[this.crystalForm.getPanel()]}]}]}),this.panel},CrystalMainView.prototype.load=function(a){this.panel.setTitle(a.proteinVO.acronym),this.crystalForm.load(a),this.samplesGrid.load(a)},AutoProcessingFileManager.prototype.show=function(a){var b=this;this.autoProcStore=Ext.create("Ext.data.Store",{fields:["v_datacollection_processingPrograms","v_datacollection_summary_phasing_autoproc_space_group","v_datacollection_summary_phasing_autoProcProgramId","text"]});var c=Ext.create("Ext.form.ComboBox",{fieldLabel:"Choose",store:this.autoProcStore,queryMode:"local",displayField:"v_datacollection_processingPrograms",height:25,valueField:"v_datacollection_summary_phasing_autoProcProgramId",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div style="font-size:12px;" class="x-boundlist-item">{v_datacollection_processingPrograms}<span style="color:gray;font-size:10px;font-weight:bold"> {v_datacollection_summary_phasing_autoproc_space_group}</span></div>',"</tpl>"),listeners:{scope:b,select:function(a,c,d){b.programId=c[0].data.v_datacollection_summary_phasing_autoProcProgramId,b.programId&&b.reloadData(b.programId,b.filtered)}}});Ext.create("Ext.window.Window",{height:600,title:"Autoprocessing Files Explorer",width:900,modal:!0,items:[{xtype:"container",layout:"hbox",margin:"10 5 10 5",items:[c,{xtype:"checkboxfield",boxLabel:"Filter by MTZ files",margin:"0 0 0 40",checked:!1,listeners:{scope:b,change:function(a,c,d){b.reloadData(b.programId,c)}}}]},this.autoProcIntegrationAttachmentGrid.getPanel()]}).show()},AutoProcessingFileManager.prototype.reloadData=function(a,b){this.programId=a,this.filtered=b;var c=_.flatten(this.attachments);this.programId&&(c=this.attachments[_.indexOf(this.autoProcProgramIds,this.programId)]),this.filtered&&(c=_.filter(c,function(a){return-1!=a.fileName.indexOf(".mtz")})),c||(c=[]),this.autoProcIntegrationAttachmentGrid.load(c)},AutoProcessingFileManager.prototype.load=function(a){var b=this,c=function(a,c){var d=function(a,c){c.length!=b.autoProcProgramIds.length&&(b.autoProcProgramIds=_.filter(b.autoProcProgramIds,function(a){return null!=a})),b.attachments=c,b.autoProcIntegrationAttachmentGrid.load(_.flatten(c)),b.autoProcIntegrationAttachmentGrid.panel.setLoading(!1)};return b.autoProcIntegrationAttachmentGrid.panel.setLoading("Retrieving files"),b.autoProcProgramIds=_.map(c[0],"v_datacollection_summary_phasing_autoProcProgramId"),b.autoProcStore.loadData(c[0]),b.autoProcProgramIds&&b.autoProcProgramIds.length>0?void EXI.getDataAdapter({onSuccess:d}).mx.autoproc.getAttachmentListByautoProcProgramsIdList(b.autoProcProgramIds):void b.autoProcIntegrationAttachmentGrid.panel.setLoading(!1)};this.autoProcIntegrationAttachmentGrid.panel.setLoading(),EXI.getDataAdapter({onSuccess:c}).mx.autoproc.getViewByDataCollectionId(a)},DataCollectionGrid.prototype.loadMagnifiers=function(a){for(var b=0;b<a.length;b++){var c=a[b].DataCollection_dataCollectionId+"_thumb";$("#"+c).Lazy()}},DataCollectionGrid.prototype.load=function(a){try{this.store.loadData(a),this.loadMagnifiers(a)}catch(b){console.log(b)}},DataCollectionGrid.prototype.getPanel=function(a){return this.panel=Ext.create("Ext.grid.Panel",{border:1,store:this.store,disableSelection:!0,columns:this.getColumns(),viewConfig:{enableTextSelection:!0,stripeRows:!1}}),this.panel},DataCollectionGrid.prototype._getAutoprocessingStatistics=function(a){function b(a){return _.map(_.trim(a).split(","),function(a){return _.trim(a)})}var c=b(a.AutoProc_spaceGroups),d=b(a.autoProcIds),e=b(a.completenessList),f=b(a.resolutionsLimitHigh),g=b(a.resolutionsLimitLow),h=b(a.scalingStatisticsTypes),i=b(a.rMerges),j=b(a.Autoprocessing_cell_a),k=b(a.Autoprocessing_cell_b),l=b(a.Autoprocessing_cell_c),m=b(a.Autoprocessing_cell_alpha),n=b(a.Autoprocessing_cell_beta),o=b(a.Autoprocessing_cell_gamma),p=b(a.Autoprocessing_anomalous);if(a={},d&&""==d[0])return[];for(var q=0;q<d.length;q++)null==a[d[q]]&&(a[d[q]]={autoProcId:d[q],spaceGroup:c[q],anomalous:p[q]}),a[d[q]][h[q]]={autoProcId:d[q],scalingStatisticsType:h[q],completeness:Number(e[q]).toFixed(0),resolutionsLimitHigh:Number(f[q]).toFixed(1),resolutionsLimitLow:Number(g[q]).toFixed(1),rMerge:Number(i[q]).toFixed(1),spaceGroup:c[q],cell_a:j[q],cell_b:k[q],cell_c:l[q],cell_alpha:m[q],cell_beta:n[q],cell_gamma:o[q],anomalous:p[q]};var r=_.map(a,"autoProcId"),s=[];for(q=0;q<r.length;q++)s.push(a[r[q]]);return(new AutoprocessingRanker).rank(_.filter(s,{anomalous:"0"}),"spaceGroup")},DataCollectionGrid.prototype.getColumns=function(){var a=this,b=[{dataIndex:"dataCollectionGroup",name:"dataCollectionGroup",flex:1.5,hidden:!1,renderer:function(b,c,d){var e=d.data,f="";e.urlThumbnail=EXI.getDataAdapter().mx.dataCollection.getThumbNailById(e.lastImageId),e.url=EXI.getDataAdapter().mx.dataCollection.getImageById(e.lastImageId),e.ref="#/mx/beamlineparameter/datacollection/"+e.DataCollection_dataCollectionId+"/main",e.runNumber=e.DataCollection_dataCollectionNumber,e.prefix=e.DataCollection_imagePrefix,e.comments=e.DataCollectionGroup_comments,e.sample=e.BLSample_name,e.folder=e.DataCollection_imageDirectory;try{e.autoProcIntegrationId&&(e.resultsCount=_.uniq(e.autoProcIntegrationId.replace(/ /g,"").split(",")).length)}catch(c){}if(e.phasingStepType){var g=e.phasingStepType.split(",");e.phasingStepLength=g.length}return e.xtal1=EXI.getDataAdapter().mx.dataCollection.getCrystalSnapshotByDataCollectionId(d.data.DataCollection_dataCollectionId,1),e.xtal2=EXI.getDataAdapter().mx.dataCollection.getCrystalSnapshotByDataCollectionId(d.data.DataCollection_dataCollectionId,2),e.xtal3=EXI.getDataAdapter().mx.dataCollection.getCrystalSnapshotByDataCollectionId(d.data.DataCollection_dataCollectionId,3),e.xtal4=EXI.getDataAdapter().mx.dataCollection.getCrystalSnapshotByDataCollectionId(d.data.DataCollection_dataCollectionId,4),e.indicator=EXI.getDataAdapter().mx.dataCollection.getQualityIndicatorPlot(d.data.DataCollection_dataCollectionId),e.onlineresults=a._getAutoprocessingStatistics(d.data),e.isScreeningVisible=!0,e.onlineresults&&e.onlineresults.length>0&&(e.isScreeningVisible=!1),d.data.WorkflowStep_workflowStepType&&(e.workflows=(new WorkflowSectionDataCollection).parseWorkflow(d.data)),null==e.workflows&&(e.workflows=[]),dust.render(a.template,e,function(a,b){f+=b}),f}},{header:"IDs",dataIndex:"dataCollectionGroup",name:"dataCollectionGroup",flex:1.5,hidden:!0,renderer:function(a,b,c){var d="";return dust.render("ids.mxdatacollectiongrid.template",c.data,function(a,b){d=b}),d}}];return b},DataCollectionMxMainView.prototype.getPanel=MainView.prototype.getPanel,DataCollectionMxMainView.prototype.getContainer=function(){return this.container=Ext.create("Ext.tab.Panel",{minHeight:900,padding:"5 40 0 5",items:[{title:"Data Collections",cls:"border-grid",id:this.id+"_dataCollectionTab",items:[this.genericDataCollectionPanel.getPanel()]},{title:"Energy Scans",cls:"border-grid",id:this.id+"_energyTab",items:[this.energyScanGrid.getPanel()]},{title:"Fluorescence Spectra",id:this.id+"_xfeTab",cls:"border-grid",items:[this.xfeScanGrid.getPanel()]}]}),this.container},DataCollectionMxMainView.prototype.loadEnergyScans=function(a){return a&&a.length>0?(Ext.getCmp(this.id+"_energyTab").setTitle(a.length+" Energy Scans"),void this.energyScanGrid.load(a)):void Ext.getCmp(this.id+"_energyTab").setDisabled(!0)},DataCollectionMxMainView.prototype.loadFXEScans=function(a){return a&&a.length>0?(Ext.getCmp(this.id+"_xfeTab").setTitle(a.length+" Fluorescence Spectra"),void this.xfeScanGrid.load(a)):void Ext.getCmp(this.id+"_xfeTab").setDisabled(!0)},DataCollectionMxMainView.prototype.loadCollections=function(a){this.panel.setTitle("");var b=_.uniq(_.map(a,"BLSession_proposalId"));b&&1==b.length&&(proposal=EXI.proposalManager.getProposalById(b[0]),this.panel.setTitle(proposal.code+proposal.number));var c=_.filter(a,function(a){return null!=a.DataCollection_dataCollectionId});if(c){for(var d=0;d<c.length;d++)try{null!=c[d].DataCollectionGroup_startTime&&(c[d].time=moment(c[d].DataCollectionGroup_startTime,"MMMM Do YYYY, h:mm:ss A").format("h:mm:ss A")),null!=c[d].DataCollectionGroup_startTime&&(c[d].date=moment(c[d].DataCollectionGroup_startTime,"MMMM Do YYYY").format("MMMM Do YYYY")),null!=c[d].DataCollection_resolutionAtCorner&&(c[d].DataCollection_resolutionAtCorner=_.ceil(c[d].DataCollection_resolutionAtCorner,2)),null!=c[d].DataCollection_resolution&&(c[d].DataCollection_resolution=_.ceil(c[d].DataCollection_resolution,2)),null!=c[d].DataCollection_wavelength&&(c[d].DataCollection_wavelength=_.ceil(c[d].DataCollection_wavelength,3)),null!=c[d].DataCollection_axisEnd&&null!=c[d].DataCollection_axisStart&&(c[d].DataCollection_axisTotal=_.ceil(c[d].DataCollection_axisEnd-c[d].DataCollection_axisStart,2)),null!=c[d].DataCollection_flux_end&&(c[d].DataCollection_flux_end=c[d].DataCollection_flux_end.toExponential()),null!=c[d].DataCollection_flux&&(c[d].DataCollection_flux=c[d].DataCollection_flux.toExponential())}catch(e){console.log(error)}return Ext.getCmp(this.id+"_dataCollectionTab").setTitle(c.length+" Data Collections"),void(c&&this.genericDataCollectionPanel.load(c.reverse()))}Ext.getCmp(this.id+"_dataCollectionTab").setDisabled(!0)},CollapsedDataCollectionGrid.prototype._getAutoprocessingStatistics=DataCollectionGrid.prototype._getAutoprocessingStatistics,CollapsedDataCollectionGrid.prototype.getColumns=DataCollectionGrid.prototype.getColumns,CollapsedDataCollectionGrid.prototype.load=DataCollectionGrid.prototype.load,CollapsedDataCollectionGrid.prototype.loadMagnifiers=DataCollectionGrid.prototype.loadMagnifiers,CollapsedDataCollectionGrid.prototype.getPanel=DataCollectionGrid.prototype.getPanel,ContainersDataCollectionGrid.prototype.getPanel=function(a){return this.store=Ext.create("Ext.data.Store",{fields:["dataCollectionGroup"]}),this.panel=Ext.create("Ext.grid.Panel",{border:1,store:this.store,columns:this.getColumns(),disableSelection:!0,viewConfig:{trackOver:!1}}),this.container=Ext.create("Ext.panel.Panel",{items:[this.legend.getPanel(),this.panel]}),this.container},ContainersDataCollectionGrid.prototype.getColumns=function(){var a=this,b=[{dataIndex:"dataCollectionGroup",name:"dataCollectionGroup",flex:1.5,hidden:!1,renderer:function(b,c,d){var e=d.data,f=(e.containerIds.length,"");if(dust.render("containers.mxdatacollectiongrid.template",e,function(a,b){f+=b}),e.containerIds.length>0){for(var g=300,h={},i=$("<div ><div id='a' style='display: block;overflow-y: scroll;height:"+2*g+"px;'>"+f+"</div></div>"),j=0;j<e.containerIds.length;j++){var k=Number(e.containerIds[j]),l=_.filter(a.dataCollectionGroup,{Container_containerId:k});if(l){for(var m={},n=1;n<=l[0].Container_capacity;n++){var o=_.filter(l,{BLSample_location:n.toString()});if(o.length>0){var p=[];for(sample in o)p.push(o[sample].DataCollection_dataCollectionId);m[n]=p.toString()}}h[e.containerIds[j]]=m}}var q=function(a,b){if(b)for(var c=0;c<e.containerIds.length;c++){var d=Number(e.containerIds[c]),f=_.filter(b,{Container_containerId:d}),i={mainRadius:g/4,enableMouseOver:!0,enableClick:!0,containerId:d,initSelected:e.selected[d],dataCollectionIds:h[d]},j=_.map(f,"BLSample_location").map(function(a){return parseInt(a)}),k=_.max(j),l=new SpinePuckWidget(i);null!=k&&k>10&&(l=new UniPuckWidget(i)),$("#puck-panel-"+d).html(l.getPanel().html),cells=[];for(var m=0;m<f.length;m++){var n=f[m],o=!1;_.isEmpty(i.initSelected)||(o=i.initSelected.includes(n.BLSample_location));var p=l.dataCollectionIds[n.BLSample_location],q="FILLED";null!=p&&p.length>0&&(q="COLLECTED"),cells.push({location:n.BLSample_location,state:q,selected:o,sample_name:n.BLSample_name,protein_acronym:n.Protein_acronym,protein_name:n.Protein_name,containerId:n.Container_containerId,container_code:n.Container_code,dewarId:n.Dewar_dewarId,dataCollectionIds:p}),l.load(cells);var r="";dust.render("containers.info.mxdatacollectiongrid.template",cells[0],function(a,b){r+=b}),$("#puck-panel-"+d+"-info").html(r)}}};f=i.html(),EXI.getDataAdapter({onSuccess:q}).mx.sample.getSamplesByContainerId(e.containerIds)}return f}},{header:"IDs",dataIndex:"dataCollectionGroup",name:"dataCollectionGroup",flex:1.5,hidden:!0,renderer:function(a,b,c){var d="";return dust.render("ids.mxdatacollectiongrid.template",c.data,function(a,b){d=b}),d}}];return b},ContainersDataCollectionGrid.prototype.select=function(a){var b={};for(sample in a)null==b[a[sample].Container_containerId]?b[a[sample].Container_containerId]=[a[sample].BLSample_location]:b[a[sample].Container_containerId].push(a[sample].BLSample_location);this.store.loadData([{containerIds:this.getContainersId(this.dataCollectionGroup),selected:b}])},ContainersDataCollectionGrid.prototype.getContainersId=function(a){return _.filter(Object.keys(_.keyBy(a,"Container_containerId")),function(a){return isNumber(a)})},ContainersDataCollectionGrid.prototype.load=function(a){this.dataCollectionGroup=a,this.store.loadData([{containerIds:this.getContainersId(this.dataCollectionGroup),selected:{}}])},CustomSectionDataCollection.prototype.getMeshScan=function(a){var b=[],c=[],d=[];if(null!=a.WorkflowStep_workflowStepType){b=a.WorkflowStep_workflowStepType.split(","),c=a.WorkflowStep_status.split(","),d=a.WorkflowStep_workflowStepId.split(",");for(var e=0;e<b.length;e++){var f={status:c[e],name:b[e],workflowStepId:d[e],img:EXI.getDataAdapter().mx.workflowstep.getImageByWorkflowStepId(d[e])};if("Mesh"==f.name)return f}}},CustomSectionDataCollection.prototype.getHTML=function(a){var b="",c=[];try{var d=this.getMeshScan(a);null!=d&&c.push({img:EXI.getDataAdapter().mx.workflowstep.getImageByWorkflowStepId(d.workflowStepId),id:a.DataCollection_dataCollectionId})}catch(e){b+="There was an error parsing the mesh"}try{null!=a.DataCollection_bestWilsonPlotPath&&c.push({img:EXI.getDataAdapter().mx.dataCollection.getWilsonPlot(a.DataCollection_dataCollectionId)})}catch(e){b+="There was an error parsing the wilson"}return dust.render("customsectiondatacollection",c,function(a,c){b+=c}),b},MXDataCollectionGrid.prototype.getPanel=function(a){var b=this;return this.panel=Ext.create("Ext.panel.Panel",{id:this.id,minHeight:900,tbar:this.getToolBar(),items:[b.activePanel.getPanel(a)]}),this.panel},MXDataCollectionGrid.prototype.getToolBar=function(){function a(a){b.activePanel!=a&&(b.activePanel=a,""!=Ext.getCmp(b.id+"_search").getValue()?b.reloadData(b.filterBy(Ext.getCmp(b.id+"_search").getValue())):b.reloadData(b.dataCollectionGroup))}var b=this,c=Ext.create("Ext.menu.Menu",{items:[{text:"Session summary",handler:function(){b.renderingType="DATACOLLECTION",a(b.uncollapsedDataCollectionGrid)}},{text:"Data collections summary",handler:function(){b.renderingType="DATACOLLECTION_COLLAPSED",a(b.collapsedDataCollectionGrid)}},{text:"Containers",handler:function(){b.renderingType="CONTAINERS",b.activePanel!=b.containersDataCollectionGrid&&(b.activePanel=b.containersDataCollectionGrid,b.reloadData(b.dataCollectionGroup),""!=Ext.getCmp(b.id+"_search").getValue()&&b.containersDataCollectionGrid.select(b.filterBy(Ext.getCmp(b.id+"_search").getValue())))}}]});return Ext.create("Ext.toolbar.Toolbar",{width:500,items:[{text:"View",iconCls:"bmenu",menu:c},"->",{xtype:"textfield",id:this.id+"_search",width:400,emptyText:"enter search prefix, sample or protein",
listeners:{specialkey:function(a,c){c.getKey()==c.ENTER&&(b.filter=a.getValue(),"CONTAINERS"==b.renderingType?""!=Ext.getCmp(b.id+"_search").getValue()?b.containersDataCollectionGrid.select(b.filterBy(Ext.getCmp(b.id+"_search").getValue())):(Ext.getCmp(b.id+"_found").setText(""),b.reloadData(b.dataCollectionGroup)):b.reloadData(b.filterBy(a.getValue())))}}},{xtype:"tbtext",text:"",id:this.id+"_found"}]})},MXDataCollectionGrid.prototype.reloadData=function(a){this.panel.removeAll(),this.panel.add(this.activePanel.getPanel(this.dataCollectionGroup)),this.activePanel.load(a)},MXDataCollectionGrid.prototype.load=function(a){this.dataCollectionGroup=a,this.activePanel.load(this.dataCollectionGroup)},MXDataCollectionGrid.prototype.filterBy=function(a){var b=_.filter(this.dataCollectionGroup,function(b){for(var c=["DataCollection_imagePrefix","Protein_acronym","BLSample_name"],d=0;d<c.length;d++){var e=c[d];if(b[e]&&-1!=b[e].indexOf(a))return b}});return Ext.getCmp(this.id+"_found").setText(b.length+" items found"),b},OnlineResultSectionDataCollection.prototype.getScreeningData=function(a){var b=[];if(null!=a.Screening_screeningId&&(a.ScreeningOutput_indexingSuccess?b.push({name:"Indexing",status:"Success",datacollectionId:a.DataCollection_dataCollectionId,items:[{name:"Mosaicity",value:a.ScreeningOutput_mosaicity,units:""}]}):b.push({name:"Indexing",datacollectionId:a.DataCollection_dataCollectionId,status:"Failure",items:[]})),a.ScreeningOutput_strategySuccess){var c=[{name:"Ranking Res.",value:a.ScreeningOutput_rankingResolution,units:""}];a.ScreeningOutputLattice_spaceGroup&&(c.push({name:"Space Group",value:a.ScreeningOutputLattice_spaceGroup,units:""}),c.push({name:"a,b,c",value:a.ScreeningOutputLattice_unitCell_a+", "+a.ScreeningOutputLattice_unitCell_b+", "+a.ScreeningOutputLattice_unitCell_c,units:""}),c.push({name:"  ",value:a.ScreeningOutputLattice_unitCell_alpha+", "+a.ScreeningOutputLattice_unitCell_beta+", "+a.ScreeningOutputLattice_unitCell_gamma,units:""})),b.push({name:"Strategy",status:"Success",datacollectionId:a.DataCollection_dataCollectionId,items:c})}if(0==b.length)return{name:"Screening",status:"Not found",items:[]};for(var d="Failure",e=0;e<b.length;e++)"Success"==b[e].status&&(d="Success");return{name:"Screening",status:d,items:b}},OnlineResultSectionDataCollection.prototype.getAutoprocResults=function(a){var b=[],c=a.processingPrograms,d=a.processingStatus,e=a.AutoProc_spaceGroups;if(null!=c){c=c.split(","),d=d.split(","),e=e.split(",");for(var f={},g=0;g<c.length;g++){var h=c[g].trim();null==f[h]&&(f[h]={},f[h].spaceGroup=[],f[h].run=0,f[h].success=0),f[h].spaceGroup.push(e[g]),f[h].run=f[h].run+1,f[h].success=f[h].success+1}for(var i in f){var j="Failure";f[i].success>0&&(j="Success"),b.push({name:i,dataCollectionId:a.DataCollection_dataCollectionId,run:f[i].run,success:f[i].success,spaceGroup:f[i].spaceGroup,status:j,items:[]})}}return b.length>0?{name:"Autoprocessing",items:b,status:"Success",datacollectionId:a.DataCollection_dataCollectionId}:{name:"Autoprocessing",datacollectionId:a.DataCollection_dataCollectionId,status:"Not found",items:[]}},OnlineResultSectionDataCollection.prototype.getPhasingResults=function(a){return null!=a?null!=a.Phasing_phasingStepType?{name:"Phasing",datacollectionId:a.DataCollection_dataCollectionId,items:[{name:"Phasing",status:"Success",items:[]}]}:{name:"Phasing",datacollectionId:a.DataCollection_dataCollectionId,items:[{name:"No phasing",status:"Not found",items:[]}]}:void 0},OnlineResultSectionDataCollection.prototype.parseData=function(a){var b=[];return b.push(this.getAutoprocResults(a)),b.push(this.getScreeningData(a)),b},OnlineResultSectionDataCollection.prototype.getHTML=function(a,b){var c=this.parseData(a);c[0].autoProcResults=b;var d="";return dust.render("resultsection.autoprocessing",c,function(a,b){d=b}),d},OnlineResultSectionDataCollection.prototype.getPhasingHTML=function(a){var b="";if(null!=a){if(null!=a.Phasing_phasingStepType){for(var c=a.Phasing_phasingStepType.split(","),d=[],e=0;e<c.length;e++)d.push({iconClass:"summary_datacollection_success",value:c[e]});b+=this.getIconTable(d)}else b+=this.getIconTable([{iconClass:"summary_datacollection_noFound",value:"Phasing"}]);null!=a.Phasing_spaceGroup&&(b+=this.getHTMLTable([{key:"Space Groups",value:a.Phasing_spaceGroup}]))}return b},ThumbnailSectionDatacollection.prototype.getHTML=function(a){var b="";return dust.render("thumbnailsection",[{urlThumbnail:EXI.getDataAdapter().mx.dataCollection.getThumbNailById(a.lastImageId),url:EXI.getDataAdapter().mx.dataCollection.getImageById(a.lastImageId),ref:"#/mx/beamlineparameter/datacollection/"+a.DataCollection_dataCollectionId+"/main",runNumber:a.DataCollection_dataCollectionNumber,prefix:a.DataCollection_imagePrefix,comments:a.DataCollectionGroup_comments,sample:a.BLSample_name,folder:a.DataCollection_imageDirectory}],function(a,c){b=c}),b},UncollapsedDataCollectionGrid.prototype._getAutoprocessingStatistics=DataCollectionGrid.prototype._getAutoprocessingStatistics,UncollapsedDataCollectionGrid.prototype.getColumns=DataCollectionGrid.prototype.getColumns,UncollapsedDataCollectionGrid.prototype.loadMagnifiers=DataCollectionGrid.prototype.loadMagnifiers,UncollapsedDataCollectionGrid.prototype.load=function(a){try{this.dataCollectionGroup=a,this.store.loadData(a),this.loadMagnifiers(a),this.attachCallBackAfterRender()}catch(b){console.log(b)}},UncollapsedDataCollectionGrid.prototype.getPanel=function(){return this.panel=Ext.create("Ext.grid.Panel",{border:1,store:this.store,id:this.id,minHeight:900,disableSelection:!0,columns:this.getColumns(),viewConfig:{enableTextSelection:!0,stripeRows:!1}}),this.panel},UncollapsedDataCollectionGrid.prototype.displayDataCollectionTab=function(a,b){var c=function(b,c){_.forEach(c,function(a){d=new Date(Date.parse(a.startTime)),hours=("0"+d.getHours()).slice(-2),minutes=("0"+d.getMinutes()).slice(-2),seconds=("0"+d.getSeconds()).slice(-2),a.formattedStartTime=hours+":"+minutes+":"+seconds,a.urlImageQualityIndicators=EXI.getDataAdapter().mx.dataCollection.getQualityIndicatorPlot(a.dataCollectionId),a.onlineresults=UncollapsedDataCollectionGrid.prototype._getAutoprocessingStatistics(a)});var e="";dust.render("datacollections.mxdatacollectiongrid.template",c,function(a,b){e+=b}),$(a).html(e)},e=function(b,c){$(a).html("Error retrieving data "+c)};EXI.getDataAdapter({onSuccess:c,onError:e}).mx.dataCollection.getDataCollectionsByDataCollectionGroupId(b)},UncollapsedDataCollectionGrid.prototype.displayResultAutoprocessingTab=function(a,b){var c=function(b,c){var d="";dust.render("collapsed.autoprocintegrationgrid.template",(new AutoProcIntegrationGrid).parseData(c[0]),function(a,b){d+=b}),$(a).html(d)};EXI.getDataAdapter({onSuccess:c}).mx.autoproc.getViewByDataCollectionId(b)},UncollapsedDataCollectionGrid.prototype.displayWorkflowsTab=function(a,b){var c=_.find(grid.dataCollectionGroup,{DataCollection_dataCollectionId:Number(b)});if(c){var d="",e=(new WorkflowSectionDataCollection).parseWorkflow(c);dust.render("workflows.mxdatacollectiongrid.template",e,function(a,b){d+=b}),$(a).html(d)}},UncollapsedDataCollectionGrid.prototype.displayPhasingTab=function(a,b){var c=function(b,c){function d(a){return _.keys(_.keyBy(a,"PhasingStep_phasingStepId")).toString()}function e(a){var b=_.keys(_.keyBy(a,"csv"));return _.filter(b,function(a){return"null"!=a})}function f(a){if(a.metric)for(var b=a.metric.split(","),c=a.statisticsValue.split(","),d=0;d<b.length;d++)a[b[d].replace(/ /g,"_")]=c[d];return a.png&&(a.pngURL=EXI.getDataAdapter().mx.phasing.getPhasingFilesByPhasingProgramAttachmentIdAsImage(a.png)),a.spaceGroup=a.SpaceGroup_spaceGroupShortName,a}function g(a,b,c){var d=_.filter(b,{PhasingStep_phasingStepType:c});if(a.metrics=[],d)for(var e=(_.map(d,"metric"),_.map(d,"statisticsValue"),0);e<d.length;e++){var g=d[e];d[e].metric&&(g=f(d[e]));var h=EXI.getDataAdapter().mx.phasing.downloadPhasingFilesByPhasingAttachmentId(d[e].pdb);if(null!=d[0].map){var i=d[e].map.split(",");if(2==i.length){var j=EXI.getDataAdapter().mx.phasing.downloadPhasingFilesByPhasingAttachmentId(i[0]),k=EXI.getDataAdapter().mx.phasing.downloadPhasingFilesByPhasingAttachmentId(i[1]);g.uglymol="../viewer/uglymol/index.html?pdb="+h+"&map1="+j+"&map2="+k}}g.downloadFilesUrl=a.downloadFilesUrl,a.metrics.push(g)}return a.phasingStepId=d[0].PhasingStep_phasingStepId,a}var h=_.keyBy(c[0],"SpaceGroup_spaceGroupShortName"),i=[];for(var j in h)if("null"!=j){var k=_.filter(c[0],{SpaceGroup_spaceGroupShortName:j}),l={};l={spaceGroup:j,prepare:null!=_.find(k,{PhasingStep_phasingStepType:"PREPARE"}),sub:null!=_.find(k,{PhasingStep_phasingStepType:"SUBSTRUCTUREDETERMINATION"}),phasing:null!=_.find(k,{PhasingStep_phasingStepType:"PHASING"}),model:null!=_.find(k,{PhasingStep_phasingStepType:"MODELBUILDING"}),downloadCSV:EXI.getDataAdapter().mx.phasing.getCSVPhasingFilesByPhasingAttachmentIdURL(e(k)),downloadFilesUrl:EXI.getDataAdapter().mx.phasing.getDownloadFilesByPhasingStepIdURL(d(k))},l=null!=_.find(k,{PhasingStep_phasingStepType:"MODELBUILDING"})?g(l,k,"MODELBUILDING"):null!=_.find(k,{PhasingStep_phasingStepType:"PHASING"})?g(l,k,"PHASING"):null!=_.find(k,{PhasingStep_phasingStepType:"SUBSTRUCTUREDETERMINATION"})?g(l,k,"SUBSTRUCTUREDETERMINATION"):g(l,k,"PREPARE");var m=0;l.prepare&&(m+=1),l.sub&&(m+=1),l.phasing&&(m+=1),l.model&&(m+=1),l.count=m,i.push(l)}i.sort(function(a,b){return a.count<b.count});for(var n=0;n<i.length;n++)i[n]&&i[n].metrics&&i[n].metrics.sort(function(a,b){try{return parseFloat(a._CC_of_partial_model)<parseFloat(b._CC_of_partial_model)}catch(c){return!1}});var o="";dust.render("phasing.mxdatacollectiongrid.template",i,function(a,b){o+=b}),$(a).html(o)};EXI.getDataAdapter({onSuccess:c}).mx.phasing.getPhasingViewByDataCollectionGroupId(b)},UncollapsedDataCollectionGrid.prototype.displaySampleTab=function(a,b){var c=_.find(grid.dataCollectionGroup,{DataCollection_dataCollectionId:Number(b)});if(c&&$("#sample_puck_layout_"+b)&&c.Container_containerId){var d=_.filter(grid.dataCollectionGroup,{Container_containerId:Number(c.Container_containerId)});if(d)for(var e={},f=1;f<=d[0].Container_capacity;f++){var g=_.filter(d,{BLSample_location:f.toString()});if(g.length>0){var h=[];for(sample in g)h.push(g[sample].DataCollection_dataCollectionId);e[f]=h.toString()}}var i={mainRadius:100,enableMouseOver:!1,enableClick:!1,dataCollectionIds:e},j=new PuckLegend;$("#sample_puck_legend_"+b).html(j.getPanel().html);var k=function(a,d){if(d){var e=new UniPuckWidget(i);10==c.Container_capacity&&(e=new SpinePuckWidget(i));var f=_.map(d,"BLSample_location").map(function(a){return parseInt(a)}),g=_.max(f);g&&(e=g>10?new UniPuckWidget(i):new SpinePuckWidget(i)),$("#sample_puck_layout_"+b).html(e.getPanel().html),e.loadSamples(d,c.BLSample_location)}};EXI.getDataAdapter({onSuccess:k}).mx.sample.getSamplesByContainerId(c.Container_containerId)}},UncollapsedDataCollectionGrid.prototype.attachCallBackAfterRender=function(){var a=this,b=document.getElementById(document.getElementById(a.id).parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.id),c={bind:"event",appendScroll:b,beforeLoad:function(a){console.log('image "'+a.data("src")+'" is about to be loaded')},onFinishedAll:function(){EXI.mainStatusBar.showReady()}},d=(setTimeout(function(){$(".img-responsive").lazy(c)},500),setTimeout(function(){$(".smalllazy").lazy(c)},500),function(b){this.grid=b,$('a[data-toggle="tab"]').on("shown.bs.tab",function(b){var c=$(b.target).attr("href");if(c.startsWith("#dc")){var d=c.slice(4);a.displayDataCollectionTab(c,d)}if(c.startsWith("#re")){var e=c.slice(4);a.displayResultAutoprocessingTab(c,e)}if(c.startsWith("#sa")){var e=c.slice(4);a.displaySampleTab(c,e)}if(c.startsWith("#wf")){var e=c.slice(4);a.displayWorkflowsTab(c,e)}if(c.startsWith("#ph")){var d=c.slice(4);a.displayPhasingTab(c,d)}})});setTimeout(d,500,a)},WorkflowSectionDataCollection.prototype.parseWorkflow=function(a){var b=[],c=[],d=[],e=[];if(null!=a.WorkflowStep_workflowStepType){b=a.WorkflowStep_workflowStepType.split(","),c=a.WorkflowStep_status.split(","),d=a.WorkflowStep_workflowStepId.split(",");for(var f=0;f<b.length;f++){var g={status:c[f],name:b[f],workflowStepId:d[f],workflowStepIds:d,img:EXI.getDataAdapter().mx.workflowstep.getImageByWorkflowStepId(d[f])};e.push(g)}}return e},WorkflowSectionDataCollection.prototype.getHTML=function(a){var b=[],c="";return a.WorkflowStep_workflowStepType&&(b=this.parseWorkflow(a)),dust.render("workflowstepsection",b,function(a,b){c=b}),c},FileManagerPhasingGrid.prototype.load=function(a){this.data=a,this.store.loadData(a)},FileManagerPhasingGrid.prototype.findPDBMatch=function(a){for(var b=0;b<this.data.length;b++){var c=this.data[b];if(c.fileName.endsWith(".pdb"))return c}},FileManagerPhasingGrid.prototype.getPanel=function(){var a=this;return this.store=Ext.create("Ext.data.Store",{fields:["fileType","phasingProgramAttachmentId","filePath","phasingPrograms","fileName"]}),this.panel=Ext.create("Ext.grid.Panel",{title:"Files",store:this.store,flex:.3,height:600,cls:"border-grid",emptyText:"No files found",layout:"fit",margin:"0 5 0 5",viewConfig:{stripeRows:!0},columns:[{text:"fileName",flex:1,dataIndex:"fileName"},{text:"Viewer",flex:1,dataIndex:"filePath",renderer:function(b,c,d){var e=null,f=null;if(d.data.fileName.endsWith(".map")&&(e=a.findPDBMatch(d.data.fileName),null!=e)){e=EXI.getDataAdapter().mx.phasing.downloadPhasingFilesByPhasingAttachmentId(e.phasingProgramAttachmentId);var g=EXI.getDataAdapter().mx.phasing.downloadPhasingFilesByPhasingAttachmentId(d.data.phasingProgramAttachmentId);return f="viewers/uglymol/1mru.html?pdb="+e+"&map="+g,"<a target='_blank' style='showme openGridButton' href='"+f+"'><div style='text-align:center;color:white;width:60px;background-color:#3892d3;'>VIEWER</div></a>"}return d.data.fileName.endsWith(".pdb")&&(e=a.findPDBMatch(d.data.fileName),null!=e)?(e=EXI.getDataAdapter().mx.phasing.downloadPhasingFilesByPhasingAttachmentId(e.phasingProgramAttachmentId),f="viewers/pv/index.html?pdb="+e,"<a target='_blank' style='showme openGridButton' href='"+f+"'><div style='text-align:center;color:white;width:60px;background-color:#3892d3;'>VIEWER</div></a>"):void 0}},{text:"filePath",flex:1,hidden:!0,dataIndex:"filePath"},{xtype:"actioncolumn",flex:.3,text:"Download",items:[{icon:"../images/icon/ic_get_app_black_24dp.png",tooltip:"Download",handler:function(a,b,c){window.open(EXI.getDataAdapter().mx.phasing.downloadPhasingFilesByPhasingAttachmentId(a.store.getAt(b).data.phasingProgramAttachmentId))}}]}]}),this.panel},PhasingGrid.prototype.load=function(a){this.store.loadData(a,!1)},PhasingGrid.prototype._getTbar=function(){var a=[];return a.push(Ext.create("Ext.Action",{text:"Add",icon:"images/icon/add.png",disabled:!1,handler:function(a,b){}})),a},PhasingGrid.prototype.getPanel=function(){return this.store=Ext.create("Ext.data.Store",{fields:["phasingStepId"]}),this.store.sort("phasingStepId"),this.panel=Ext.create("Ext.grid.Panel",{title:"Phasing steps",store:this.store,cls:"border-grid",layout:"fit",columns:[{text:"phasingStepId",hidden:!0,dataIndex:"phasingStepId",flex:1},{text:"Space Group",hidden:!0,dataIndex:"spaceGroupShortName",flex:1},{text:"Prepare",dataIndex:"phasingStepType",flex:.2,renderer:function(a,b,c){var d="";try{dust.render("phasinggrid.prepare",c.data,function(a,b){d=b})}catch(a){return"Parsing error"}return d}},{text:"Substructure Determination",dataIndex:"phasingStepType",flex:.4,renderer:function(a,b,c){var d="";try{dust.render("phasinggrid.substructure",c.data.children,function(a,b){d=b})}catch(a){return"Parsing error"}return d}},{text:"Phasing",dataIndex:"phasingStepType",flex:1,renderer:function(a,b,c){var d="",e=function(a,b){d=d+"<br />"+b};try{for(var f=c.data.children,g=0;g<f.length;g++){for(var h=0;h<f[g].children.length;h++){var i=f[g].children[h];if(i.metric&&i.statisticsValue)for(i.statistics=[],k=0;k<i.metric.split(",").length;k++)i.statistics.push({name:i.metric.split(",")[k],value:i.statisticsValue.split(",")[k]})}dust.render("phasinggrid.stats",f[g].children,e)}}catch(a){return"Parsing error "+a}return d}}],flex:1}),this.tbar&&this.panel.addDocked({xtype:"toolbar",cls:"toolBarGrid",height:48,items:this._getTbar()}),this.panel},PhasingViewerMainView.prototype.getPanel=MainView.prototype.getPanel,PhasingViewerMainView.prototype.getContainer=function(){return this.tabPanel=Ext.create("Ext.tab.Panel",{margin:10,cls:"border-grid",defaults:{anchor:"100%"},items:[{title:"Summary",bodyPadding:10,items:[{xtype:"container",layout:"hbox",items:[this.summaryPhasingGrid.getPanel(),this.fileManagerPhasingGrid.getPanel()]}]},{title:"Network",bodyPadding:10,items:this.phasingNetworkWidget.getPanel()}]}),this.tabPanel},PhasingViewerMainView.prototype.load=function(a,c){var d=this;this.panel.setTitle("Phasing Viewer");var e=[],f=[];if(c){var g=_.find(a,function(a){return a.phasingStepId==c});null!=g&&(f.push(g),e.push(g.phasingStepId));for(var h=function(b){return b==a[i].previousPhasingStepId},i=0;i<a.length;i++)null!=_.find(e,h(b))&&(f.push(a[i]),e.push(a[i].phasingStepId));a=f}this.summaryPhasingGrid.load(a),d.phasingNetworkWidget.load(a)},SummaryPhasingGrid.prototype.load=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.metric){var d=c.metric.split(","),e=c.statisticsValue.split(",");if(d.length>0)for(var f=0;f<d.length;f++)c[d[f]]=e[f]}}this.data=a,this.store.loadData(a)},SummaryPhasingGrid.prototype.filter=function(a,b,c,d){var e=function(a){if(a&&a[b])try{if(Number(a[b])>c&&Number(a[b])<d)return!0}catch(e){return!1}return!1};return _.filter(a,e)},SummaryPhasingGrid.prototype.getPanel=function(){var a=this;this.store=Ext.create("Ext.data.Store",{fields:["phasingStepId","previousPhasingStepId","processingPrograms","processingStatus","proposalId","sessionId","solventContent","spaceGroup","spaceGroupShortName","statisticsValue","phasingStepType","method","lowRes","highRes","phasingPrograms","enantiomorph","anomalous","Pseudo_free_CC","CC of partial model","anomalous","acronym","Average Fragment Length"]});var b=Ext.create("Ext.selection.RowModel",{allowDeselect:!0,listeners:{select:function(b,c){a.onSelect.notify(c.data)}}});return this.pseudofreeCCSplitter=Ext.create("Ext.slider.Multi",{width:300,hideLabel:!1,fieldLabel:"Pseudo Free CC",increment:1,minValue:0,maxValue:120,values:[0,100]}),this.ccOfPartialModel=Ext.create("Ext.slider.Multi",{width:300,hideLabel:!1,fieldLabel:"CC of Partial Model",increment:1,minValue:0,maxValue:120,values:[0,100]}),this.tbar=Ext.create("Ext.toolbar.Toolbar",{width:500,items:[this.pseudofreeCCSplitter,this.ccOfPartialModel,"-",{text:"Apply filter",listeners:{click:function(){var b=a.filter(a.data,"Pseudo_free_CC",a.pseudofreeCCSplitter.getValues()[0],a.pseudofreeCCSplitter.getValues()[1]);a.store.loadData(a.filter(b,"CC of partial model",a.ccOfPartialModel.getValues()[0],a.ccOfPartialModel.getValues()[1]))}}},{text:"Clear filter",listeners:{click:function(){a.store.loadData(a.data)}}}]}),this.panel=Ext.create("Ext.grid.Panel",{title:"Phasing Steps",store:this.store,selModel:b,tbar:this.tbar,height:600,cls:"border-grid",layout:"fit",flex:1,viewConfig:{stripeRows:!0,getRowClass:function(a,b,c,d){}},columns:[{text:"Space Group",flex:1,dataIndex:"spaceGroupShortName"},{text:"Steps",columns:[{text:"Prepare",flex:1,dataIndex:"previousPhasingStepId",renderer:function(a,b,c){return"PREPARE"==c.data.phasingStepType?c.data.phasingPrograms.toUpperCase():void 0}},{text:"Subs. Deter.",flex:1,dataIndex:"previousPhasingStepId",renderer:function(a,b,c){return"SUBSTRUCTUREDETERMINATION"==c.data.phasingStepType?c.data.phasingPrograms.toUpperCase():void 0}},{text:"Phasing",flex:1,dataIndex:"previousPhasingStepId",renderer:function(a,b,c){return"PHASING"==c.data.phasingStepType?c.data.phasingPrograms.toUpperCase():void 0}},{text:"Model",flex:1,dataIndex:"previousPhasingStepId",renderer:function(a,b,c){return"MODELBUILDING"==c.data.phasingStepType?c.data.phasingPrograms.toUpperCase():void 0}}]},{text:"phasingStepId",flex:1,hidden:!0,dataIndex:"phasingStepId"},{text:"previousPhasingStepId",flex:1,hidden:!0,dataIndex:"previousPhasingStepId"},{text:"phasingStepId",flex:1,hidden:!0,dataIndex:"phasingStepId"},{text:"Protein",flex:1,hidden:!0,dataIndex:"acronym"},{text:"Method",flex:1,dataIndex:"method"},{text:"Low Resolution",flex:1,dataIndex:"lowRes",renderer:function(a,b,c){return"MODELBUILDING"==c.data.phasingStepType?c.data.lowRes+" - "+c.data.highRes:void 0}},{text:"High Resolution",flex:1,hidden:!0,dataIndex:"highRes"},{text:"Enantiomorph",flex:1,dataIndex:"enantiomorph"},{text:"Anomalous",flex:1,dataIndex:"anomalous"},{text:"Solvent",flex:1,dataIndex:"solventContent"},{text:" Program",flex:1,hidden:!0,dataIndex:"phasingPrograms"},{text:"Pseudo Free <br />(CC)",flex:1,dataIndex:"Pseudo_free_CC"},{text:"Partial Model <br />(CC)",flex:1,dataIndex:"CC of partial model"},{text:"Avg. Fragment <br />Length",flex:1,dataIndex:"Average Fragment Length"}]}),this.panel},ConfirmShipmentView.prototype.getPanel=function(){var a=this;return this.pucksList=Ext.create("Ext.panel.Panel",{cls:"rounded-border",title:"Sample Changer",width:600,height:490,margin:5,autoScroll:!0,items:[]}),this.panel=Ext.create("Ext.panel.Panel",{height:500,layout:{type:"hbox",align:"center",pack:"center"},margin:5,items:[this.pucksList]}),this.panel.on("boxready",function(){a.sampleChangerName&&a.loadSampleChanger(a.sampleChangerName)}),this.panel},ConfirmShipmentView.prototype.loadSampleChanger=function(a){var b=this,c={radius:200,isLoading:!1},d=null;if("FlexHCD"==a?d=new FlexHCDWidget(c):"SC3"==a&&(d=new SC3Widget(c)),this.sampleChangerWidget=d,this.panel.insert(0,d.getPanel()),"undefined"!=typeof Storage){var e=sessionStorage.getItem("puckData");e&&this.sampleChangerWidget.load(JSON.parse(e))}this.sampleChangerWidget.render(),this.sampleChangerWidget.onPuckSelected.attach(function(a,c){b.selectPuck(c)}),this.loadPucksList(this.sampleChangerWidget)},ConfirmShipmentView.prototype.loadPucksList=function(a){var b="";dust.render("confirm.table.prepare.template",{pucks:Object.values(a.getPuckData())},function(a,c){b=c}),this.pucksList.add({html:b})},ContainerPrepareSpreadSheet.prototype.getPanel=function(){var a=this;return this.store=Ext.create("Ext.data.Store",{storeId:"spreadSheedStore",fields:["shippingName","shippingId","barCode","parcelName","containerCode","containerType","sampleCount","beamlineName","beamlineCombo","sampleChangerLocation","dewarId","containerId","capacity"],data:[]}),this.panel=Ext.create("Ext.grid.Panel",{title:"Loaded or to be Loaded on MxCube",buttons:[{xtype:"button",text:'<div style="color: white">Unload all</div>',width:200,color:"#FFFFFF",scale:"large",style:{background:"#444444"},handler:function(){var b=function(b,c){a.onUnloadAllButtonClicked.notify(),a.loadProcessingDewars(a.sampleChangerWidget)};EXI.getDataAdapter({onSuccess:b}).proposal.dewar.emptySampleLocation(_.map(a.dewars,"containerId"))}}],store:this.store,cls:"border-grid",height:this.height,width:this.width,flex:.5,columns:[{header:"Shipment",dataIndex:"shippingName",type:"text",flex:1,readOnly:!0},{header:"DewarId",dataIndex:"dewarId",type:"text",flex:1,hidden:!0,readOnly:!0},{header:"ShippingId",dataIndex:"shippingId",type:"text",flex:1,hidden:!0,readOnly:!0},{header:"ContainerId",dataIndex:"containerId",hidden:!0,type:"text",flex:1,readOnly:!0},{header:"Parcel",dataIndex:"parcelName",type:"text",flex:1,readOnly:!0},{header:"Container",dataIndex:"containerCode",type:"text",flex:1,readOnly:!0,renderer:function(a,b,c,d){return c.data.containerCode+" <span style='color:gray;font-size:10px; font-style:italic;'>("+c.data.sampleCount+" samples)</span>"}},{header:"Barcode",dataIndex:"barCode",type:"text",hidden:!0,flex:1,readOnly:!0},{header:"Container type",dataIndex:"containerType",type:"text",flex:.75,readOnly:!0,renderer:function(a,b,c,d){switch(c.data.containerType){case"Unipuck":return"<kbd style='color:white;font-size:11px;background-color:blue;'>UNIPUCK</kbd>";case"Spinepuck":return"<kbd style='color:black;font-size:11px;background-color:#CCCCCC;'>SPINEPUCK</kbd>";default:return c.data.containerType}}},{header:"Samples",dataIndex:"sampleCount",type:"text",flex:.6,hidden:!0,readOnly:!0},{header:"Beamline",dataIndex:"beamlineName",hidden:!0,type:"dropdown",flex:1,source:EXI.credentialManager.getBeamlineNames()},{header:"Beamline",dataIndex:"beamlineCombo",type:"text",flex:1,readOnly:!0,renderer:function(b,c,d,e){var f=_.map(EXI.credentialManager.getBeamlinesByTechnique("MX"),"name");f=_.union(f,[d.data.beamlineName]),_.remove(f,function(a){return-1!==_.indexOf(["ID14-4","BM14U","ID30A-2"],a)});var g={beamlines:f,selected:d.data.beamlineName,containerId:d.data.containerId,id:a.id},h="";return dust.render("beamlines.combobox.template",g,function(a,b){h=b}),h}},{header:"Sample Changer Location",dataIndex:"sampleChangerLocation",flex:1,type:"text",tdCls:"scl-cell"}],viewConfig:{getRowClass:function(b,c,d,e){if(""==b.get("sampleChangerLocation")||" "==b.get("sampleChangerLocation")||null==b.get("sampleChangerLocation"))return"warning-row";for(var f=0;f<a.dewars.length;f++){var g=a.dewars[f];if(b.get("containerId")!=g.containerId&&g.beamlineLocation==b.get("beamlineName")&&b.get("sampleChangerLocation")==g.sampleChangerLocation)return"puck-error"}return""}},listeners:{itemclick:function(b,c,d,e,f){"SELECT"!=f.target.tagName&&a.onSelectRow.notify({record:c,item:d})}},margin:5,items:[{html:"<div style='height:700px;' id='"+this.id+"'></div>",flex:1,height:400}]}),this.panel},ContainerPrepareSpreadSheet.prototype.loadProcessingDewars=function(a){var b=this;this.panel.setLoading();var c=function(c,d){var e=_.filter(d,function(a){return"processing"==a.shippingStatus});b.load(e,a),b.panel.setLoading(!1),b.onLoaded.notify(e)},d=function(a,c){EXI.setError("Ops, there was an error"),b.panel.setLoading(!1)};EXI.getDataAdapter({onSuccess:c,onError:d}).proposal.dewar.getDewarsByProposal()},ContainerPrepareSpreadSheet.prototype.load=function(a,b){var c=this;this.dewars=a,b&&(this.sampleChangerWidget=b);for(var d=[],e=!1,f=0;f<a.length;f++){var g=a[f];if(g.containerId){var h="Unipuck";g.capacity&&10==g.capacity&&(h="Spinepuck"),d.push({shippingName:g.shippingName,shippingId:g.shippingId,parcelName:g.dewarCode,barCode:g.barCode,containerCode:g.containerCode,containerType:h,sampleCount:g.sampleCount,beamlineName:g.beamlineLocation,sampleChangerLocation:g.sampleChangerLocation,dewarId:g.dewarId,containerId:g.containerId,capacity:g.capacity})}else e=!0}e&&$.notify("Error: error loading the dewars","error"),this.store.loadData(d),$(".beamlines-select").change(function(a){var b=$("#"+c.id+"-"+a.target.value+" option:selected").text(),d=a.target.value;c.updateBeamlineName(d,b),c.onBeamlineChanged.notify(b)})},ContainerPrepareSpreadSheet.prototype.updateSampleChangerLocation=function(a,b){for(var c=this,d=this.getRowsByContainerId(a),e=0;e<d.length;e++){var f=d[e];if(f.get("containerId")==a){var g=f.get("beamlineName");if(g){var h=function(a,b){c.loadProcessingDewars()},i=function(a,b){EXI.setError("Ops, there was an error")};EXI.getDataAdapter({onSuccess:h,onError:i}).proposal.dewar.updateSampleLocation([a],[g],[b])}else $.notify("The beamline is not defined","error");return}}},ContainerPrepareSpreadSheet.prototype.updateBeamlineName=function(a,b){var c=this,d=function(a,b){c.loadProcessingDewars()},e=function(a,b){EXI.setError("Ops, there was an error")};EXI.getDataAdapter({onSuccess:d,onError:e}).proposal.dewar.updateSampleLocation([a],[b],[""])},ContainerPrepareSpreadSheet.prototype.getRowsByContainerId=function(a){var b=_.filter(this.panel.store.data.items,function(b){return b.data.containerId==a});return b},DewarListSelectorGrid.prototype.load=function(a){var b=this;this.dewars=a;var c=_.keyBy(a,"shippingId"),d=[];_(c).forEach(function(a){if(b.filterByDate){if(a.shippingStatus&&"PROCESSING"==a.shippingStatus.toUpperCase())return void d.push(a);a.sessionStartDate&&moment().diff(moment(a.sessionStartDate,"'MMMM Do YYYY, h:mm:ss a'"))<=0&&d.push(a)}else d.push(a)}),this.panel.setTitle(d.length+" shipments candidates for "+EXI.proposalManager.getProposals()[0].code+EXI.proposalManager.getProposals()[0].number),this.store.loadData(d)},DewarListSelectorGrid.prototype.getStatsByShippingId=function(a){var b=_.filter(this.dewars,function(b){return b.shippingId==a}),c=0;return _(b).forEach(function(a){c+=a.sampleCount}),{samples:c,dewars:Object.keys(_.groupBy(b,"dewarId")).length,containers:b.length}},DewarListSelectorGrid.prototype.getSelectedData=function(){for(var a=this.panel.getSelectionModel().selected.items,b=[],c=0;c<a.length;c++)b.push(a[c].data);return b},DewarListSelectorGrid.prototype.getStore=function(){return this.store=Ext.create("Ext.data.Store",{fields:["beamlineLocation","storageLocation","containerStatus","containerType","sessionStartDate","creationDate","beamLineOperator","shippingStatus","shippingName","barCode","beamlineName","dewarCode","dewarStatus","sampleChangerLocation","sampleCount","sessionStartDate","type"],sortInfo:{field:"sessionStartDate",direction:"DESC"},sorters:{field:"sessionStartDate",direction:"ASC",sorterFn:function(a,b){var c=new Date(a.data.sessionStartDate),d=new Date(b.data.sessionStartDate);return c===d?0:d>c?1:-1}}}),this.store},DewarListSelectorGrid.prototype.getPanel=function(){var a=this;return this.tbar=Ext.create("Ext.toolbar.Toolbar",{items:[{xtype:"checkboxfield",boxLabel:"Display only shipments scheduled for future sessions or in PROCESSING status",checked:this.filterByDate,listeners:{change:function(b,c,d,e){a.filterByDate=c,a.load(a.dewars)}}}]}),this.panel=Ext.create("Ext.grid.Panel",{title:"Select dewars",store:this.getStore(),sortableColumns:!1,height:this.height,width:this.width,flex:.5,tbar:this.tbar,margin:5,columns:[{text:"Shipment",columns:[{text:"Name",dataIndex:"shippingName",flex:3},{text:"Status",dataIndex:"shippingStatus",flex:1,renderer:function(a,b,c){return c.data.shippingStatus.toUpperCase()}},{text:"Created on",dataIndex:"creationDate",flex:1,hidden:!0,renderer:function(a,b,c){return c.data.creationDate?moment(c.data.creationDate,"'MMMM Do YYYY, h:mm:ss a'").format("DD/MM/YYYY"):void 0}}]},{text:"Experiment",columns:[{text:"Start on",dataIndex:"sessionStartDate",flex:2,renderer:function(a,b,c){return c.data.sessionStartDate?moment(c.data.sessionStartDate,"'MMMM Do YYYY, h:mm:ss a'").format("DD/MM/YYYY"):void 0}},{text:"beamline",dataIndex:"beamlineName",flex:1},{text:"Local contact",dataIndex:"beamLineOperator",flex:2,hidden:!0}]},{text:"#",flex:1,renderer:function(b,c,d){var e=a.getStatsByShippingId(d.data.shippingId);return e.dewars+" parcels / "+e.containers+" containers ("+e.samples+" samples)"}},{xtype:"actioncolumn",flex:.3,items:[{icon:"../images/icon/add.png",handler:function(b,c,d){b.getSelectionModel().select(c),a.onSelect.notify(a.store.getAt(c).data)},isDisabled:function(a,b,c,d,e){return"processing"==e.data.shippingStatus}}]},{xtype:"actioncolumn",flex:.3,items:[{icon:"../images/icon/ic_highlight_remove_black_48dp.png",handler:function(b,c,d){b.getSelectionModel().select(c),a.onSelect.notify(a.store.getAt(c).data)},isDisabled:function(a,b,c,d,e){return"processing"!=e.data.shippingStatus}}]}],viewConfig:{stripeRows:!0,getRowClass:function(a,b,c,d){return"processing"==a.data.shippingStatus?"warning-grid-row":void 0}}}),this.panel},LoadSampleChangerView.prototype.setSelectedRow=function(a){if(this.containerListEditor.panel.getSelectionModel().select(a),this.selectedRowItem=$(".x-grid-item-selected")[0],this.selectedContainerId=-1,a.get("containerId")&&(this.selectedContainerId=a.get("containerId")),this.selectedContainerCapacity=a.get("capacity"),this.sampleChangerWidget.disablePucksOfDifferentCapacity(this.selectedContainerCapacity),!this.selectedPuck){var b=this.sampleChangerWidget.convertSampleChangerLocationToId(Number(a.get("sampleChangerLocation")));if(b){var c=this.sampleChangerWidget.findPuckById(b);
this.setSelectedPuck(c)}}var d="<span style='font-size:12px;'>Click on a sample changer </br>location to place the container</span>";null!=a.get("sampleChangerLocation")&&""!=a.get("sampleChangerLocation")&&(d="Unload #"+a.get("sampleChangerLocation")),this.previewPuck(a.get("containerId"),a.get("capacity"),{info:[{text:"Container",value:a.get("containerCode")},{text:"SC Location",value:a.get("sampleChangerLocation")}]},d),this.selectedPuck&&this.sampleChangerWidget.enablePuck(this.selectedPuck),$("#"+this.selectedRowItem.id).addClass("selected-row"),$("#"+this.containerListEditor.id+"-"+this.selectedContainerId).prop("disabled",!1),$("#"+this.containerListEditor.id+"-"+this.selectedContainerId).css("pointer-events","auto")},LoadSampleChangerView.prototype.setSelectedPuck=function(a){if(this.selectedPuck=a,$("#"+a.id).addClass("puck-selected"),a.isEmpty)this.selectedContainerId||(this.selectedContainerId=a.containerId),this.previewPuck(a.containerId,a.capacity,{info:[{text:"SC Location",value:this.sampleChangerWidget.convertIdToSampleChangerLocation(a.id)}]},"EMPTY");else if(!this.selectedContainerId){var b=this.containerListEditor.getRowsByContainerId(a.containerId);this.setSelectedRow(b[0])}},LoadSampleChangerView.prototype.deselectRow=function(){$("#"+this.containerListEditor.id+"-"+this.selectedContainerId).prop("disabled","disabled"),$("#"+this.containerListEditor.id+"-"+this.selectedContainerId).css("pointer-events","none"),this.containerListEditor.panel.getSelectionModel().deselectAll(),this.selectedContainerId=null,this.selectedSampleCount=null,this.sampleChangerWidget.enableAllPucks(),this.selectedRowItem&&$("#"+this.selectedRowItem.id).removeClass("selected-row"),this.selectedRowItem=null},LoadSampleChangerView.prototype.deselectPuck=function(){$("#"+this.selectedPuck.id).removeClass("puck-selected"),this.selectedPuck=null},LoadSampleChangerView.prototype.returnToSelectionStatus=function(){this.deselectRow(),this.selectedPuck&&this.deselectPuck(),this.previewPanelView&&this.cleanPreviewPanel()},LoadSampleChangerView.prototype.loadSampleChangerPuck=function(a,b){if(a.isEmpty){this.returnToSelectionStatus();var c=this.sampleChangerWidget.convertIdToSampleChangerLocation(a.id);this.containerListEditor.updateSampleChangerLocation(b,c)}else $.notify("Error: choose an empty puck","error")},LoadSampleChangerView.prototype.createSampleChangerWidget=function(a,b){var c={radius:this.widgetRadius,isLoading:!1,beamlineName:b};return this.sampleChangerWidget=new FlexHCDWidget(c),"SC3"==a?this.sampleChangerWidget=new SC3Widget(c):"RoboDiff"==a&&(this.sampleChangerWidget=new RoboDiffWidget(c)),this.sampleChangerWidget},LoadSampleChangerView.prototype.changeSampleChangerWidgetByBeamline=function(a){var b=_.filter(EXI.credentialManager.getBeamlinesByTechnique("MX"),{name:a});b.length>0?this.createSampleChangerWidget(b[0].sampleChangerType,b[0].name):this.createSampleChangerWidget("FlexHCD",a),this.widgetContainer.removeAll(),this.load(this.containers),this.widgetContainer.insert(this.sampleChangerWidget.getPanel()),this.reloadSampleChangerWidget(),this.sampleChangerWidget.blink(),this.returnToSelectionStatus()},LoadSampleChangerView.prototype.load=function(a){var b=this;this.sampleChangerWidget.emptyAllPucks();var c={};if(a){this.containers=a;for(var d=0;d<a.length;d++){var e=a[d];if(e.beamlineLocation==this.sampleChangerWidget.beamlineName){var f=e.sampleChangerLocation;if(""!=f&&null!=f){var g=this.sampleChangerWidget.convertSampleChangerLocationToId(Number(f));if(g){var h=this.sampleChangerWidget.findPuckById(g);h.capacity!=e.capacity,0==e.sampleCount?(h.containerId=e.containerId,h.isEmpty=!1):c[e.containerId]=g}}}}if(!_.isEmpty(c)){var i=function(a,d){var e=b.sampleChangerWidget.loadSamples(d,c);0==e.length&&b.sampleChangerWidget.removeClassToAllPucks("puck-error")};EXI.getDataAdapter({onSuccess:i}).mx.sample.getSamplesByContainerId(_.keys(c))}}else this.containerListEditor.loadProcessingDewars(this.sampleChangerWidget)},LoadSampleChangerView.prototype.getPanel=function(){var a=this;return this.widgetContainer=Ext.create("Ext.panel.Panel",{width:400,height:2*this.widgetRadius,margin:8,layout:{type:"hbox",pack:"center"},items:[this.sampleChangerWidget.getPanel()]}),this.verticalPanel=Ext.create("Ext.panel.Panel",{layout:{type:"vbox",align:"center",pack:"center"},items:[{html:"<div id='"+this.id+"-notifications' class='container-fluid' align='center' ><div class='row' style='width:370px;'><div class='col-md-9'><span id='"+this.id+"-scw-label' class='"+this.id+"-lab' style='width:500px;font-size:20px;font-weight:100;'></span></div><div class='col-md-2'><button id='"+this.id+"-unloadSC-button' type='button' class='btn btn-default btn-xs' style='background:rgb(68, 68, 68);color: #ffffff;'><b>Unload SC</b></button></div></div></div>"},this.widgetContainer]}),this.panel=Ext.create("Ext.panel.Panel",{autoScroll:!0,layout:"hbox",height:this.height,width:this.width,margin:5,items:[this.containerListEditor.getPanel(),this.verticalPanel]}),this.panel.on("boxready",function(){a.reloadSampleChangerWidget(),$("#"+a.id+"-unloadSC-button").unbind("click").click(function(b){var c=_.map(_.map(a.sampleChangerWidget.getAllFilledPucks(),"puckWidget"),"containerId");if(c.length>0){var d=function(b,c){a.returnToSelectionStatus(),a.load()};EXI.getDataAdapter({onSuccess:d}).proposal.dewar.emptySampleLocation(c)}})}),this.panel},LoadSampleChangerView.prototype.reloadSampleChangerWidget=function(){var a=this;this.sampleChangerWidget.setClickListeners(),this.sampleChangerWidget.onPuckSelected.attach(function(b,c){a.selectedContainerId?a.selectedPuck&&a.selectedPuck==c?a.returnToSelectionStatus():a.loadSampleChangerPuck(c,a.selectedContainerId):a.selectedPuck?a.selectedPuck==c?a.returnToSelectionStatus():(a.deselectRow(),a.deselectPuck(),a.setSelectedPuck(c)):a.setSelectedPuck(c)}),this.sampleChangerWidget.render(),$("#"+this.id+"-scw-label").html(this.sampleChangerWidget.beamlineName+" ("+this.sampleChangerWidget.name+")"),this.panel.doLayout()},LoadSampleChangerView.prototype.cleanPreviewPanel=function(){this.previewPanelView.clean(),this.previewPanelView.panel&&this.previewPanelView.panel.body&&this.verticalPanel.remove(this.previewPanelView.panel)},LoadSampleChangerView.prototype.previewPuck=function(a,b,c,d){this.previewPanelView.previewPanel&&this.cleanPreviewPanel(),this.verticalPanel.add(this.previewPanelView.getPanel()),this.previewPanelView.load(a,b,c,d)},PrepareMainView.prototype.updateStatus=function(a,b){var c=this;c.dewarListSelector.panel.setLoading("Updating shipment Status");var d=function(a,b){EXI.mainStatusBar.showReady("Processing update successfully"),c.dewarListSelector.panel.setLoading(!1),c.load()},e=function(a){EXI.setError(a)};EXI.getDataAdapter({onSuccess:d,onError:e}).proposal.shipping.updateStatus(a,b)},PrepareMainView.prototype.manageButtons=function(){1==this.currentStep?(Ext.getCmp("previous-button").hide(),Ext.getCmp("next-button").enable()):(Ext.getCmp("previous-button").show(),Ext.getCmp("next-button").hide());for(var a=1;2>=a;a++)a==this.currentStep?$("#step-"+a).addClass("active-step"):$("#step-"+a).removeClass("active-step")},PrepareMainView.prototype.changeStep=function(a){this.currentStep+=a,location.href="#/mx/prepare/main"+this.steps[this.currentStep-1]},PrepareMainView.prototype.getPanel=function(){var a=this;return this.container=Ext.create("Ext.panel.Panel",{layout:{type:"hbox",pack:"center"},height:this.height,width:this.width,cls:"border-grid",items:[]}),this.panel=Ext.create("Ext.panel.Panel",{autoScroll:!0,buttons:this.getButtons(),layout:{type:"vbox",align:"center"},width:100,height:this.height+200,items:[this.getToolBar(),this.container]}),this.panel.on("boxready",function(){a.manageButtons()}),this.panel},PrepareMainView.prototype.getToolBar=function(){var a="";return dust.render("toolbar.prepare.template",[],function(b,c){a=c}),{html:a}},PrepareMainView.prototype.getButtons=function(){var a=this;return[{text:"Previous",cls:"btn btn-lg btn-success",id:"previous-button",margin:"0 0 0 300",handler:function(){a.currentStep>0&&a.changeStep(-1)}},"->",{text:"Next",cls:"btn btn-lg btn-success",id:"next-button",margin:"0 300 0 0",handler:function(b,c,d){a.currentStep<4&&a.changeStep(1)}}]},PrepareMainView.prototype.load=function(){var a=this;if($(".notifyjs-corner").empty(),this.panel.setTitle("Prepare Experiment"),this.container.removeAll(),1==this.currentStep){a.container.add(a.dewarListSelector.getPanel()),a.dewarListSelector.panel.setLoading();var b=function(b,c){a.containers=c,a.dewarListSelector.load(c),a.dewarListSelector.panel.setLoading(!1)},c=function(b,c){EXI.setError("Ops, there was an error"),a.dewarListSelector.panel.setLoading(!1)};EXI.getDataAdapter({onSuccess:b,onError:c}).proposal.dewar.getDewarsByProposal()}else if(2==this.currentStep){var b=function(b,c){a.containers=c;var d=_.uniq(_.map(_.filter(a.containers,function(a){return"processing"==a.shippingStatus}),"beamlineLocation"));if(d.length>0){var e=_.filter(EXI.credentialManager.getBeamlinesByTechnique("MX"),{name:d[0]});e.length>0?a.loadSampleChangerView.createSampleChangerWidget(e[0].sampleChangerType,e[0].name):($.notify("Warning: Unknown beamline "+d[0],"warn"),a.loadSampleChangerView.createSampleChangerWidget("FlexHCD",d[0]));for(var f=1;f<d.length;f++){var e=_.filter(EXI.credentialManager.getBeamlinesByTechnique("MX"),{name:d[f]});0==e.length&&$.notify("Warning: Unknown beamline "+d[f],"warn")}}a.container.add(a.loadSampleChangerView.getPanel()),a.loadSampleChangerView.load()};EXI.getDataAdapter({onSuccess:b}).proposal.dewar.getDewarsByProposal()}},PrepareMainView.prototype.save=function(a,b){"undefined"!=typeof Storage&&sessionStorage.setItem(a,b)},PrepareMainView.prototype.removeFromStorage=function(a){"undefined"!=typeof Storage&&sessionStorage.removeItem(a)},PrepareMainView.prototype.storeSampleChangerWidget=function(a){var b=a.getPuckData();this.save("puckData",JSON.stringify(b))},PreviewPanelView.prototype.getPanel=function(){var a=this;return this.infoPanel=Ext.create("Ext.panel.Panel",{width:this.width/2,height:this.height/2,border:2,items:[]}),this.instructionsButton=Ext.create("Ext.Button",{text:"",width:this.width/2,height:this.height/2,scale:"large",style:{background:"#444444"},listeners:{click:function(b){null!=b.text&&"Unload"==b.text.split(" ")[0]&&a.onUnloadButtonClicked.notify()}}}),this.infoContainer=Ext.create("Ext.panel.Panel",{layout:"vbox",width:this.width/2,height:this.height,items:[this.infoPanel,this.instructionsButton]}),this.previewPanel=Ext.create("Ext.panel.Panel",{width:this.width/2,height:this.height,items:[]}),this.panel=Ext.create("Ext.panel.Panel",{margin:5,cls:"border-grid",layout:"hbox",width:this.width,height:this.height,items:[this.infoContainer,this.previewPanel]}),this.panel},PreviewPanelView.prototype.load=function(a,b,c,d){function e(a,b){b.length>0&&g.puckWidget.loadSamples(b)}this.clean();var f="";dust.render("info.grid.template",c,function(a,b){f=b}),this.infoPanel.removeAll(),this.infoPanel.add({html:f,margin:6}),this.instructionsButton.setText(d),this.puckData.containerId=a,10==b?this.puckData.puckType="Spinepuck":this.puckData.puckType="Unipuck";var g=new PuckWidgetContainer(this.puckData);this.previewPanel.add(g.getPanel()),EXI.getDataAdapter({onSuccess:e}).mx.sample.getSamplesByContainerId(a)},PreviewPanelView.prototype.clean=function(){this.previewPanel&&(this.previewPanel.removeAll(),this.infoPanel.removeAll(),this.instructionsButton.setText(""))},WorkflowStepMainView.prototype.getPanel=MainView.prototype.getPanel,WorkflowStepMainView.prototype.getContainer=function(){return this.mainPanel=Ext.create("Ext.panel.Panel",{cls:"border-grid",autoScroll:!0,title:"Workflow",margin:"10 0 0 10",flex:1,items:[]}),this.mainPanel},WorkflowStepMainView.prototype.onBoxReady=function(){},WorkflowStepMainView.prototype.getGrid=function(a,b,c){for(var d=Ext.create("Ext.data.Store",{fields:b,data:c}),e=[],f=0;f<b.length;f++)e.push({text:b[f],dataIndex:b[f],flex:1});var g=Ext.create("Ext.grid.Panel",{title:a,flex:1,margin:"10 180 10 10",cls:"border-grid",store:d,columns:e});return g.on("boxready",function(){}),g},WorkflowStepMainView.prototype.getImageResolution=function(a){if(a.xsize){var b=a.xsize/1024;a.xsize=a.xsize*b,a.ysize=a.ysize*b}return a},WorkflowStepMainView.prototype.getImagesResolution=function(a){var b=1024;b/=a.length;for(var c=0;c<a.length;c++){var d=a[c];if(d.xsize){var e=b/d.xsize;d.xsize=d.xsize*e,d.ysize=d.ysize*e}}return a},WorkflowStepMainView.prototype.load=function(a){function b(a,b){var d=JSON.parse(b).items;c.items=d,c.panel.setTitle(JSON.parse(b).title);for(var e=function(a,b){c.mainPanel.insert({padding:2,html:b})},f=0;f<d.length;f++){console.log(d[f]);var g=[];switch(d[f].type){case"table":case"image":d[f]=c.getImageResolution(d[f]);break;case"images":d[f].items=c.getImagesResolution(d[f].items);break;case"logFile":d[f].id=BUI.id(),g.push(function(){$("#"+d[f].id).click(function(){var a=_.find(c.items,{id:this.id}),b=a.title.replace(/\s/g,""),d=a.logText,e=document.createElement("a");if(e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(d)),e.setAttribute("download",b),document.createEvent){var f=document.createEvent("MouseEvents");f.initEvent("click",!0,!0),e.dispatchEvent(f)}else e.click()})})}dust.render("workflowmainview.template",d[f],e);for(var h=0;h<g.length;h++)g[h]()}c.mainPanel.setLoading(!1)}var c=this;this.panel.setTitle("Workflow"),c.mainPanel.removeAll(),c.mainPanel.setLoading(),EXI.getDataAdapter({onSuccess:b}).mx.workflowstep.getResultByWorkflowStepId(a.workflowStepId)},XfeViewerMainView.prototype.getPanel=MainView.prototype.getPanel,XfeViewerMainView.prototype.getGrid=function(){var a=this;return this.store=Ext.create("Ext.data.Store",{fields:["name","value","x","y"],sorters:[{property:"value",direction:"DESC"}]}),this.grid=Ext.create("Ext.grid.Panel",{title:"Labels",store:this.store,cls:"border-grid",width:300,height:700,columns:[{text:"name",dataIndex:"name",flex:1},{text:"value",dataIndex:"value",flex:1},{text:"x",dataIndex:"",id:this.id+"x",flex:.5,renderer:function(b,c,d){var e=a.id+"_"+d.data.name+"_X";return d.data.x?'<input disabled id="'+e+'" type="checkbox" name="x" value="bike" checked>':'<input id="'+e+'" type="checkbox" name="x" value="bike">'}},{text:"y",dataIndex:"",id:this.id+"y",flex:.5,renderer:function(b,c,d){var e=a.id+"_"+d.data.name+"_Y";return d.data.y?'<input id="'+e+'" type="checkbox" name="y" value="bike" checked="'+d.data.y+'">':'<input id="'+e+'" type="checkbox" name="y" value="bike">'}}],listeners:{cellclick:function(b,c,d,e,f,g,h,i){2==d&&a.setXColumn(e.data.name,document.getElementById(a.id+"_"+e.data.name+"_X").checked),3==d&&a.setYColumn(e.data.name,document.getElementById(a.id+"_"+e.data.name+"_Y").checked),a.parseData()}}}),this.grid},XfeViewerMainView.prototype.setXColumn=function(a,b){var c=_.filter(this.data.labels,function(b){return b.name==a});c&&(this.data.labels=_.map(this.data.labels,function(a){return a.x=!1,a}),c[0]&&(c[0].x=b,c[0].y=!b)),this.store.loadData(this.data.labels)},XfeViewerMainView.prototype.setYColumn=function(a,b){var c=_.filter(this.data.labels,function(b){return b.name==a});c&&c[0]&&(c[0].y=b),this.store.loadData(this.data.labels)},XfeViewerMainView.prototype.getContainer=function(){var a=this;return Ext.create("Ext.container.Container",{layout:{type:"hbox"},margin:10,items:[{xtype:"container",margin:"5 0 0 5",width:300,items:[this.getGrid()]},{xtype:"container",flex:.8,margin:"5 0 0 5",items:[{html:'<div style="width:100%"  id="plot'+a.id+'"></div>',cls:"border-grid",id:this.id+"containerLayout",height:700},{html:'Results produced by <a href="http://pymca.sourceforge.net/">PyMca</a>',cls:"border-grid",margin:"2 0 0 0",flex:1,height:20}]}]})},XfeViewerMainView.prototype.getSumForLabels=function(a,b){var c=this;try{var d=function(a){return{name:a[0].name,x:a[0].x,y:a[0].y,value:a[1]}},e=_.map(_.zip(a,b),d);return e=_.reject(e,function(a){return-1!=_.indexOf(c.filters,a.name)})}catch(f){console.log(f)}},XfeViewerMainView.prototype.sumByColums=function(a,b){for(var c=new Array(a.length),d=0;d<b.length;d++)for(var e=0;e<b[d].length;e++)null==c[e]&&(c[e]=0),c[e]=c[e]+b[d][e];return c},XfeViewerMainView.prototype.getDataColumn=function(a,b){function c(a){return _.pullAt(a,b)}return _.map(a,c)},XfeViewerMainView.prototype.parseData=function(){var a=_.cloneDeep(this.data.data),b=_.filter(this.data.labels,function(a){return a.x})[0],c=this.getDataColumn(a,[_.indexOf(this.data.labels,b)]);a=_.cloneDeep(this.data.data);for(var d=_.filter(this.data.labels.slice(),function(a){return a.y}),e=[],f=0;f<d.length;f++)e.push(_.indexOf(this.data.labels,d[f]));var g=this.getDataColumn(a,e);for(f=0;f<c.length;f++)g[f]=_.concat(c[f],g[f]);this.renderPlot(_.concat(b,d),g)},XfeViewerMainView.prototype.getAnnotations=function(a,b){var c=[];if(a)for(var d=a[0].map(function(b,c){return a.map(function(a){return a[c]})}),e=function(a){return a==g},f=0;f<b.length;f++){var g=_.max(d[f]),h=_.findIndex(d[f],e);c.push({x:a[h][0],shortText:b[f].name,text:b[f].name,series:b[f].name,width:100,height:25})}return c},XfeViewerMainView.prototype.renderPlot=function(a,b){var c=this,d=new Dygraph(document.getElementById("plot"+this.id),b,{legend:"always",title:"XRF",labels:_.map(a,"name"),height:600,width:800,displayAnnotations:!0,labelsSeparateLines:!0,labelsShowZeroValues:!1,logscale:!1,ylabel:"Count"});d.ready(function(){d.setAnnotations(c.getAnnotations(b,a))})},XfeViewerMainView.prototype.parseHeaders=function(a){function b(a){return c+=1,{name:a.replace(new RegExp('"',"g"),""),x:1==c,y:1!=c}}var c=0;return _.map(a.split(","),b)},XfeViewerMainView.prototype.plot=function(){var a=this;$.ajax({url:EXI.getDataAdapter().mx.xfescan.getCSV(this.xfeFluorescenceSpectrumId),context:this}).done(function(b){if(!b)return void EXI.setError("CSV is empty");var c=b.split("\n");if(c){if(!c[0])return void EXI.setError("No labels on csv");this.data.labels=this.parseHeaders(c[0]);var d=function(a){function b(a){return parseFloat(a)}var c=a.split(",");return c=_.map(c,b)};this.data.data=_.map(_.slice(c,1,c.length-1),d);try{this.data.labels=this.getSumForLabels(this.data.labels,this.sumByColums(a.data.labels,a.data.data)),this.store.loadData(this.data.labels)}catch(e){EXI.setError(e.message)}try{this.renderPlot(this.data.labels,this.data.data)}catch(e){EXI.setError(e.message)}}})},XfeViewerMainView.prototype.load=function(a){this.panel.setTitle("XRF Viewer"),this.xfeFluorescenceSpectrumId=a,this.plot()},CurvePlotter.prototype.getPanel=function(){return this.plotPanel=Ext.create("Ext.container.Container",{flex:1,margin:this.margin,items:[{html:'<div id="'+this.targetId+'"></div>',id:this.id}]}),this.plotPanel.on("afterrender",function(){}),this.plotPanel.on("resize",function(){}),this.plotPanel},CurvePlotter.prototype.getPointCount=function(){return this.dygraph.rawData_.length},CurvePlotter.prototype.getColors=function(){return this.dygraph.getColors()},CurvePlotter.prototype.getLabels=function(){return this.dygraph.getLabels()},CurvePlotter.prototype.render=function(a){var b=this;null!=document.getElementById(this.targetId)&&(document.getElementById(this.targetId).innerHTML="",this.width=this.plotPanel.getWidth(),this.height=this.plotPanel.getHeight(),document.getElementById(this.targetId).setAttribute("style","border: 1px solid #000000; height:"+(this.plotPanel.getHeight()-1)+"px;width:"+(this.plotPanel.getWidth()-2)+"px;"),Ext.getCmp(this.id).setHeight(this.plotPanel.getHeight()),Ext.getCmp(this.id).setWidth(this.plotPanel.getWidth()),this.dygraph=new Dygraph(document.getElementById(this.targetId),a,{title:this.title,titleHeight:20,labelsSeparateLines:!0,errorBars:!0,connectSeparatedPoints:!0,pointClickCallback:function(a,c){b.onPointClickCallback.notify(c.name)}}),this.dygraph.ready(function(){b.onRendered.notify()}))},CurvePlotter.prototype.loadMerge=function(a,b,c,d){this.render(EXI.getDataAdapter().saxs.hplc.getFramesMergeURL(a,b,c,d))},CurvePlotter.prototype.loadHPLCFrame=function(a,b){this.render(EXI.getDataAdapter().saxs.hplc.getHPLCFramesScatteringURL(a,b))},CurvePlotter.prototype.loadUrl=function(a){this.render(a)},CurvePlotter.prototype.load=function(a){this.render(EXI.getDataAdapter().saxs.frame.getFramesURL(a.frame,a.average,a.subtracted,a.sampleaverage,a.bufferaverage))},AutoProcIntegrationCurvePlotter.prototype.getPointCount=CurvePlotter.prototype.getPointCount,AutoProcIntegrationCurvePlotter.prototype.getLabels=CurvePlotter.prototype.getLabels,AutoProcIntegrationCurvePlotter.prototype.toCSV=function(a,b){for(var c=a.toString()+"\n",d=0;d<b.length;d++){for(var e=0;e<b[d].length;e++)c=c+b[d][e]+",";c=c.substring(0,c.length-1),c+="\n"}return c},AutoProcIntegrationCurvePlotter.prototype.render=function(a,b){var c=this,d=new Dygraph(document.getElementById(this.targetId),this.toCSV(a,b),{title:this.title,titleHeight:20,legend:"always",height:this.height-100,hideOverlayOnMouseOut:!0,labelsSeparateLines:!0,labelsDiv:c.targetId+"_legend",labelsDivStyles:" { 'fontSize': 6 } ",axisLabelWidth:20,connectSeparatedPoints:!0,pointClickCallback:function(a,b){c.onPointClickCallback.notify(b.name)},axes:{x:{pixelsPerXLabel:30,axisLabelFormatter:function(a,b,d){return c.xLabels[a]}}}});d.ready(function(){})},AutoProcIntegrationCurvePlotter.prototype.loadUrl=function(a){$.ajax({url:a,context:this}).done(function(a){var b=0,c=this;if(c.xLabels=[],!a)return void EXI.setError("CSV is empty");var d=a.split("\n");if(d){if(!d[0])return void EXI.setError("No labels on csv");this.data.labels=d[0].split(",");var e=function(a){return a&&""!=a?parseFloat(a):""},f=function(a){var d=[],f=a.split(",");f=_.map(f,e),d.push(b),c.xLabels.push(f[0]);for(var g=1;g<f.length;g++)g%2!=0&&d.push(f[g]);return b+=1,d};d=d.reverse(),this.data.data=_.map(_.slice(d,1,d.length-1),f);try{this.render(this.data.labels,this.data.data)}catch(g){EXI.setError(g.message)}}})},AutoProcIntegrationCurvePlotter.prototype.getHTML=function(){return'<div  id="'+this.targetId+'"></div><div  style="height:20px" id="'+this.targetId+'_legend"></div>'},AutoProcIntegrationCurvePlotter.prototype.getPanel=function(){return this.plotPanel=Ext.create("Ext.panel.Panel",{layout:{type:"fit"},height:this.height,margin:this.margin,items:[{html:this.getHTML(),id:this.id,style:{border:"1px solid black"},height:this.height,border:1}]}),this.plotPanel},ElectronDensityViewer.prototype.getPanel=function(){var a=this;return this.panel=Ext.create("Ext.panel.Panel",{buttons:this.getToolBar(),items:[{html:'<div id="'+this.id+'" height="600px"></div>',height:800}]}),this.panel.on("boxready",function(){a.load()}),this.panel},ElectronDensityViewer.prototype.load=function(){var a=this,b="";dust.render("electron.density.viewer.template",a.sample,function(a,c){b+=c}),$(document.body).html(b),init_gui(),this.XV=new XtalViewer("Viewer",null,!0,!0),draw_selection_console(this.XV),this.XV.animate(),getQuery(this.XV)||(this.XV.load_pdb("data/1mru.pdb","1mru"),this.XV.load_dsn6_map("data/1mru.omap","2mFo-Dfc",0),this.XV.animate()),this.XV.enable_leap_motion()},ElectronDensityViewer.prototype.getToolBar=function(){var a=this;return[{xtype:"button",text:"Debugger",handler:function(){a.XV}}]},EnergyScanGrid.prototype.getPanel=function(a){return this.store=Ext.create("Ext.data.Store",{fields:["dataCollectionGroup"]}),this.panel=Ext.create("Ext.grid.Panel",{border:1,padding:5,store:this.store,disableSelection:!0,columns:[{header:"",dataIndex:"dataCollectionGroup",name:"dataCollectionGroup",flex:.2,renderer:function(a,b,c){var d="";return c.data.choochURL=EXI.getDataAdapter().mx.energyscan.getChoochJpegByEnergyScanId(c.data.energyScanId),dust.render("energyscangrid.template",c.data,function(a,b){d=b}),d}}],viewConfig:{enableTextSelection:!0,stripeRows:!0}}),this.panel},EnergyScanGrid.prototype.load=function(a){this.store.loadData(a)},SampleChangerWidget.prototype.blink=function(){$("#"+this.id).fadeIn().fadeOut().fadeIn();for(var a=this.getAllPucks(),b=0;b<a.length;b++)a[b].blink()},SampleChangerWidget.prototype.createPucks=function(a,b,c,d,e,f){var g=d*Math.sin(Math.PI/this.data.cells*e);this.pucks[a]=[];for(var h=0;Math.abs(h)<b;h+=this.clockwise){var i=2*h*Math.PI/b,j=this.getPuckIndexFromAngle(this.initAlpha,1,this.initAlpha+this.clockwise*(2*Math.PI*(1-1/this.data.cells)),this.data.cells,c+i),k=this.id+"-"+j+"-1";f&&(k=this.id+"-"+j+"-3");var l=d*Math.sin(c+i)+this.data.radius-g,m=-d*Math.cos(c+i)+this.data.radius-g;this.pucks[a].push(new PuckWidgetContainer({puckType:a,id:k,mainRadius:g,xMargin:l,yMargin:m,isLoading:this.isLoading})),f&&null!=f.dAlpha&&null!=f.dist&&(l=f.dist*Math.sin(c+i+f.dAlpha)+this.data.radius-g,m=-f.dist*Math.cos(c+i+f.dAlpha)+this.data.radius-g,this.pucks[a].push(new PuckWidgetContainer({puckType:a,id:this.id+"-"+j+"-2",mainRadius:g,xMargin:l,yMargin:m,isLoading:this.isLoading})),l=f.dist*Math.sin(c+i-f.dAlpha)+this.data.radius-g,m=-f.dist*Math.cos(c+i-f.dAlpha)+this.data.radius-g,this.pucks[a].push(new PuckWidgetContainer({puckType:a,id:this.id+"-"+j+"-1",mainRadius:g,xMargin:l,yMargin:m,isLoading:this.isLoading})))}},SampleChangerWidget.prototype.getPuckIndexFromAngle=function(a,b,c,d,e){return Math.round((d-b)*(e-a)/(c-a)+b)},SampleChangerWidget.prototype.getPanel=function(){this.panel=Ext.create("Ext.panel.Panel",{layout:"absolute",items:[{html:this.getStructure(this.data),frame:!1,border:!1,bodyStyle:"background:transparent;"}]});for(puckType in this.pucks)for(a in this.pucks[puckType]){var a=this.pucks[puckType][a];this.panel.add(a.getPanel())}return this.panel},SampleChangerWidget.prototype.loadSamples=function(a,b){var c={},d=[];for(sampleIndex in a){var e=a[sampleIndex],f=b[e.Container_containerId];c[f]?c[f].push(e):c[f]=[e]}for(puckIndex in _.keys(c)){var g=this.findPuckById(_.keys(c)[puckIndex]);if(c[g.id].length<=g.capacity)for(var h=c[g.id][0].Dewar_dewarId,i=0;i<c[g.id].length;i++){var e=c[g.id][i];Number(e.BLSample_location)>g.capacity&&(e.hasError=!0,d=_.union(d,[g]),$("#"+g.id).addClass("puck-error")),e.Dewar_dewarId!=h&&(d=_.union(d,[g]),$("#"+g.id).addClass("puck-error")),""==e.BLSample_location&&(e.hasError=!0,d=_.union(d,[g]),$("#"+g.id).addClass("puck-error"))}else g.containerId=c[g.id][0].Container_containerId,d.push(g),$("#"+g.id).addClass("puck-error");g.loadSamples(c[g.id])}return d},SampleChangerWidget.prototype.load=function(a){for(i in _.keys(a)){var b=_.keys(a)[i].substring(_.keys(a)[i].indexOf("-")+1),c=this.findPuckById(this.id+"-"+b);c.load(a[_.keys(a)[i]].cells)}},SampleChangerWidget.prototype.getStructure=function(a){var b="";return dust.render("structure.sampleChanger.template",a,function(a,c){b=c}),b},SampleChangerWidget.prototype.findPuckById=function(a){var b=this.getAllPucks();return _.find(b,function(b){return b.puckWidget.id==a}).puckWidget},SampleChangerWidget.prototype.getAllPucks=function(){var a=[];for(puckType in this.pucks)a=a.concat(this.pucks[puckType]);return a},SampleChangerWidget.prototype.getAllFilledPucks=function(){var a=this.getAllPucks();return _.filter(a,function(a){return!a.puckWidget.isEmpty})},SampleChangerWidget.prototype.render=function(){var a=this.getAllPucks();for(b in a){var b=a[b].puckWidget;for(cell in b.data.cells)b.render(b.data.cells[cell].location)}},SampleChangerWidget.prototype.setClickListeners=function(){var a=this,b=this.getAllPucks();for(puckIndex in b){var c=b[puckIndex];$("#"+c.puckWidget.id).css("cursor","pointer"),$("#"+c.puckWidget.id).unbind("click").click(function(b){b.target.classList.contains("puck-disabled")||a.onPuckSelected.notify(a.findPuckById(b.target.id))})}},SampleChangerWidget.prototype.disablePucksOfDifferentCapacity=function(a){var b=this.getAllPucks();for(puckIndex in b){var c=b[puckIndex];c.capacity!=a&&($("#"+c.puckWidget.id).addClass("puck-disabled"),c.puckWidget.disableAllCells())}},SampleChangerWidget.prototype.disablePuck=function(a){$("#"+a.id).addClass("puck-disabled"),a.disableAllCells()},SampleChangerWidget.prototype.enableAllPucks=function(){var a=this.getAllPucks();for(puckIndex in a){var b=a[puckIndex];$("#"+b.puckWidget.id).removeClass("puck-disabled"),b.puckWidget.allowAllCells()}},SampleChangerWidget.prototype.enablePuck=function(a){$("#"+a.id).removeClass("puck-disabled"),a.allowAllCells()},SampleChangerWidget.prototype.removeClassToAllPucks=function(a){var b=this.getAllPucks();for(puckIndex in b){var c=b[puckIndex];$("#"+c.puckWidget.id).removeClass(a),c.puckWidget.allowAllCells()}},SampleChangerWidget.prototype.getPuckData=function(){var a=this.getAllFilledPucks(),b={};for(puckContainerIndex in a){var c=a[puckContainerIndex],d=c.puckWidget.id;c.puckWidget.sampleChangerLocation=this.convertIdToSampleChangerLocation(d),c.puckWidget.data.sampleChangerLocation=this.convertIdToSampleChangerLocation(d),b[d]=c.puckWidget.data}return b},SampleChangerWidget.prototype.emptyAllPucks=function(){var a=this.getAllFilledPucks();for(puckIndex in a){var b=a[puckIndex];b.puckWidget.emptyAll()}},FlexHCDWidget.prototype.blink=SampleChangerWidget.prototype.blink,FlexHCDWidget.prototype.getPuckIndexFromAngle=SampleChangerWidget.prototype.getPuckIndexFromAngle,FlexHCDWidget.prototype.createPucks=SampleChangerWidget.prototype.createPucks,FlexHCDWidget.prototype.getPanel=SampleChangerWidget.prototype.getPanel,FlexHCDWidget.prototype.load=SampleChangerWidget.prototype.load,FlexHCDWidget.prototype.getStructure=SampleChangerWidget.prototype.getStructure,FlexHCDWidget.prototype.findPuckById=SampleChangerWidget.prototype.findPuckById,FlexHCDWidget.prototype.getAllPucks=SampleChangerWidget.prototype.getAllPucks,FlexHCDWidget.prototype.render=SampleChangerWidget.prototype.render,FlexHCDWidget.prototype.setClickListeners=SampleChangerWidget.prototype.setClickListeners,FlexHCDWidget.prototype.disablePucksOfDifferentCapacity=SampleChangerWidget.prototype.disablePucksOfDifferentCapacity,FlexHCDWidget.prototype.allowAllPucks=SampleChangerWidget.prototype.allowAllPucks,FlexHCDWidget.prototype.getPuckData=SampleChangerWidget.prototype.getPuckData,FlexHCDWidget.prototype.getAllFilledPucks=SampleChangerWidget.prototype.getAllFilledPucks,FlexHCDWidget.prototype.loadSamples=SampleChangerWidget.prototype.loadSamples,FlexHCDWidget.prototype.emptyAllPucks=SampleChangerWidget.prototype.emptyAllPucks,FlexHCDWidget.prototype.enableAllPucks=SampleChangerWidget.prototype.enableAllPucks,FlexHCDWidget.prototype.disablePuck=SampleChangerWidget.prototype.disablePuck,FlexHCDWidget.prototype.enablePuck=SampleChangerWidget.prototype.enablePuck,FlexHCDWidget.prototype.removeClassToAllPucks=SampleChangerWidget.prototype.removeClassToAllPucks,FlexHCDWidget.prototype.createStructure=function(){for(var a=0;a<this.data.cells/2;a++){var b=2*a*Math.PI/this.data.cells,c={x1:this.data.radius*Math.sin(b)+this.data.radius,y1:this.data.radius*Math.cos(b)+this.data.radius,x2:-this.data.radius*Math.sin(b)+this.data.radius,y2:-this.data.radius*Math.cos(b)+this.data.radius};this.data.lines.push(c)}for(var d=.31*this.data.radius,e=.94*this.data.radius,f=Math.PI/16,g=1,h=Math.round(8*(this.data.radius-100)/100+7),a=0;a<this.data.cells;a++){var b=2*a*Math.PI/this.data.cells;this.data.text.push({text:g,x:e*Math.sin(this.initAlpha+b-f)+this.data.radius,y:-e*Math.cos(this.initAlpha+b-f)+this.data.radius,textSize:h}),g++,this.data.text.push({text:g,x:e*Math.sin(this.initAlpha+b+f)+this.data.radius,y:-e*Math.cos(this.initAlpha+b+f)+this.data.radius,textSize:h}),g++,this.data.text.push({text:g,x:d*Math.sin(this.initAlpha+b)+this.data.radius,y:-d*Math.cos(this.initAlpha+b)+this.data.radius,textSize:h}),g++}},FlexHCDWidget.prototype.convertIdToSampleChangerLocation=function(a){var b=Number(a.split("-")[1]),c=Number(a.split("-")[2]);return 3*(b-1)+c},FlexHCDWidget.prototype.convertSampleChangerLocationToId=function(a){if(24>=a&&a>0){var b=Math.floor(a/3)+1,c=a%3;return 0==c&&(b--,c=3),this.id+"-"+b+"-"+c}return null},PuckLegend.prototype.getPanel=function(){var a="";return dust.render("puck.legend.template",this.data,function(b,c){
a=c}),{html:a,width:this.width,height:this.height}},PuckWidget.prototype.addCirclePathCells=function(a,b,c,d){for(var e=Math.min(d*Math.sin(Math.PI/b*c),(a.mainRadius-d)*c),f=0;b>f;f++){var g=2*f*Math.PI/b,h={x:-d*Math.sin(g)+a.mainRadius,y:-d*Math.cos(g)+a.mainRadius,color:"#FFFFFF",radius:e,id:this.id+"-"+Number(a.cells.length+1),state:"EMPTY",location:Number(a.cells.length+1),selected:!1,dataCollectionIds:a.dataCollectionIds[Number(a.cells.length+1)]};a.cells.push(h)}return a},PuckWidget.prototype.getPanel=function(){var a="";return dust.render("puck.template",this.data,function(b,c){a=c}),{html:a,width:2*this.data.mainRadius+1,height:2*this.data.mainRadius+1}},PuckWidget.prototype.emptyAll=function(){for(cellIndex in this.data.cells)this.data.cells[cellIndex].state="EMPTY",this.render(this.data.cells[cellIndex].location,!0);this.isEmpty=!0,this.containerId=0,$("#"+this.id).removeClass("puck-error")},PuckWidget.prototype.loadSamples=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d],f=this.dataCollectionIds[e.BLSample_location],g="FILLED";(null!=f&&f.length>0||null!=e.DataCollectionGroup_dataCollectionGroupId)&&(g="COLLECTED");var h=!1;null!=b&&(h=e.BLSample_location==b),""==e.BLSample_location&&(e.hasError=!0),c.push({location:e.BLSample_location,state:g,selected:h,sample_name:e.BLSample_name,protein_acronym:e.Protein_acronym,protein_name:e.Protein_name,dataCollectionIds:f,containerId:e.Container_containerId,containerCode:e.Container_code,hasError:e.hasError})}this.load(c)},PuckWidget.prototype.load=function(a){var b=this;$("#"+b.data.id+"-loading-text").remove();for(sampleIndex in a){var c=a[sampleIndex];if(c.hasError)this.containerId=c.containerId,this.containerCode=c.containerCode,this.data.containerId=this.containerId,this.data.containerCode=this.containerCode,this.isEmpty=!1;else{var d=this.id+"-"+c.location,e=this.findCellIndexById(d);this.data.cells[e].state=c.state,this.data.cells[e].selected=c.selected,this.data.cells[e].sample_name=c.sample_name,this.data.cells[e].protein_acronym=c.protein_acronym,this.data.cells[e].protein_name=c.protein_name,this.data.cells[e].containerId=c.containerId,this.data.cells[e].containerCode=c.containerCode,"EMPTY"!=c.state&&(this.containerId=c.containerId,this.containerCode=c.containerCode,this.data.containerId=this.containerId,this.data.containerCode=this.containerCode,this.isEmpty=!1)}}for(i in this.data.cells){var f=this.id+"-"+Number(Number(i)+1);this.enableMouseOver&&($("#"+f).unbind("mouseover").mouseover(function(a){var c=b.findCellIndexById(a.target.id);if(b.onMouseOver.notify(a.target.id.split("-")[1]),b.focusWell(a.target.id.split("-")[1],!0),b.data.cells[c].protein_acronym){var d=[{key:"Protein acronym",value:b.data.cells[c].protein_acronym}];b.data.cells[c].sample_name&&d.push({key:"Sample",value:b.data.cells[c].sample_name});var e="";dust.render("tooltip.template",d,function(a,b){e=b}),$("body").append(e),$("#hoveringTooltipDiv").css({top:$(this).offset().top-3*b.data.cells[c].radius,left:$(this).offset().left+1.5*b.data.cells[c].radius}),b.data.cells[c].y-b.data.mainRadius<0&&$("#hoveringTooltipDiv").css({top:$(this).offset().top+2*b.data.cells[c].radius,left:$(this).offset().left+b.data.cells[c].radius})}}),$("#"+f).unbind("mouseout").mouseout(function(a){b.onMouseOut.notify(),b.focusWell(a.target.id.split("-")[1],!1),$("#hoveringTooltipDiv").remove()})),this.enableClick&&$("#"+f).unbind("click").click(function(a){var c=b.findCellIndexById(a.target.id);b.render(b.data.cells[c].location,!0),$("#hoveringTooltipDiv").remove()}),this.render(this.data.cells[i].location,!0)}},PuckWidget.prototype.focus=function(a){a?$("#"+this.id).addClass("puck-selected"):$("#"+this.id).removeClass("puck-selected")},PuckWidget.prototype.focusWell=function(a,b){b?($("#"+this.id+"-"+a).attr("class","cell_focus"),$("#"+this.id+"-"+a+"-inner").attr("class","cell_inner_hidden")):this.render(a,!0)},PuckWidget.prototype.render=function(a){var b=this.findCellIndexById(this.id+"-"+a);switch(this.data.cells[b].state){case"FILLED":$("#"+this.id+"-"+a).attr("class","cell_filled"),$("#"+this.id+"-"+a+"-label").attr("fill","white"),$("#"+this.id+"-"+a+"-inner").attr("class","cell_inner_filled");break;case"COLLECTED":$("#"+this.id+"-"+a).attr("class","cell_collected"),$("#"+this.id+"-"+a+"-label").attr("fill","white"),$("#"+this.id+"-"+a+"-inner").attr("class","cell_inner_filled");break;case"RESULTS":$("#"+this.id+"-"+a).attr("class","cell_results"),$("#"+this.id+"-"+a+"-label").attr("fill","white"),$("#"+this.id+"-"+a+"-inner").attr("class","cell_inner_filled");break;case"ERROR":$("#"+this.id+"-"+a).attr("class","cell_error"),$("#"+this.id+"-"+a+"-inner").attr("class","cell_inner_filled"),$("#"+this.id+"-"+a+"-label").attr("fill","white");break;case"EMPTY":$("#"+this.id+"-"+a).attr("class","cell_empty"),$("#"+this.id+"-"+a+"-inner").attr("class","cell_inner_hidden"),$("#"+this.id+"-"+a+"-label").attr("fill","black")}this.data.cells[b].selected&&$("#"+this.id+"-"+a+"-inner").addClass("cell_selected")},PuckWidget.prototype.findCellIndexById=function(a){for(cellIndex in this.data.cells)if(this.data.cells[cellIndex].id==a)return cellIndex},PuckWidget.prototype.disableAllCells=function(){for(var a=0;a<this.data.cells.length;a++){var b=this.data.cells[a];$("#"+b.id).addClass("cell-disabled")}},PuckWidget.prototype.allowAllCells=function(){for(var a=0;a<this.data.cells.length;a++){var b=this.data.cells[a];$("#"+b.id).removeClass("cell-disabled")}},PuckWidget.prototype.blink=function(){$("#"+this.id+"-div").fadeIn().fadeOut().fadeIn()},PuckWidgetContainer.prototype.getPanel=function(){var a=this;return this.panel=Ext.create("Ext.panel.Panel",{id:this.puckWidget.id+"-container",x:this.xMargin,y:this.yMargin,width:2*this.puckWidget.data.mainRadius+1,height:2*this.puckWidget.data.mainRadius+1,frame:!1,border:!1,bodyStyle:"background:transparent;",items:[this.puckWidget.getPanel()]}),this.panel.on("boxready",function(){a.enableMainClick&&$("#"+this.id).unbind("click").click(function(b){a.onClick.notify(b.target.id)}),a.enableMainMouseOver&&($("#"+this.id).unbind("mouseover").mouseover(function(b){a.onMouseOver.notify(a.puckWidget)}),$("#"+this.id).unbind("mouseout").mouseout(function(b){a.onMouseOut.notify(a.puckWidget)}))}),this.panel},PuckWidgetContainer.prototype.load=function(a){this.puckWidget.load(a)},PuckWidgetContainer.prototype.loadSamples=function(a){a&&a.length>0&&(this.containerId=a[0].Container_containerId,this.puckWidget.loadSamples(a))},PuckWidgetContainer.prototype.focus=function(a,b){this.puckWidget.focus(a,b)},PuckWidgetContainer.prototype.blink=function(){this.puckWidget.blink()},RoboDiffWidget.prototype.blink=SampleChangerWidget.prototype.blink,RoboDiffWidget.prototype.getPuckIndexFromAngle=SampleChangerWidget.prototype.getPuckIndexFromAngle,RoboDiffWidget.prototype.createPucks=SampleChangerWidget.prototype.createPucks,RoboDiffWidget.prototype.getPanel=SampleChangerWidget.prototype.getPanel,RoboDiffWidget.prototype.load=SampleChangerWidget.prototype.load,RoboDiffWidget.prototype.getStructure=SampleChangerWidget.prototype.getStructure,RoboDiffWidget.prototype.findPuckById=SampleChangerWidget.prototype.findPuckById,RoboDiffWidget.prototype.getAllPucks=SampleChangerWidget.prototype.getAllPucks,RoboDiffWidget.prototype.render=SampleChangerWidget.prototype.render,RoboDiffWidget.prototype.setClickListeners=SampleChangerWidget.prototype.setClickListeners,RoboDiffWidget.prototype.disablePucksOfDifferentCapacity=SampleChangerWidget.prototype.disablePucksOfDifferentCapacity,RoboDiffWidget.prototype.allowAllPucks=SampleChangerWidget.prototype.allowAllPucks,RoboDiffWidget.prototype.getPuckData=SampleChangerWidget.prototype.getPuckData,RoboDiffWidget.prototype.getAllFilledPucks=SampleChangerWidget.prototype.getAllFilledPucks,RoboDiffWidget.prototype.loadSamples=SampleChangerWidget.prototype.loadSamples,RoboDiffWidget.prototype.emptyAllPucks=SampleChangerWidget.prototype.emptyAllPucks,RoboDiffWidget.prototype.enableAllPucks=SampleChangerWidget.prototype.enableAllPucks,RoboDiffWidget.prototype.disablePuck=SampleChangerWidget.prototype.disablePuck,RoboDiffWidget.prototype.enablePuck=SampleChangerWidget.prototype.enablePuck,RoboDiffWidget.prototype.removeClassToAllPucks=SampleChangerWidget.prototype.removeClassToAllPucks,RoboDiffWidget.prototype.createStructure=function(){for(var a=0;a<this.data.cells/2;a++){var b=2*a*Math.PI/this.data.cells,c={x1:this.data.radius*Math.sin(b)+this.data.radius,y1:this.data.radius*Math.cos(b)+this.data.radius,x2:-this.data.radius*Math.sin(b)+this.data.radius,y2:-this.data.radius*Math.cos(b)+this.data.radius};this.data.lines.push(c)}for(var d=.31*this.data.radius,e=.94*this.data.radius,f=Math.PI/16,g=1,h=Math.round(8*(this.data.radius-100)/100+7),a=0;a<this.data.cells;a++){var b=2*a*Math.PI/this.data.cells;this.data.text.push({text:g,x:e*Math.sin(this.initAlpha+b-f)+this.data.radius,y:-e*Math.cos(this.initAlpha+b-f)+this.data.radius,textSize:h}),g++,this.data.text.push({text:g,x:e*Math.sin(this.initAlpha+b+f)+this.data.radius,y:-e*Math.cos(this.initAlpha+b+f)+this.data.radius,textSize:h}),g++,this.data.text.push({text:g,x:d*Math.sin(this.initAlpha+b)+this.data.radius,y:-d*Math.cos(this.initAlpha+b)+this.data.radius,textSize:h}),g++}},RoboDiffWidget.prototype.convertIdToSampleChangerLocation=function(a){var b=Number(a.split("-")[1]),c=Number(a.split("-")[2]);return 3*(b-1)+c},RoboDiffWidget.prototype.convertSampleChangerLocationToId=function(a){if(24>=a&&a>0){var b=Math.floor(a/3)+1,c=a%3;return 0==c&&(b--,c=3),this.id+"-"+b+"-"+c}return null},SampleChangerSelector.prototype.getPanel=function(){return this.sampleChangerPanel=Ext.create("Ext.panel.Panel",{layout:{type:"hbox",pack:"center"},width:410,height:410,margin:50,items:[]}),this.panel=Ext.create("Ext.panel.Panel",{layout:{type:"hbox",pack:"left"},height:this.height,width:this.width,title:"Select a sample changer type or a beamline",items:[{xtype:"container",layout:"vbox",cls:"border-grid",margin:20,items:[this.beamlinesGrid.getPanel()]},this.sampleChangerPanel]}),this.panel},SampleChangerSelector.prototype.createSampleChanger=function(a){var b={radius:200,isLoading:!1},c=new FlexHCDWidget(b);return"SC3"==a?c=new SC3Widget(b):"RoboDiff"==a&&(c=new RoboDiffWidget(b)),c.render(),c},SampleChangerSelector.prototype.addSampleChanger=function(a){this.sampleChangerPanel.removeAll(),this.sampleChangerPanel.add(a.getPanel()),this.onSampleChangerSelected.notify(a.name)},SampleChangerSelector.prototype.selectRowByBeamlineName=function(a){var b=_.filter(this.beamlines,{name:a})[0].sampleChangerType;this.beamlinesGrid.selectRowByValue(a+" ("+b+")")},SC3Widget.prototype.blink=SampleChangerWidget.prototype.blink,SC3Widget.prototype.getPuckIndexFromAngle=SampleChangerWidget.prototype.getPuckIndexFromAngle,SC3Widget.prototype.createPucks=SampleChangerWidget.prototype.createPucks,SC3Widget.prototype.getPanel=SampleChangerWidget.prototype.getPanel,SC3Widget.prototype.load=SampleChangerWidget.prototype.load,SC3Widget.prototype.getStructure=SampleChangerWidget.prototype.getStructure,SC3Widget.prototype.findPuckById=SampleChangerWidget.prototype.findPuckById,SC3Widget.prototype.getAllPucks=SampleChangerWidget.prototype.getAllPucks,SC3Widget.prototype.render=SampleChangerWidget.prototype.render,SC3Widget.prototype.setClickListeners=SampleChangerWidget.prototype.setClickListeners,SC3Widget.prototype.disablePucksOfDifferentCapacity=SampleChangerWidget.prototype.disablePucksOfDifferentCapacity,SC3Widget.prototype.allowAllPucks=SampleChangerWidget.prototype.allowAllPucks,SC3Widget.prototype.getPuckData=SampleChangerWidget.prototype.getPuckData,SC3Widget.prototype.getAllFilledPucks=SampleChangerWidget.prototype.getAllFilledPucks,SC3Widget.prototype.loadSamples=SampleChangerWidget.prototype.loadSamples,SC3Widget.prototype.emptyAllPucks=SampleChangerWidget.prototype.emptyAllPucks,SC3Widget.prototype.enableAllPucks=SampleChangerWidget.prototype.enableAllPucks,SC3Widget.prototype.disablePuck=SampleChangerWidget.prototype.disablePuck,SC3Widget.prototype.enablePuck=SampleChangerWidget.prototype.enablePuck,SC3Widget.prototype.removeClassToAllPucks=SampleChangerWidget.prototype.removeClassToAllPucks,SC3Widget.prototype.createStructure=function(){for(var a=.9*this.data.radius,b=0;b<this.data.cells;b++){var c=2*b*Math.PI/this.data.cells,d={text:b+1,x:-a*Math.sin(c)+this.data.radius,y:-a*Math.cos(c)+this.data.radius};this.data.text.push(d)}},SC3Widget.prototype.convertIdToSampleChangerLocation=function(a){return Number(a.split("-")[1])},SC3Widget.prototype.convertSampleChangerLocationToId=function(a){return 5>=a&&a>0?this.id+"-"+a+"-1":null},SpinePuckWidget.prototype.getPanel=PuckWidget.prototype.getPanel,SpinePuckWidget.prototype.load=PuckWidget.prototype.load,SpinePuckWidget.prototype.addCirclePathCells=PuckWidget.prototype.addCirclePathCells,SpinePuckWidget.prototype.focus=PuckWidget.prototype.focus,SpinePuckWidget.prototype.focusWell=PuckWidget.prototype.focusWell,SpinePuckWidget.prototype.render=PuckWidget.prototype.render,SpinePuckWidget.prototype.findCellIndexById=PuckWidget.prototype.findCellIndexById,SpinePuckWidget.prototype.loadSamples=PuckWidget.prototype.loadSamples,SpinePuckWidget.prototype.emptyAll=PuckWidget.prototype.emptyAll,SpinePuckWidget.prototype.disableAllCells=PuckWidget.prototype.disableAllCells,SpinePuckWidget.prototype.allowAllCells=PuckWidget.prototype.allowAllCells,SpinePuckWidget.prototype.blink=PuckWidget.prototype.blink,SpinePuckWidget.prototype.parseData=function(a){var b=10,c=.8,d=3*a.mainRadius/4;return a=this.addCirclePathCells(a,b,c,d)},UniPuckWidget.prototype.getPanel=PuckWidget.prototype.getPanel,UniPuckWidget.prototype.load=PuckWidget.prototype.load,UniPuckWidget.prototype.addCirclePathCells=PuckWidget.prototype.addCirclePathCells,UniPuckWidget.prototype.focus=PuckWidget.prototype.focus,UniPuckWidget.prototype.focusWell=PuckWidget.prototype.focusWell,UniPuckWidget.prototype.render=PuckWidget.prototype.render,UniPuckWidget.prototype.findCellIndexById=PuckWidget.prototype.findCellIndexById,UniPuckWidget.prototype.loadSamples=PuckWidget.prototype.loadSamples,UniPuckWidget.prototype.emptyAll=PuckWidget.prototype.emptyAll,UniPuckWidget.prototype.disableAllCells=PuckWidget.prototype.disableAllCells,UniPuckWidget.prototype.allowAllCells=PuckWidget.prototype.allowAllCells,UniPuckWidget.prototype.blink=PuckWidget.prototype.blink,UniPuckWidget.prototype.parseData=function(a){var b=5,c=.8,d=4*a.mainRadius/11;return a=this.addCirclePathCells(a,b,c,d),b=11,c=.8,d=3*a.mainRadius/4,a=this.addCirclePathCells(a,b,c,d)},XFEScanGrid.prototype.getPanel=function(a){var b=this;return this.store=Ext.create("Ext.data.Store",{fields:["dataCollectionGroup"]}),this.panel=Ext.create("Ext.grid.Panel",{cls:"borderGrid",height:800,store:this.store,disableSelection:!0,columns:this.getColumns(),viewConfig:{enableTextSelection:!0,stripeRows:!0},listeners:{boxready:function(a,c){for(var d in b.plots)new Dygraph(document.getElementById(b.plots[d].containerId),b.plots[d].url,{legend:"never",title:"",height:150,width:400,stackedGraph:!0,labelsDiv:document.getElementById(b.plots[d].labelsContainerId),labelsSeparateLines:!0,labelsDivWidth:100,labelsShowZeroValues:!1,highlightCircleSize:2,strokeWidth:1,strokeBorderWidth:1,highlightSeriesOpts:{strokeWidth:3,strokeBorderWidth:1,highlightCircleSize:5},ylabel:"Count"})}}}),this.panel},XFEScanGrid.prototype._getHTMLZoomImage=function(a,b,c){return'<img style="width:400px;height:100;"  data-src='+a+" src="+a+">"},XFEScanGrid.prototype.getColumns=function(){var a=this,b=[{header:"Experiment Parameters",dataIndex:"dataCollectionGroup",name:"dataCollectionGroup",flex:1,renderer:function(b,c,d){var e=a.id+d.data.xfeFluorescenceSpectrumId;a.plots[d.data.xfeFluorescenceSpectrumId]={containerId:e,labelsContainerId:e+"labels",url:EXI.getDataAdapter().mx.xfescan.getCSV(d.data.xfeFluorescenceSpectrumId)};var f="";return d.data.xfeFluorescenceSpectrumId=d.data.xfeFluorescenceSpectrumId,d.data.containerId=e,dust.render("xfescangrid.template",d.data,function(a,b){f=b}),f}},{header:"",dataIndex:"dataCollectionGroup",name:"dataCollectionGroup",hidden:!0,flex:2,renderer:function(b,c,d){return a._getHTMLZoomImage(EXI.getDataAdapter().mx.xfescan.getXFEJpegByScanId(d.data.xfeFluorescenceSpectrumId))}}];return b},XFEScanGrid.prototype.load=function(a){this.store.loadData(a)},TestController.prototype.loadNavigationPanel=ExiController.prototype.loadNavigationPanel,TestController.prototype.setPageBackground=function(){},TestController.prototype.notFound=function(){},TestController.prototype.init=function(){var a,b=this;Path.map("#/test/test1").to(function(){EXI.clearNavigationPanel(),EXI.hideNavigationPanel();var a=new TestListView;EXI.addNavigationPanel(a),EXI.setLoadingNavigationPanel("Loading my data"),a.load([{name:"Lisa",email:"lisa@simpsons.com",phone:"555-111-1224"},{name:"Bart",email:"bart@simpsons.com",phone:"555-222-1234"},{name:"Homer",email:"homer@simpsons.com",phone:"555-222-1244"},{name:"Marge",email:"marge@simpsons.com",phone:"555-222-1254"}]),EXI.setLoadingNavigationPanel(!1)}).enter(this.setPageBackground),Path.map("#/test/test2").to(function(){EXI.clearNavigationPanel(),EXI.clearMainPanel(),EXI.setLoadingNavigationPanel(!0),a=new TestListView,a.onSelect.attach(function(a,b){location.hash="/test/test3/"+b[0].BLSample_crystalId+"/main"}),EXI.addNavigationPanel(a),adapter=b.loadNavigationPanel(a),adapter.mx.sample.getSampleInfoByProposalId()}).enter(this.setPageBackground),Path.map("#/test/test3/:crystalId/main").to(function(){var a=new TestMainView(this.params.crystalId);EXI.addMainPanel(a),console.log(this.params.crystalId),a.load(this.params.crystalId)}).enter(this.setPageBackground),Path.map("#/test/test4").to(function(){EXI.clearNavigationPanel();var a=new PuckWidgetView;EXI.addMainPanel(a);var b=function(b,c){a.load(c)};EXI.getDataAdapter({onSuccess:b}).proposal.shipping.getContainerById(333486,333486,333486)}).enter(this.setPageBackground),Path.rescue(this.notFound)},SampleForm.prototype.load=function(a){this.sample=a,null!=a&&Ext.getCmp("sampleName"+this.id).setValue(a.sampleName)},SampleForm.prototype.getSamplePanel=function(){return this.samplePanel=Ext.create("Ext.panel.Panel",{layout:"vbox",margin:"10",items:[{padding:10,xtype:"container",layout:"hbox",border:!1,items:[{xtype:"displayfield",id:"sampleName"+this.id,fieldLabel:"Sample Name",name:"sampleName"}]}]}),this.samplePanel},SampleForm.prototype.getPanel=function(){return this.panel=Ext.create("Ext.panel.Panel",{layout:"vbox",title:"Sample Card",cls:"border-grid",items:[this.getSamplePanel()]}),this.panel},TestContainer.prototype.getPanel=function(){return this.container},TestContainer.prototype.add=function(a){this.container.add(a)},TestListView.prototype.getPanel=ListView.prototype.getPanel,TestListView.prototype.load=ListView.prototype.load,TestListView.prototype.getFields=ListView.prototype.getFields,TestListView.prototype.getColumns=ListView.prototype.getColumns,TestListView.prototype.getRow=function(a){var b="";return dust.render("test.template",a.data,function(a,c){b=c}),b},TestListView.prototype.getFilter=function(a){return[{property:"sampleName",value:a,anyMatch:!0}]},TestMainPanel.prototype.getPanel=ListView.prototype.getPanel,TestMainPanel.prototype.load=ListView.prototype.load,TestMainPanel.prototype.getFields=ListView.prototype.getFields,TestMainPanel.prototype.getColumns=ListView.prototype.getColumns,TestMainPanel.prototype.getRow=function(a){var b="";return dust.render("test.template.main",a.data,function(a,c){b=c}),b},TestMainPanel.prototype.getFilter=function(a){return[{property:"sampleName",value:a,anyMatch:!0}]},TestMainWidgetPanel.prototype.getPanel=ListView.prototype.getPanel,TestMainWidgetPanel.prototype.load=ListView.prototype.load,TestMainWidgetPanel.prototype.getFields=ListView.prototype.getFields,TestMainWidgetPanel.prototype.getColumns=ListView.prototype.getColumns,TestMainWidgetPanel.prototype.getRow=function(a){var b="1";return b},TestMainWidgetPanel.prototype.getFilter=function(a){return[{property:"sampleName",value:a,anyMatch:!0}]},ElectronDensityViewer.prototype.getPanel=function(){var a=this;return this.panel=Ext.create("Ext.panel.Panel",{buttons:this.getToolBar(),items:[{html:'<div id="'+this.id+'" height="600px"></div>',height:800}]}),this.panel.on("boxready",function(){a.load()}),this.panel},ElectronDensityViewer.prototype.load=function(){var a=this,b="";dust.render("electron.density.viewer.template",a.sample,function(a,c){b+=c}),$(document.body).html(b),init_gui(),this.XV=new XtalViewer("Viewer",null,!0,!0),draw_selection_console(this.XV),this.XV.animate(),getQuery(this.XV)||(this.XV.load_pdb("data/1mru.pdb","1mru"),this.XV.load_dsn6_map("data/1mru.omap","2mFo-Dfc",0),this.XV.animate()),this.XV.enable_leap_motion()},ElectronDensityViewer.prototype.getToolBar=function(){var a=this;return[{xtype:"button",text:"Debugger",handler:function(){a.XV}}]},PuckWidgetView.prototype.getPanel=function(){var a=this;return this.store=Ext.create("Ext.data.Store",{storeId:"samplePanelId",fields:["acronym","state","code","type","name","location","holder","looptype"],data:[]}),this.grid=Ext.create("Ext.grid.Panel",{margin:20,title:"Samples",store:Ext.data.StoreManager.lookup("samplePanelId"),columns:[{text:"Crystal protein acronym",dataIndex:"acronym"},{text:"State",dataIndex:"state"},{text:"Code",dataIndex:"code"},{text:"Container type",dataIndex:"type"},{text:"Name",dataIndex:"name"},{text:"Location",dataIndex:"location"},{text:"Holder",dataIndex:"holder"},{text:"Looptype",dataIndex:"looptype"}],height:200,width:700,listeners:{itemmouseenter:function(b,c,d){a.widget.focus(c.data.location,!0)},itemmouseleave:function(b,c,d){a.widget.focus(c.data.location,!1)}}}),this.panel=Ext.create("Ext.panel.Panel",{layout:"hbox",items:[this.grid,this.widget.getPanel()]}),this.panel},PuckWidgetView.prototype.load=function(a){var b=this;b.panel.setTitle("Test Widget");var c=[],d=["Filled","Collected","Results","Collected"];for(sample in a.sampleVOs)c.push({acronym:a.sampleVOs[sample].crystalVO.proteinVO.acronym,code:a.code,type:a.containerType,name:a.sampleVOs[sample].crystalVO.proteinVO.name,location:a.sampleVOs[sample].location,holder:a.sampleVOs[sample].holderLength,looptype:a.sampleVOs[sample].loopType,state:d[sample]});this.store.loadData(c),this.widget.load(c)},TestMainView.prototype.getPanel=MainView.prototype.getPanel,TestMainView.prototype.getContainer=function(){return Ext.create("Ext.container.Container",{layout:{type:"hbox"},margin:15,border:1,defaults:{labelWidth:80,flex:1},items:[this.testMainPanel.getPanel([])]})},TestMainView.prototype.load=function(a){this.panel.setTitle("Sample");var b=this,c=function(a,c){b.testMainPanel.load(c)};EXI.getDataAdapter({onSuccess:c}).mx.sample.getSamplesByCrystalId(b.crystalId)},function(a){function b(a,b){return a.w('<div class="container-fluid" style="padding:10px;"><div class="form-group row"><label class="col-md-1"><b>Name:</b></label><div class="col-md-5"><input id="').f(b.get(["id"],!1),b,"h").w('-givenName" class="form-control" type="text" value="').f(b.getPath(!1,["personVO","givenName"]),b,"h").w('"></div><label class="col-md-1"><b>Surname:</b></label><div class="col-md-5"><input id="').f(b.get(["id"],!1),b,"h").w('-familyName" class="form-control" type="text" value="').f(b.getPath(!1,["personVO","familyName"]),b,"h").w('"></div></div><div class="form-group row"><label class="col-md-1"><b>Email:</b></label><div class="col-md-3"><input id="').f(b.get(["id"],!1),b,"h").w('-emailAddress" class="form-control" type="text" value="').f(b.getPath(!1,["personVO","emailAddress"]),b,"h").w('"></div><label class="col-md-1"><b>Phone:</b></label><div class="col-md-3"><input id="').f(b.get(["id"],!1),b,"h").w('-phoneNumber" class="form-control" type="text" value="').f(b.getPath(!1,["personVO","phoneNumber"]),b,"h").w('"></div><label class="col-md-1"><b>Fax:</b></label><div class="col-md-3"><input id="').f(b.get(["id"],!1),b,"h").w('-faxNumber" class="form-control" type="text" value="').f(b.getPath(!1,["personVO","faxNumber"]),b,"h").w('"></div></div><div class="form-group row"><label class="col-md-1"><b>Card Name:</b></label><div class="col-md-11"><input id="').f(b.get(["id"],!1),b,"h").w('-cardName" class="form-control" type="text" value="').f(b.get(["cardName"],!1),b,"h").w('"></div></div><div class="form-group row"><label class="col-md-1"><b>Courier Account:</b></label><div class="col-md-5"><input id="').f(b.get(["id"],!1),b,"h").w('-courierAccount" class="form-control" type="text" value="').f(b.get(["courierAccount"],!1),b,"h").w('"></div><label class="col-md-1"><b>Courier Company:</b></label><div class="col-md-5"><input id="').f(b.get(["id"],!1),b,"h").w('-defaultCourrierCompany" class="form-control" type="text" value="').f(b.get(["defaultCourrierCompany"],!1),b,"h").w('"></div></div><div class="form-group row"><label class="col-md-1"><b>Avg Customs Value:</b></label><div class="col-md-3"><input id="').f(b.get(["id"],!1),b,"h").w('-dewarAvgCustomsValue" class="form-control" type="text" value="').f(b.get(["dewarAvgCustomsValue"],!1),b,"h").w('"></div><label class="col-md-1"><b>Avg Transport Value:</b></label><div class="col-md-3"><input id="').f(b.get(["id"],!1),b,"h").w('-dewarAvgTransportValue" class="form-control" type="text" value="').f(b.get(["dewarAvgTransportValue"],!1),b,"h").w('"></div><label class="col-md-1"><b>Billing Reference:</b></label><div class="col-md-3"><input id="').f(b.get(["id"],!1),b,"h").w('-billingReference" class="form-control" type="text" value="').f(b.get(["billingReference"],!1),b,"h").w('"></div></div><div class="form-group row"><label class="col-md-1"><b>Lab Name:</b></label><div class="col-md-11"><input id="').f(b.get(["id"],!1),b,"h").w('-labName" class="form-control" type="text" value="').f(b.getPath(!1,["personVO","laboratoryVO","name"]),b,"h").w('"></div></div><div class="form-group row"><label class="col-md-1"><b>Lab Address:</b></label><div class="col-md-11"><textarea id="').f(b.get(["id"],!1),b,"h").w('-labAddress" class="form-control" rows="3">').f(b.getPath(!1,["personVO","laboratoryVO","address"]),b,"h").w("</textarea></div></div></div>")}return a.register("address.edit.form.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid" style="padding:10px;"><div class="form-group row" style="margin:0px"><label class="col-md-1"><b>Name:</b></label><label class="col-md-3" style="font-weight: normal">').f(b.getPath(!1,["personVO","givenName"]),b,"h").w('</label><label class="col-md-1"><b>Surname:</b></label><label class="col-md-3" style="font-weight: normal">').f(b.getPath(!1,["personVO","familyName"]),b,"h").w('</label></div><div class="form-group row" style="margin:0px"><label class="col-md-1"><b>Email:</b></label><label class="col-md-3" style="font-weight: normal">').f(b.getPath(!1,["personVO","emailAddress"]),b,"h").w('</label><label class="col-md-1"><b>Phone:</b></label><label class="col-md-3" style="font-weight: normal">').f(b.getPath(!1,["personVO","phoneNumber"]),b,"h").w('</label><label class="col-md-1"><b>Fax:</b></label><label class="col-md-3" style="font-weight: normal">').f(b.getPath(!1,["personVO","faxNumber"]),b,"h").w('</label></div><div class="form-group row" style="margin:0px"><label class="col-md-1"><b>Card Name:</b></label><label class="col-md-6" style="font-weight: normal">').f(b.get(["cardName"],!1),b,"h").w('</label></div><div class="form-group row" style="margin:0px"><label class="col-md-1"><b>Courier Account:</b></label><label class="col-md-3" style="font-weight: normal">').f(b.get(["courierAccount"],!1),b,"h").w('</label><label class="col-md-1"><b>Courier Company:</b></label><label class="col-md-3" style="font-weight: normal">').f(b.get(["defaultCourrierCompany"],!1),b,"h").w('</label></div><div class="form-group row" style="margin:0px"><label class="col-md-1"><b>Avg Customs Value:</b></label><label class="col-md-3" style="font-weight: normal">').f(b.get(["dewarAvgCustomsValue"],!1),b,"h").w('</label><label class="col-md-1"><b>Avg Transport Value:</b></label><label class="col-md-3" style="font-weight: normal">').f(b.get(["dewarAvgTransportValue"],!1),b,"h").w('</label></div><div class="form-group row" style="margin:0px"><label class="col-md-1"><b>Billing Reference:</b></label><label class="col-md-6" style="font-weight: normal">').f(b.get(["billingReference"],!1),b,"h").w('</label></div><div class="form-group row" style="margin:0px"><label class="col-md-1"><b>Lab Name:</b></label><label class="col-md-6" style="font-weight: normal">').f(b.getPath(!1,["personVO","laboratoryVO","name"]),b,"h").w('</label></div><div class="form-group row" style="margin:0px"><label class="col-md-1"><b>Lab Address:</b></label><textarea  class="col-md-3" style="overflow:hidden;" rows="3" disabled>').f(b.getPath(!1,["personVO","laboratoryVO","address"]),b,"h").w("</textarea ></div></div>")}return a.register("address.form.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table class='listView'><tr><td>cardName:</td><td style='color:#207a7a;font-weight:bold;'>").f(b.getPath(!0,["cardName"]),b,"h").w("</td></tr><tr><td>Familiy Name:</td><td>").f(b.getPath(!0,["personVO","familyName"]),b,"h").w("</td></tr><tr><td>Name:</td><td>").f(b.getPath(!0,["personVO","givenName"]),b,"h").w("</td></tr><tr><td>Email:</td><td>").f(b.getPath(!0,["personVO","emailAddress"]),b,"h").w("</td></tr></table>")}return a.register("address.listview",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div id='hoveringTooltipDiv' pointer-events='none' class='cell_info_tooltip'>").f(b.get(["text"],!1),b,"h").w("</div>")}return a.register("basic.tooltip.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container"><table class="table" id="bootstrap-table-').f(b.get(["id"],!1),b,"h").w('"><tbody>').s(b.get(["values"],!1),b,{block:c},{}).w("</tbody></table></div>")}function c(a,b){return a.w('<tr class="clickable-row" id="row-').f(b.get(["$idx"],!1),b,"h").w("-").f(b.get(["id"],!1),b,"h").w('"><td>').f(b.getPath(!0,[]),b,"h").w("</td></tr>")}return a.register("bootstrap.grid.template",b),b.__dustBody=!0,c.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container" padding="20px"><div class="row"><div class="col-xs-6 col-md-6"><button type="button" class="btn btn-default btn-sm"><span class="glyphicon glyphicon-remove"></span> Remove</button></div><div class="col-xs-6 col-md-6"><button type="button" class="btn btn-default btn-sm"><span class="glyphicon glyphicon-edit"></span> Edit</button></div></div></div>')}return a.register("buttons.puck.parcel.shipping.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid" style="padding:0;"><div class="row" style=\'font-size:').f(b.getPath(!0,["textSize"]),b,"h").w('px;\'><div class="col-md-6" style="padding-right:5px;"><a id="').f(b.get(["id"],!1),b,"h").w('-edit-button" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-edit"></span></a></div><div class="col-md-6" style="padding-left:5px;"><a id="').f(b.get(["id"],!1),b,"h").w('-remove-button" class="btn btn-danger btn-xs"><span class="glyphicon glyphicon-remove"></span></a></div></div></div>')}return a.register("container.parcel.buttons.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div id="').f(b.get(["id"],!1),b,"h").w('-div"><svg id="').f(b.get(["id"],!1),b,"h").w('-svg"  height="').h("math",b,{},{key:c,method:"multiply",operand:"2.2"},"h").w('" width="').h("math",b,{},{key:d,method:"multiply",operand:"2.2"},"h").w('"><rect id="').f(b.get(["id"],!1),b,"h").w('" x="0" y="0" rx="').f(b.get(["r"],!1),b,"h").w('" ry="').f(b.get(["r"],!1),b,"h").w('" width="').f(b.get(["width"],!1),b,"h").w('" height="').f(b.get(["height"],!1),b,"h").w('" class="container-widget" style="').x(b.get(["enableMainClick"],!1),b,{block:e},{}).w('"></svg></div>');
}function c(a,b){return a.f(b.get(["mainRadius"],!1),b,"h")}function d(a,b){return a.f(b.get(["mainRadius"],!1),b,"h")}function e(a,b){return a.w("cursor:pointer;")}return a.register("container.widget.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div style="padding:20px;" class="editCrystalFormDiv"><div class="form-group row"><label class="col-md-2 col-form-label">Name:</label><div class="col-md-10"><input id="').f(b.get(["id"],!1),b,"h").w('-name" class="form-control" type="text" value="').f(b.get(["name"],!1),b,"h").w('"></div></div><div class="form-group row"><label class="col-md-2 col-form-label">Space Group:</label><div class="col-md-10"><select id="').f(b.get(["id"],!1),b,"h").w('-space-group" class="form-control">').s(b.get(["spaceGroups"],!1),b,{block:c},{}).w('</select></div></div><div class="form-group row"><div id="').f(b.get(["id"],!1),b,"h").w('-cellsABC" class="col-md-6"><div class="form-group row"><label class="col-md-2 col-form-label">A:</label><div class="col-md-10"><input id="').f(b.get(["id"],!1),b,"h").w('-cellA" class="form-control" type="text" value="').f(b.get(["cellA"],!1),b,"h").w('"></div></div><div class="form-group row"><label class="col-md-2 col-form-label">B:</label><div class="col-md-10"><input id="').f(b.get(["id"],!1),b,"h").w('-cellB" class="form-control" type="text" value="').f(b.get(["cellB"],!1),b,"h").w('"></div></div><div class="form-group row"><label class="col-md-2 col-form-label">C:</label><div class="col-md-10"><input id="').f(b.get(["id"],!1),b,"h").w('-cellC" class="form-control" type="text" value="').f(b.get(["cellC"],!1),b,"h").w('"></div></div></div><div class="col-md-6"><div class="form-group row"><label class="col-md-2 col-form-label">&#945:</label><div class="col-md-10"><input id="').f(b.get(["id"],!1),b,"h").w('-cellAlpha" class="form-control" type="text" value="').f(b.get(["cellAlpha"],!1),b,"h").w('"></div></div><div class="form-group row"><label class="col-md-2 col-form-label">&#946:</label><div class="col-md-10"><input id="').f(b.get(["id"],!1),b,"h").w('-cellBeta" class="form-control" type="text" value="').f(b.get(["cellBeta"],!1),b,"h").w('"></div></div><div class="form-group row"><label class="col-md-2 col-form-label">&#947:</label><div class="col-md-10"><input id="').f(b.get(["id"],!1),b,"h").w('-cellGamma" class="form-control" type="text" value="').f(b.get(["cellGamma"],!1),b,"h").w('"></div></div></div></div><div class="col-md-12"><label class="col-md-2 col-form-label "><b>Comments:</b></label><div class="col-md-10"><textarea id="').f(b.get(["id"],!1),b,"h").w('-comments" class="form-control" rows="3">').f(b.get(["comments"],!1),b,"h").w("</textarea></div></div></div>")}function c(a,b){return a.w("<option value=").f(b.getPath(!0,[]),b,"h").w(" ").h("eq",b,{block:d},{key:e,value:f},"h").w(">").f(b.getPath(!0,[]),b,"h").w("</option>")}function d(a,b){return a.w("selected")}function e(a,b){return a.f(b.getPath(!0,[]),b,"h")}function f(a,b){return a.f(b.get(["spaceGroup"],!1),b,"h")}return a.register("crystal.edit.form.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid"><div class="row"><div class="col-md-4"><table class="table"><thead><tr><th class="text-center" colspan="2">Protein</span></th></tr></thead><tbody><tr><td>Protein acronym</td><td class=\'column_parameter_value\'>').f(b.getPath(!1,["crystalVO","proteinVO","acronym"]),b,"h").w("</td></tr><tr><td>Name</td><td class='column_parameter_value'>").f(b.getPath(!0,["name"]),b,"h").w("</td></tr><tr><td>Comments</td><td class='column_parameter_value'>").f(b.getPath(!0,["comments"]),b,"h").w('</td></tr></tbody></table></div></div><div class="container-fluid" ><div class="row"><div class="col-md-10" style="padding:0;"><div class="col-md-1" style="padding:0;"><table class="table"><thead><tr><th>A</th></tr></thead><tbody><tr><td>').f(b.getPath(!0,["crystalVO","cellA"]),b,"h").w('</td></tr></tbody></table></div><div class="col-md-1" style="padding:0;"><table class="table"><thead><tr><th>B</th></tr></thead><tbody><tr><td>').f(b.getPath(!0,["crystalVO","cellB"]),b,"h").w('</td></tr></tbody></table></div><div class="col-md-1" style="padding:0;"><table class="table"><thead><tr><th>C</th></tr></thead><tbody><tr><td>').f(b.getPath(!0,["crystalVO","cellC"]),b,"h").w('</td></tr></tbody></table></div><div class="col-md-1" style="padding:0;"><table class="table"><thead><tr><th>&#945</th></tr></thead><tbody><tr><td>').f(b.getPath(!0,["crystalVO","cellAlpha"]),b,"h").w('</td></tr></tbody></table></div><div class="col-md-1" style="padding:0;"><table class="table"><thead><tr><th>&#946</th></tr></thead><tbody><tr><td>').f(b.getPath(!0,["crystalVO","cellBeta"]),b,"h").w('</td></tr></tbody></table></div><div class="col-md-1" style="padding:0;"><table class="table"><thead><tr><th>&#947</th></tr></thead><tbody><tr><td>').f(b.getPath(!0,["crystalVO","cellGamma"]),b,"h").w('</td></tr></tbody></table></div><div class="col-md-6" style="padding:0;"><table class="table"><thead><tr><th>PDB</th></tr></thead><tbody><tr><td></td></tr></tbody></table></div></div></div></div></div>')}return a.register("crystal.form.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table><tr><td class='summary_datacollection_parameter_name'>Code</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["code"]),b,"h").w("</td></tr>	<tr><td class='summary_datacollection_parameter_name'>Status</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["dewarStatus"]),b,"h").w("</td></tr>	<tr><td class='summary_datacollection_parameter_name'>Pucks</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["containerVOs","length"]),b,"h").w("</td></tr>	<tr><td class='summary_datacollection_parameter_name'>BarCode</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["barCode"]),b,"h").w("</td></tr>	</table>")}return a.register("dewarlistview",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div id="Viewer" style="position: absolute; left:0px; top:0px;"></div><div class="centeredControls" id="loadControls"><form action="javascript:requestFromServer();" id="pdbIdFetch"><div class="controlItem" id="pdbFetch">Load PDB ID: <input type="text" id="pdbIdInput" style="width:50px;" /><input type="submit" style="display:none" /></div></form></div><div class="controlButton" id="loadControlsButton"><div class="controlMargin" id="loadControlsBtnMargin"><div class="controlItem" id="loadControlsShow">Load structure...</div></div></div>')}return a.register("electron.density.viewer.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div id=").f(b.getPath(!0,["id"]),b,"h").w('><svg pointer-events="none" height="').h("math",b,{},{key:c,method:"multiply",operand:"2"},"h").w('" width="').h("math",b,{},{key:d,method:"multiply",operand:"2"},"h").w('"><circle cx="').f(b.get(["radius"],!1),b,"h").w('" cy="').f(b.get(["radius"],!1),b,"h").w('" r="').f(b.get(["radius"],!1),b,"h").w('" stroke="black" stroke-width="1" fill="#FFFFFF" pointer-events="none"/>').s(b.get(["lines"],!1),b,{block:e},{}).w("</svg></div>")}function c(a,b){return a.f(b.get(["radius"],!1),b,"h")}function d(a,b){return a.f(b.get(["radius"],!1),b,"h")}function e(a,b){return a.w('<line x1="').f(b.getPath(!0,["x1"]),b,"h").w('" y1="').f(b.getPath(!0,["y1"]),b,"h").w('" x2="').f(b.getPath(!0,["x2"]),b,"h").w('" y2="').f(b.getPath(!0,["y2"]),b,"h").w('" style="stroke:rgb(0,0,0);stroke-width:1" pointer-events="none"/>')}return a.register("flexhcd.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid" style="padding:0;">').s(b.get(["info"],!1),b,{block:c},{}).w("</div>")}function c(a,b){return a.w('<div class="row" style=\'font-size:').f(b.getPath(!0,["textSize"]),b,"h").w('px;\'><div class="col-md-6" style="padding-right:2px;"><b>').f(b.getPath(!0,["text"]),b,"h").w('</b></div><div class="col-md-6" style="padding-left:2px;">').f(b.getPath(!0,["value"]),b,"h").w("</div></div>")}return a.register("info.grid.template",b),b.__dustBody=!0,c.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid" style="padding:0px;"><div class="panel with-nav-tabs panel-default" style="margin-bottom: 0px;"><div class="panel-heading clearfix"><div class="pull-left"><span id="').f(b.get(["id"],!1),b,"h").w("-label\" style='font-size:15px;color:black;font-weight:700' >Content (0 Parcels)</span><button id=\"").f(b.get(["id"],!1),b,"h").w('-add-button" type="button" style="margin-left:15px;" class="btn btn-default disabled"><span class="glyphicon glyphicon-plus-sign"></span> Add</button></div><div class="pull-right"><ul class="nav nav-tabs" id="').f(b.get(["id"],!1),b,"h").w('-tabs"><li class="active"><a data-toggle="tab" href="#content-').f(b.get(["id"],!1),b,"h").w('">Content</a></li><li><a data-toggle="tab" href="#statistics-').f(b.get(["id"],!1),b,"h").w('">Statistics</a></li>     </ul></div></div><div class="tab-content"><div id="content-').f(b.get(["id"],!1),b,"h").w('" class="tab-pane fade in active"></div><div id="statistics-').f(b.get(["id"],!1),b,"h").w('" class="tab-pane fade"></div></div></div></div>')}return a.register("parcel.grid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container"><div class="row"><div class="col-sm-3"><div class="row"><div class="col-sm-6"><b>Code:</b></div><div class="col-sm-6">').f(b.getPath(!0,["code"]),b,"h").w('</div></div></div><div class="col-sm-3"><div class="row"><div class="col-sm-6"><b>Status:</b></div><div class="col-sm-6">').f(b.getPath(!0,["dewarStatus"]),b,"h").w('</div></div></div><div class="col-sm-3"><div class="row"><div class="col-sm-6"><b>Store Location:</b></div><div class="col-sm-6">').f(b.getPath(!0,["storageLocation"]),b,"h").w('</div></div></div><div class="col-sm-3"><div class="row"><div class="col-sm-6"><b>Comments:</b></div><div class="col-sm-6">').f(b.getPath(!0,["comments"]),b,"h").w("</div></div></div></div></div>")}return a.register("parcel.header.shipping.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<table class="table valign-middle-rows small-padding-rows" style="height:').f(b.get(["height"],!1),b,"h").w('px;margin:0px;font-size: 9px;"><tr><td style="border-top:none;">Name: </td><td class="column_parameter_value" style="border-top:none;">').f(b.getPath(!1,["dewar","code"]),b,"h").w('</td></tr><tr valign="middle"><td>Status: </td><td class="column_parameter_value">').f(b.getPath(!1,["dewar","dewarStatus"]),b,"h").w('</td></tr><tr valign="middle"><td>Location: </td><td class="column_parameter_value">').f(b.getPath(!1,["dewar","beamlineName"]),b,"h").w('</td></tr><tr valign="middle"><td>Storage: </td><td class="column_parameter_value">').f(b.getPath(!1,["dewar","storageLocation"]),b,"h").w("</td></tr>        </table>")}return a.register("parcel.panel.parameter.table.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<table class="table valign-middle-rows small-padding-rows" style="height:').f(b.get(["height"],!1),b,"h").w('px;margin:0px;font-size: 9px;"><tr><td td align="left"  style="border-top:none;padding-left:40px;">Name: </td><td class="column_parameter_value" style="border-top:none;">').f(b.getPath(!1,["dewar","code"]),b,"h").w('</td></tr><tr><td align="left" style="padding-left:40px;">Containers: </td><td class="column_parameter_value">').f(b.get(["nContainers"],!1),b,"h").w('</td></tr><tr valign="middle"><td align="left" style="padding-left:40px;">Samples: </td><td class="column_parameter_value">').f(b.get(["nSamples"],!1),b,"h").w('</td></tr><tr valign="middle"><td align="left" style="padding-left:40px;">Measured samples: </td><td class="column_parameter_value">').f(b.get(["nMeasured"],!1),b,"h").w("</td></tr>     </table>")}return a.register("parcel.panel.statistics.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid" style="padding:0px"><table class="table valign-middle-rows small-padding-rows" style="margin:0px;"><tr><td id="').f(b.get(["id"],!1),b,"h").w('-index-td" rowspan="1" style="background-color:#f5f5f5;width:25px;border-top:none;"><span style="font-size: 10px;">#').f(b.getPath(!1,["dewar","index"]),b,"h").w('</span></td><td style="border-top:none;"><div class="container-fluid"><div class="row"><div id="').f(b.get(["id"],!1),b,"h").w('-parameters-div" class="col-md-2" style="text-align:center;padding:0px;"></div><div id="').f(b.get(["id"],!1),b,"h").w('-container-panel-div" class="col-md-10"></div></div></div></td><td id="').f(b.get(["id"],!1),b,"h").w('-buttons-td" rowspan="1" style="background-color:#ddd;border-top:none;"><table class="table valign-middle-rows small-padding-rows table-disabled" style="margin:0px;"><tr><td><a id="').f(b.get(["id"],!1),b,"h").w('-add-button" class="btn btn-xs disabled"><span class="glyphicon glyphicon-plus-sign"></span> Add container</a></td></tr><tr><td><a id="').f(b.get(["id"],!1),b,"h").w('-edit-button" class="btn btn-xs disabled"><span class="glyphicon glyphicon-edit"></span> Edit</a></td></tr><tr><td><a id="').f(b.get(["id"],!1),b,"h").w('-print-button" class="btn btn-xs"><span class="glyphicon glyphicon-print"></span> Print labels</a></td></tr></table></td></tr><tr><td><div id="').f(b.get(["id"],!1),b,"h").w('-comments"></div></td></tr></table></div>')}return a.register("parcel.panel.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<svg id="').f(b.get(["id"],!1),b,"h").w('-svg" style="width:100%;height:100%;" style="overflow:visible">').s(b.get(["circles"],!1),b,{block:c},{}).w("</svg>")}function c(a,b){return a.w('<circle id="').f(b.get(["id"],!1),b,"h").w("-legend-").f(b.getPath(!0,["cls"]),b,"h").w('" cx="').f(b.getPath(!0,["cx"]),b,"h").w('" cy="').f(b.getPath(!0,["cy"]),b,"h").w('" r="').f(b.getPath(!0,["r"]),b,"h").w('" class="').f(b.getPath(!0,["cls"]),b,"h").w('"/><text text-anchor="middle" x="').f(b.getPath(!0,["cx"]),b,"h").w('" y="').h("math",b,{},{key:d,method:"add",operand:e},"h").w('" dy="').f(b.get(["tOffset"],!1),b,"h").w('" font-size="').f(b.get(["fontSize"],!1),b,"h").w('">').f(b.getPath(!0,["text"]),b,"h").w("</text>")}function d(a,b){return a.f(b.getPath(!0,["cy"]),b,"h")}function e(a,b){return a.f(b.getPath(!0,["r"]),b,"h")}return a.register("puck.legend.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div id='").f(b.getPath(!0,["id"]),b,"h").w("' style='height:").f(b.get(["height"],!1),b,"h").w("px;").x(b.get(["enableClick"],!1),b,{block:c},{}).w("'><div id='").f(b.getPath(!0,["id"]),b,"h").w("-img' pointer-events='none' class='stock-solution' style=\"height:").f(b.get(["height"],!1),b,"h").w('px;">').x(b.get(["fillPanel"],!1),b,{block:d},{}).w("</div></div>")}function c(a,b){return a.w("cursor:pointer;")}function d(a,b){return a.w('<table class="table"><tr valign="middle"><td style="border-bottom:1px solid;"><b>').h("eq",b,{"else":e,block:f},{key:b.get(["code"],!1),value:""},"h").w("</b></td></tr><tr><td><span id='").f(b.get(["id"],!1),b,"h").w("-samples'>").f(b.get(["nSamples"],!1),b,"h").w('</span><span style="font-size:9px;"> Samples</span></td></tr><tr><td><span id=\'').f(b.get(["id"],!1),b,"h").w("-measured'>").f(b.get(["nMeasured"],!1),b,"h").w('</span><span style="font-size:8px;"> Measured</span></td></tr></table>')}function e(a,b){return a.f(b.get(["code"],!1),b,"h")}function f(a,b){return a.w("&nbsp;-")}return a.register("puck.statistics.container.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div id='hoveringTooltipDiv-").f(b.get(["id"],!1),b,"h").w("' pointer-events='none' class='cell_info_tooltip'>").f(b.get(["nSamples"],!1),b,"h").w(" Samples<br/>").f(b.get(["nMeasured"],!1),b,"h").w(" Measured</div>")}return a.register("puck.statistics.tooltip.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div id="').f(b.getPath(!0,["id"]),b,"h").w('-div"><svg id="').f(b.getPath(!0,["id"]),b,"h").w('-svg"  height="').h("math",b,{},{key:c,method:"multiply",operand:"2.2"},"h").w('" width="').h("math",b,{},{key:d,method:"multiply",operand:"2.2"},"h").w('" style="overflow:visible"><defs><radialGradient id="errorGradient" cx="50%" cy="50%" r="50%" fx="50%" fy="50%"><stop offset="0%" style="stop-color:rgb(255,255,0); stop-opacity:1" /><stop offset="100%" style="stop-color:rgb(255,0,0); stop-opacity:1" /></radialGradient><radialGradient id="errorGradientSelected" cx="50%" cy="50%" r="50%" fx="50%" fy="50%"><stop offset="0%" style="stop-color:#66ff66; stop-opacity:1" /><stop offset="100%" style="stop-color:rgb(255,0,0); stop-opacity:1" /></radialGradient></defs><circle  id="').f(b.getPath(!0,["id"]),b,"h").w('" cx="').f(b.get(["mainRadius"],!1),b,"h").w('" cy="').f(b.get(["mainRadius"],!1),b,"h").w('" r="').f(b.get(["mainRadius"],!1),b,"h").w('" fill="#CCCCCC" class=\'puck\' ').x(b.get(["enableMainClick"],!1),b,{block:e},{}).w("/>").x(b.get(["isUnipuck"],!1),b,{block:f},{}).w('<?isLoading}<text id="').f(b.getPath(!0,["id"]),b,"h").w('-loading-text" x="').f(b.get(["mainRadius"],!1),b,"h").w('" y="').f(b.get(["mainRadius"],!1),b,"h").w('" fill="white" font-size="').h("math",b,{},{key:r,method:"multiply",operand:"1.5"},"h").w('" text-anchor="middle" pointer-events="none"><tspan dx="0" dy="0">LOADING...</tspan></text></isLoading>').s(b.get(["cells"],!1),b,{block:s},{}).w("</svg></div>")}function c(a,b){return a.f(b.get(["mainRadius"],!1),b,"h")}function d(a,b){return a.f(b.get(["mainRadius"],!1),b,"h")}function e(a,b){return a.w('style="cursor:pointer"')}function f(a,b){return a.w(' <g fill="#888888" stroke="#888888" pointer-events="none"><circle cx="').f(b.get(["mainRadius"],!1),b,"h").w('" cy="').h("math",b,{},{key:g,method:"add",operand:h},"h").w('" r="').f(b.get(["shapeRadiusX"],!1),b,"h").w('" /><circle cx="').h("math",b,{},{key:i,method:"subtract",operand:j},"h").w('" cy="').h("math",b,{},{key:k,method:"subtract",operand:l},"h").w('" r="').f(b.get(["shapeRadiusY"],!1),b,"h").w('" stroke-width="1" /><circle cx="').h("math",b,{},{key:m,method:"add",operand:n},"h").w('" cy="').h("math",b,{},{key:o,method:"subtract",operand:p},"h").w('" r="').f(b.get(["shapeRadiusY"],!1),b,"h").w('" stroke-width="1" /><circle cx="').f(b.get(["mainRadius"],!1),b,"h").w('" cy="').h("math",b,{},{key:q,method:"multiply",operand:"1.5"},"h").w('" r="').f(b.get(["shapeRadiusX"],!1),b,"h").w('" /></g>')}function g(a,b){return a.f(b.get(["mainRadius"],!1),b,"h")}function h(a,b){return a.f(b.get(["shapeRadiusY"],!1),b,"h")}function i(a,b){return a.f(b.get(["mainRadius"],!1),b,"h")}function j(a,b){return a.f(b.get(["shapeRadiusX"],!1),b,"h")}function k(a,b){return a.f(b.get(["mainRadius"],!1),b,"h")}function l(a,b){return a.f(b.get(["shapeRadiusY"],!1),b,"h")}function m(a,b){return a.f(b.get(["mainRadius"],!1),b,"h")}function n(a,b){return a.f(b.get(["shapeRadiusX"],!1),b,"h")}function o(a,b){return a.f(b.get(["mainRadius"],!1),b,"h")}function p(a,b){return a.f(b.get(["shapeRadiusY"],!1),b,"h")}function q(a,b){return a.f(b.get(["mainRadius"],!1),b,"h")}function r(a,b){return a.f(b.get(["shapeRadiusX"],!1),b,"h")}function s(a,b){return a.x(b.get(["enableClick"],!1),b,{block:t},{}).w('<circle id="').f(b.getPath(!0,["id"]),b,"h").w('" cx="').f(b.getPath(!0,["x"]),b,"h").w('" cy="').f(b.getPath(!0,["y"]),b,"h").w('" r="').f(b.getPath(!0,["radius"]),b,"h").w('" ').x(b.get(["enableClick"],!1),b,{block:v},{}).w(" ").nx(b.get(["enableMouseOver"],!1),b,{block:w},{}).w(' class="cell_empty"></circle><circle id="').f(b.getPath(!0,["id"]),b,"h").w('-inner" visibility="hidden" fill="none" stroke="yellow" stroke-width="2" cx="').f(b.getPath(!0,["x"]),b,"h").w('" cy="').f(b.getPath(!0,["y"]),b,"h").w('" r="').h("math",b,{},{key:x,method:"multiply",operand:"0.7"},"h").w('" pointer-events="none"></circle>').x(b.get(["enableClick"],!1),b,{block:y},{}).w("						").h("gt",b,{block:A},{key:b.get(["radius"],!1),value:10},"h")}function t(a,b){return a.x(b.getPath(!0,["dataCollectionIds"]),b,{block:u},{})}function u(a,b){return a.w('<a id="').f(b.getPath(!0,["id"]),b,"h").w('-anchor" onclick="window.open(\'#/mx/datacollection/datacollectionid/').f(b.getPath(!0,["dataCollectionIds"]),b,"h").w("/main','_blank');window.close();return false\" href='#/mx/datacollection/datacollectionid/").f(b.getPath(!0,["dataCollectionIds"]),b,"h").w('/main\' target="_blank" style="target-new: tab;">')}function v(a,b){return a.w('style="cursor:pointer"')}function w(a,b){return a.w(' pointer-events="none" ')}function x(a,b){return a.f(b.getPath(!0,["radius"]),b,"h")}function y(a,b){return a.x(b.getPath(!0,["dataCollectionIds"]),b,{block:z},{})}function z(a,b){return a.w("</a>")}function A(a,b){return a.w('<text id="').f(b.getPath(!0,["id"]),b,"h").w('-label" x="').f(b.getPath(!0,["x"]),b,"h").w('" y="').f(b.getPath(!0,["y"]),b,"h").w('" fill="black" font-size="').h("math",b,{},{key:B,method:"multiply",operand:"1.1"},"h").w('" text-anchor="middle" pointer-events="none"><tspan dx="0" dy="').h("math",b,{},{key:C,method:"multiply",operand:"0.4"},"h").w('" pointer-events="none">').h("math",b,{},{key:D,method:"add",operand:"1"},"h").w('</tspan><tspan x="').f(b.getPath(!0,["x"]),b,"h").w('" dy="12"></tspan></text>')}function B(a,b){return a.f(b.get(["shapeRadiusX"],!1),b,"h")}function C(a,b){return a.f(b.get(["shapeRadiusX"],!1),b,"h")}function D(a,b){return a.f(b.get(["$idx"],!1),b,"h")}return a.register("puck.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,p.__dustBody=!0,q.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,t.__dustBody=!0,u.__dustBody=!0,v.__dustBody=!0,w.__dustBody=!0,x.__dustBody=!0,y.__dustBody=!0,z.__dustBody=!0,A.__dustBody=!0,B.__dustBody=!0,C.__dustBody=!0,D.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div id="').f(b.get(["id"],!1),b,"h").w('-form" style="padding:20px;"><div class="form-group row"><label class="col-md-2 col-form-label">Title:</label><label class="col-md-8">').f(b.get(["title"],!1),b,"h").w('</label></div><div id="').f(b.get(["id"],!1),b,"h").w('-dates" class="form-group row"><label class="col-md-2"><b>Start:</b></label><div class="col-md-4"><input id="').f(b.get(["id"],!1),b,"h").w('-startDate" class="form-control" type="date" value="').f(b.get(["tenDaysAgo"],!1),b,"h").w('"></div><label class="col-md-2"><b>End:</b></label><div class="col-md-4"><input id="').f(b.get(["id"],!1),b,"h").w('-endDate" class="form-control" type="date" value="').f(b.get(["today"],!1),b,"h").w('"></div></div><div class="form-group row"><label class="col-md-2 col-form-label">Type:</label><div class="col-md-10"><select id="').f(b.get(["id"],!1),b,"h").w('-type" class="form-control">').s(b.get(["types"],!1),b,{block:c},{}).w('</select></div></div><div class="form-group row"><label class="col-md-2 col-form-label">Beamline:</label><div class="col-md-10"><select id="').f(b.get(["id"],!1),b,"h").w('-beamline" class="form-control"><option></option>').s(b.get(["beamlines"],!1),b,{block:d},{}).w('</select></div></div><div class="form-group row"><div id="').f(b.get(["id"],!1),b,"h").w('-checkox-div" class="container-fluid scattering-plot-checkboxes">').s(b.get(["chunkedKeys"],!1),b,{block:e},{}).w("</div></div></div>")}function c(a,b){return a.w("<option value=").f(b.getPath(!0,["value"]),b,"h").w(">").f(b.getPath(!0,["display"]),b,"h").w("</option>")}function d(a,b){return a.w("<option value=").f(b.getPath(!0,["name"]),b,"h").w(">").f(b.getPath(!0,["name"]),b,"h").w("</option>")}function e(a,b){return a.s(b.getPath(!0,[]),b,{block:f},{})}function f(a,b){return a.w('<div class="col-md-4"><label><input class="scattering-checkbox" type="checkbox" value="').f(b.getPath(!0,[]),b,"h").w('"> ').f(b.getPath(!0,[]),b,"h").w("</label></div>")}return a.register("scattering.form.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title">  ').f(b.getPath(!0,["month"]),b,"h").w(" ").f(b.getPath(!0,["day"]),b,"h").w(" ").f(b.getPath(!0,["year"]),b,"h").w("</h3></div><div class=\"panel-body\"><p style='font-size:18px;'>").f(b.getPath(!0,["beamLineName"]),b,"h").w("</p><p>").f(b.getPath(!0,["nbShifts"]),b,"h").w(" shifts</p><div style='font-weight:italic;font-size:10px;width: 100%;  word-break: break-all;  white-space: normal;'>").f(b.getPath(!0,["comments"]),b,"h").w('</div><!-- List group --><ul class="list-group">').h("gt",b,{block:c},{key:b.get(["sampleCount"],!1),value:0},"h").h("gt",b,{block:d},{key:b.get(["testDataCollectionGroupCount"],!1),value:0},"h").h("gt",b,{block:e},{key:b.get(["dataCollectionGroupCount"],!1),value:0},"h").h("gt",b,{block:f},{key:b.get(["xrfSpectrumCount"],!1),value:0},"h").h("gt",b,{block:g},{key:b.get(["energyScanCount"],!1),value:0},"h").w("</ul><p style='font-size:10px;'>Local contact: ").f(b.getPath(!0,["beamLineOperator"]),b,"h").w("</p></div></div>")}function c(a,b){return a.w('<li class="list-group-item"><span style=\'background-color:#337ab7;\' class="badge badge-primary">').f(b.getPath(!0,["sampleCount"]),b,"h").w("</span>Samples</li>")}function d(a,b){return a.w('<li class="list-group-item"><span style=\'background-color:#337ab7;\' class="badge">').f(b.getPath(!0,["testDataCollectionGroupCount"]),b,"h").w("</span>Tests</li>")}function e(a,b){return a.w('<li class="list-group-item"><span style=\'background-color:#337ab7;\' class="badge">').f(b.getPath(!0,["dataCollectionGroupCount"]),b,"h").w("</span>Data Collections</li>")}function f(a,b){return a.w('<li class="list-group-item"><span style=\'background-color:#337ab7;\' class="badge">').f(b.getPath(!0,["xrfSpectrumCount"]),b,"h").w("</span>Spectra</li>")}function g(a,b){return a.w('<li class="list-group-item"><span style=\'background-color:#337ab7;\' class="badge">').f(b.getPath(!0,["energyScanCount"]),b,"h").w("</span>Energy Scans</li>")}return a.register("session.listview",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title">').f(b.getPath(!0,["proposal"]),b,"h").w('</h3></div><div class="panel-body">').f(b.getPath(!0,["title"]),b,"h").w("<br />").f(b.getPath(!0,["sessionCount"]),b,"h").w(" sessions</div></div>")}return a.register("welcomemainviewproposalheader",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div style="padding:20px;"><div class="form-group row"><label class="col-md-2 col-form-label">Name:</label><div class="col-md-10"><input id="').f(b.get(["id"],!1),b,"h").w('-name" class="form-control" type="text" value="').f(b.getPath(!1,["shipment","shippingName"]),b,"h").w('"></div></div><div class="form-group row"><label class="col-md-2 col-form-label">Session:</label><div class="col-md-10"><select id="').f(b.get(["id"],!1),b,"h").w('-date" class="form-control"><option> </option>').s(b.get(["sessions"],!1),b,{block:c},{}).w('</select></div></div><div class="form-group row"><label class="col-md-2 col-form-label">Comments:</label><div class="col-md-10"><textarea id="').f(b.get(["id"],!1),b,"h").w('-comments" class="form-control" rows="3">').f(b.getPath(!1,["shipment","comments"]),b,"h").w('</textarea></div></div><div class="form-group row"><label class="col-md-2 col-form-label">From:</label><div class="col-md-10"><select id="').f(b.get(["id"],!1),b,"h").w('-to" class="form-control">').s(b.get(["from"],!1),b,{block:j},{}).w('</select></div></div><div class="form-group row"><label class="col-md-2 col-form-label">Return address:</label><div class="col-md-10"><select id="').f(b.get(["id"],!1),b,"h").w('-from" class="form-control">').s(b.get(["to"],!1),b,{block:n},{}).w("</select></div></div></div>")}function c(a,b){return a.w("<option value=").f(b.getPath(!0,["sessionId"]),b,"h").w(" ").h("eq",b,{block:d},{key:h,value:i},"h").w(">").f(b.getPath(!0,["formattedDate"]),b,"h").w(", ").f(b.getPath(!0,["beamLineName"]),b,"h").w("</option>")}function d(a,b){return a.h("eq",b,{block:e},{key:f,value:g},"h")}function e(a,b){return a.w("selected")}function f(a,b){return a.f(b.getPath(!0,["beamLineName"]),b,"h")}function g(a,b){return a.f(b.get(["beamlineName"],!1),b,"h")}function h(a,b){return a.f(b.getPath(!0,["date"]),b,"h")}function i(a,b){return a.f(b.get(["startDate"],!1),b,"h")}function j(a,b){return a.w("<option value=").f(b.getPath(!0,["labContactId"]),b,"h").w(" ").h("eq",b,{block:k},{key:l,value:m},"h").w(">").f(b.getPath(!0,["cardName"]),b,"h").w("</option>")}function k(a,b){return a.w("selected")}function l(a,b){return a.f(b.getPath(!0,["cardName"]),b,"h")}function m(a,b){return a.f(b.getPath(!1,["shipment","sendingLabContactVO","cardName"]),b,"h")}function n(a,b){return a.w("<option value=").f(b.getPath(!0,["labContactId"]),b,"h").w(" ").h("eq",b,{block:o},{key:p,value:q},"h").w(">").f(b.getPath(!0,["cardName"]),b,"h").w("</option>")}function o(a,b){return a.w("selected")}function p(a,b){return a.f(b.getPath(!0,["cardName"]),b,"h")}function q(a,b){return a.f(b.getPath(!1,["shipment","returnLabContactVO","cardName"]),b,"h")}return a.register("shipping.edit.form.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,p.__dustBody=!0,q.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<table class="table-sm table borderless small-padding-rows table-disabled" style="margin:0px;background-color:#AAAAAA;"><tbody><tr><td>').f(b.get(["cellA"],!1),b,"h").w("</td><td>").f(b.get(["cellB"],!1),b,"h").w("</td><td>").f(b.get(["cellC"],!1),b,"h").w("</td></tr><tr><td>").f(b.get(["cellAlpha"],!1),b,"h").w("</td><td>").f(b.get(["cellBeta"],!1),b,"h").w("</td><td>").f(b.get(["cellGamma"],!1),b,"h").w("</td></tr></tbody></table>")}return a.register("shipping.edit.form.unit.cell.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid" style="padding-left: 0px;padding-right: 0px;"><div class="panel with-nav-tabs panel-default" style="margin-bottom: 0px;"><div class="panel-heading clearfix"><div class="pull-right"><ul class="nav nav-tabs" id="myTabs"><li class="active"><a data-toggle="tab" href="#').f(b.get(["id"],!1),b,"h").w('-shipping-information">Information</a></li>              </ul></div></div><div class="tab-content"><div id="').f(b.get(["id"],!1),b,"h").w('-shipping-information" class="tab-pane fade in active" style="padding:10px;"><div class="form-group row" style="margin:0px"><div class="col-md-2" style="padding:0px"><table class="table small-padding-rows borderless" style="margin:0px"><tr><td class=\'column_parameter_value\'>Name:</td><td>').f(b.getPath(!1,["shipment","shippingName"]),b,"h").w("</td></tr><tr><td class='column_parameter_value'>Beamline:</td><td>").f(b.getPath(!0,["beamlineName"]),b,"h").w("</td></tr><tr><td class='column_parameter_value'>Date:</td><td>").f(b.getPath(!0,["startDate"]),b,"h").w('</td></tr></table> </div><div class="col-md-2" style="padding:0px"><div class="form-group row" style="margin:5px"><label class="col-md-3 col-form-label" ><b>From:</b></label><label class="col-md-9" style="font-weight: normal">').f(b.getPath(!1,["shipment","sendingLabContactVO","cardName"]),b,"h").w('</label></div><div class="form-group row" style="margin:5px"><label class="col-md-3 col-form-label" ><b>Return address:</b></label><label class="col-md-9" style="font-weight: normal">').x(b.getPath(!1,["shipment","returnLabContactVO"]),b,{
"else":c,block:d},{}).w('</label></div></div><div class="col-md-1" style="padding:0px"></div><div class="col-md-1" style="padding:0px"></div><div class="col-md-5" style="padding:0px"><div class="form-group row" style="margin:5px"><label class="col-md-3 col-form-label " ><b>Comments:</b></label><textarea  class="col-md-9" rows="4" disabled>').f(b.getPath(!1,["shipment","comments"]),b,"h").w('</textarea ></div></div><div class="col-md-1 pull-right" style="padding:0px"><button id="').f(b.get(["id"],!1),b,"h").w('-edit-button" class="btn btn-primary btn-lg" style="margin-left:10px;height:90px;" disabled>Edit</button></div></div></div><div id="').f(b.get(["id"],!1),b,"h").w('-shipping-transport-history" class="tab-pane fade" style="padding:10px;"><div class="form-group row" style="margin:0px"><div class="col-md-2" style="padding:0px"><div class="form-group row" style="margin:5px"><label class="col-md-7 col-form-label" ><b>Creation date:</b></label><label class="col-md-5" style="font-weight: normal">').h("formatDate",b,{},{date:b.getPath(!1,["shipment","creationDate"]),format:"DD-MM-YYYY"},"h").w('</label></div><div class="form-group row" style="margin:5px"><label class="col-md-7 col-form-label" ><b>Sending date:</b></label><label class="col-md-5" style="font-weight: normal">').h("formatDate",b,{},{date:b.getPath(!1,["shipment","dateOfShippingToUser"]),format:"DD-MM-YYYY"},"h").w('</label></div><div class="form-group row" style="margin:5px"><label class="col-md-7 col-form-label" ><b>Expected arrival date:</b></label><label class="col-md-5" style="font-weight: normal"></label></div><div class="form-group row" style="margin:5px"><label class="col-md-7 col-form-label" ><b>Return date:</b></label><label class="col-md-5" style="font-weight: normal"></label></div></div></div></div></div></div></div>')}function c(a,b){return a.w("NO RETURN")}function d(a,b){return a.f(b.getPath(!1,["shipment","returnLabContactVO","cardName"]),b,"h")}return a.register("shipping.form.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table> <tr><td style='color:#207a7a;font-weight:bold;'>").f(b.getPath(!0,["Shipping_shippingName"]),b,"h").w("</td></tr><tr><td>").f(b.getPath(!0,["formattedCreationDate"]),b,"h").w("</td></tr><tr><td>").f(b.getPath(!0,["stats","dewars"]),b,"h").w(" parcels (").f(b.getPath(!0,["stats","samples"]),b,"h").w(" Samples)</td></tr><tr><td ").h("eq",b,{block:c},{key:b.get(["Shipping_shippingStatus"],!1),value:"processing"},"h").w(">").f(b.getPath(!0,["Shipping_shippingStatus"]),b,"h").w("</td></tr></table>")}function c(a,b){return a.w("style='color:#ff7f00;font-weight:bold;' ")}return a.register("shipping.listview",b),b.__dustBody=!0,c.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div id='").f(b.getPath(!0,["id"]),b,"h").w("' style='height:").f(b.get(["height"],!1),b,"h").w("px;").x(b.get(["enableClick"],!1),b,{block:c},{}).w("'><div id='").f(b.getPath(!0,["id"]),b,"h").w("-img' pointer-events='none' class='stock-solution' style=\"height:").f(b.get(["height"],!1),b,"h").w('px;">').x(b.get(["fillPanel"],!1),b,{block:d},{}).w("</div></div>")}function c(a,b){return a.w("cursor:pointer;")}function d(a,b){return a.w('<table class="table"><tr valign="middle"><td style="border-bottom:1px solid;"><b>').h("eq",b,{"else":e,block:f},{key:b.get(["code"],!1),value:""},"h").w("</b></td></tr><tr><td>").f(b.get(["macromoleculeAcronym"],!1),b,"h").w("</td></tr><tr><td>").f(b.get(["buffer"],!1),b,"h").w("</td></tr></table>")}function e(a,b){return a.f(b.get(["code"],!1),b,"h")}function f(a,b){return a.w("&nbsp;-")}return a.register("stock.solution.container.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div id='hoveringTooltipDiv-").f(b.get(["stockId"],!1),b,"h").w("' pointer-events='none' class='cell_info_tooltip'><b>Code:</b> ").f(b.get(["code"],!1),b,"h").w("<br/><b>Macromolecule:</b> ").f(b.get(["macromoleculeAcronym"],!1),b,"h").w("<br/><b>Buffer:</b> ").f(b.get(["buffer"],!1),b,"h").w("</div>")}return a.register("stock.solution.tooltip.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid persist-header"><div class="row text-center" style="border : 1px solid #ccc;"><div class="col-sm-3 queue-border-right-columns ">Acronym</div> <div class="col-sm-3 queue-border-right-columns">Buffer</div> <div class="col-sm-3 queue-border-right-columns" >Concentration (mg/ml)</div><div class="col-sm-3 queue-border-right-columns" >Volume (&#956l)</div></div>  </div>  <div id="').f(b.get(["id"],!1),b,"h").w('-scrollable" style="display: block; height: ').f(b.get(["height"],!1),b,"h").w('px; overflow-y: auto">').s(b.get(["stockSolutions"],!1),b,{block:c},{}).w("</div>")}function c(a,b){return a.w('<div class="container-fluid persist-header"><div class="row queue-border-bottom-columns"><div class="col-sm-3 queue-border-right-columns ">').f(b.getPath(!0,["acronym"]),b,"h").w('</div> <div class="col-sm-3 queue-border-right-columns">').f(b.getPath(!0,["buffer"]),b,"h").w('</div> <div class="col-sm-3 queue-border-right-columns" >').f(b.getPath(!0,["concentration"]),b,"h").w('</div><div class="col-sm-3 queue-border-right-columns" >').f(b.getPath(!0,["volume"]),b,"h").w("</div></div>  </div>")}return a.register("stock.solutions.grid.template",b),b.__dustBody=!0,c.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div id=").f(b.getPath(!0,["id"]),b,"h").w('><svg pointer-events="none" height="').h("math",b,{},{key:c,method:"multiply",operand:"2"},"h").w('" width="').h("math",b,{},{key:d,method:"multiply",operand:"2"},"h").w('"><circle cx="').f(b.get(["radius"],!1),b,"h").w('" cy="').f(b.get(["radius"],!1),b,"h").w('" r="').f(b.get(["radius"],!1),b,"h").w('" stroke="black" stroke-width="1" fill="#FFFFFF" pointer-events="none"/>').s(b.get(["lines"],!1),b,{block:e},{}).s(b.get(["text"],!1),b,{block:f},{}).w("</svg></div>")}function c(a,b){return a.f(b.get(["radius"],!1),b,"h")}function d(a,b){return a.f(b.get(["radius"],!1),b,"h")}function e(a,b){return a.w('<line x1="').f(b.getPath(!0,["x1"]),b,"h").w('" y1="').f(b.getPath(!0,["y1"]),b,"h").w('" x2="').f(b.getPath(!0,["x2"]),b,"h").w('" y2="').f(b.getPath(!0,["y2"]),b,"h").w('" style="stroke:rgb(0,0,0);stroke-width:1" pointer-events="none"/>')}function f(a,b){return a.w('<text x="').f(b.getPath(!0,["x"]),b,"h").w('" y="').f(b.getPath(!0,["y"]),b,"h").w('" ').x(b.get(["textSize"],!1),b,{block:g},{}).w(' text-anchor="middle" stroke="black" stroke-width="1" pointer-events="none"><tspan dx="0" dy="0">').f(b.getPath(!0,["text"]),b,"h").w("</tspan></text>")}function g(a,b){return a.w('font-size="').f(b.getPath(!0,["textSize"]),b,"h").w('"')}return a.register("structure.sampleChanger.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div id='hoveringTooltipDiv' pointer-events='none' class='cell_info_tooltip'>").s(b.getPath(!0,[]),b,{block:c},{}).w("</div>")}function c(a,b){return a.w("<b>").f(b.getPath(!0,["key"]),b,"h").w(":</b> ").f(b.getPath(!0,["value"]),b,"h").w("<br/>")}return a.register("tooltip.template",b),b.__dustBody=!0,c.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table> <tr><td>Program:</td><td style='color:#207a7a;font-weight:bold;'>").f(b.getPath(!0,["v_datacollection_processingPrograms"]),b,"h").w("</td></tr><tr><td>Space group:</td><td>").f(b.getPath(!0,["v_datacollection_summary_phasing_autoproc_space_group"]),b,"h").w("</td></tr>	</table>")}return a.register("autoprocintegration.listview",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid"><div class="panel with-nav-tabs panel-default"><div class="panel-heading clearfix"><div class="pull-left">                                <h1 class="panel-title" style=\'color:#337ab7;\'><kbd> ').f(b.getPath(!0,["v_datacollection_processingPrograms"]),b,"h").w("</kbd><kbd style='background-color:#337ab7;'>").f(b.getPath(!0,["v_datacollection_summary_phasing_autoproc_space_group"]),b,"h").w(" </kbd>").h("eq",b,{block:c},{key:b.get(["v_datacollection_summary_phasing_anomalous"],!1),value:"true",type:"boolean"},"h").w('</h1></div><div class="pull-right"><ul class="nav nav-tabs"><li class="active"><a data-toggle="tab" href="#autoproc_').f(b.get(["AutoProcIntegration_autoProcIntegrationId"],!1),b,"h").w('">Statistics</a></li><li ><a data-toggle="tab" href="#tab_files_').f(b.getPath(!0,["v_datacollection_summary_phasing_autoProcProgramId"]),b,"h").w('">Files</a></li><li ><a data-toggle="tab" href="#plots').f(b.getPath(!0,["v_datacollection_summary_phasing_autoProcProgramId"]),b,"h").w('">Plots</a></li></ul></div></div><br /><div class="tab-content"><div id="autoproc_').f(b.get(["AutoProcIntegration_autoProcIntegrationId"],!1),b,"h").w('" class="tab-pane fade in active"><div class="container-fluid"><div class="row"><div class="col-xs-6 col-md-2">                   ').p("unitcell.autoprocintegrationgrid.template",b,b,{}).w('                             </div><div class="col-xs-6 col-md-7">').p("statistics.autoprocintegrationgrid.template",b,b,{}).w('                         </div><div class="col-xs-6 col-md-1">').p("phasing.autoprocintegrationgrid.template",b,b,{}).w('                         </div></div></div></div><div id="tab_files_').f(b.getPath(!0,["v_datacollection_summary_phasing_autoProcProgramId"]),b,"h").w('" class="tab-pane fade"><div class="container-fluid"><div id="fl_').f(b.getPath(!0,["v_datacollection_summary_phasing_autoProcProgramId"]),b,"h").w('" class="row"></div></div></div><div id="plots').f(b.getPath(!0,["v_datacollection_summary_phasing_autoProcProgramId"]),b,"h").w('" class="tab-pane fade">').p("plots.autoprocintegrationgrid.template",b,b,{}).w("  </div>                  </div></div></div>")}function c(a,b){return a.w("                                          <kbd style='background-color:orange;'>ANOMALOUS</kbd> ")}return a.register("autoprocintegrationgrid.template",b),b.__dustBody=!0,c.__dustBody=!0,b}(dust),function(a){function b(a,b){return a}return a.register("autoprocintegrationgrid_tool",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div class=\"container-fluid containerWithScroll\"><div class=\"row\"><div class=\"col-xs-12 col-md-2\"><table style='width: 100px;font-size:10px' class='table'><tbody><tr><th class='innershell' >InnerShell</th><th class='overallshell' >Overall</th><th class='outershell' >OuterShell</th></tr></tbody></table><table class=\"table table-striped table-hover\"><thead><tr><th  ></th><th  ></th><th  >Pipeline</th><th  >SpaceGroup</th><th  >A</th><th > B</th><th > C</th><th  >&#x3B1;</th><th >&beta;</th><th >&gamma;</th><th >Resolution</th><th >Multiplicity</th><th >Completeness</th><th >I/Sigma</th><th >Rmeas</th> <th >Rmerge</th><th >Rpim</th><th >cc(1/2)</th><th >ccAno</th><th >sigAno</th><th >ISA</th><th >Download</th></tr></thead>").s(b.getPath(!0,[]),b,{block:c},{}).w("</table> </div></div></div>")}function c(a,b){return a.h("lt",b,{"else":d,block:e},{key:b.getPath(!1,["innerShell","rMerge"]),value:10},"h").w("<td  >").h("eq",b,{"else":i,block:j},{key:b.get(["v_datacollection_summary_phasing_anomalous"],!1),type:"boolean",value:"true"},"h").w("</td>").x(b.get(["label"],!1),b,{"else":k,block:l},{}).w('<td  ><a target="_blank" href=\'#/autoprocintegration/datacollection/').f(b.getPath(!0,["AutoProcIntegration_dataCollectionId"]),b,"h").w("/main'>").f(b.getPath(!0,["v_datacollection_processingPrograms"]),b,"h").w("</a></td><td  >").f(b.getPath(!0,["v_datacollection_summary_phasing_autoproc_space_group"]),b,"h").w("</td><td  >").h("decimal",b,{block:o},{key:"v_datacollection_summary_phasing_cell_a",decimals:1},"h").w("</td><td >").h("decimal",b,{block:p},{key:"v_datacollection_summary_phasing_cell_b",decimals:1},"h").w("</td><td >").h("decimal",b,{block:q},{key:"v_datacollection_summary_phasing_cell_c",decimals:1},"h").w("</td><td  >").h("decimal",b,{block:r},{key:"v_datacollection_summary_phasing_cell_alpha",decimals:1},"h").w("</td><td >").h("decimal",b,{block:s},{key:"v_datacollection_summary_phasing_cell_beta",decimals:1},"h").w("</td><td >").h("decimal",b,{block:t},{key:"v_datacollection_summary_phasing_cell_gamma",decimals:1},"h").w("</td><td ><span class='innershell'>").f(b.getPath(!0,["innerShell","resolutionLimitLow"]),b,"h").w("-").f(b.getPath(!0,["innerShell","resolutionLimitHigh"]),b,"h").w(" </span><br /><span class='overallshell'>").f(b.getPath(!0,["overall","resolutionLimitLow"]),b,"h").w("-").f(b.getPath(!0,["overall","resolutionLimitHigh"]),b,"h").w(" </span> <br /><span class='outershell'>").f(b.getPath(!0,["outerShell","resolutionLimitLow"]),b,"h").w("-").f(b.getPath(!0,["outerShell","resolutionLimitHigh"]),b,"h").w("</span></td><td >               <span class='innershell'>").f(b.getPath(!0,["innerShell","multiplicity"]),b,"h").w(" </span><br /><span class='overallshell'>").f(b.getPath(!0,["overall","multiplicity"]),b,"h").w("</span> <br /><span class='outershell'>").f(b.getPath(!0,["outerShell","multiplicity"]),b,"h").w("</span></td><td > <span class='innershell'>").f(b.getPath(!0,["innerShell","completeness"]),b,"h").w(" </span><br /><span class='overallshell'>").f(b.getPath(!0,["overall","completeness"]),b,"h").w("</span><br /><span class='outershell'>").f(b.getPath(!0,["outerShell","completeness"]),b,"h").w("</span></td><td ><span class='innershell'>").f(b.getPath(!0,["innerShell","meanIOverSigI"]),b,"h").w(" </span><br /><span class='overallshell'>").f(b.getPath(!0,["overall","meanIOverSigI"]),b,"h").w("</span><br /><span class='outershell'>").f(b.getPath(!0,["outerShell","meanIOverSigI"]),b,"h").w("</span></td><td ><span class='innershell'>").f(b.getPath(!0,["innerShell","rMeasAllIPlusIMinus"]),b,"h").w(" </span><br /><span class='overallshell'>").f(b.getPath(!0,["overall","rMeasAllIPlusIMinus"]),b,"h").w("</span><br /><span class='outershell'>").f(b.getPath(!0,["outerShell","rMeasAllIPlusIMinus"]),b,"h").w("</span></td><td >").h("lt",b,{"else":u,block:v},{key:b.getPath(!1,["innerShell","rMerge"]),value:10},"h").w("<span class='overallshell'>").f(b.getPath(!0,["overall","rMerge"]),b,"h").w("</span> <span class='outershell'>").f(b.getPath(!0,["outerShell","rMerge"]),b,"h").w("</span></td><td ><span class='innershell'>").f(b.getPath(!0,["innerShell","rPimWithinIPlusIMinus"]),b,"h").w(" </span><br /><span class='overallshell'>").f(b.getPath(!0,["overall","rPimWithinIPlusIMinus"]),b,"h").w("</span> <br /><span class='outershell'>").f(b.getPath(!0,["outerShell","rPimWithinIPlusIMinus"]),b,"h").w("</span></td><td >").x(b.getPath(!1,["innerShell","ccHalf"]),b,{block:w},{}).x(b.getPath(!1,["overall","ccHalf"]),b,{block:x},{}).x(b.getPath(!1,["outerShell","ccHalf"]),b,{block:y},{}).w("</td><td><span class='innershell'>").f(b.getPath(!0,["innerShell","ccAno"]),b,"h").w(" </span><br /><span class='overallshell'>").f(b.getPath(!0,["overall","ccAno"]),b,"h").w("</span> <br /><span class='outershell'>").f(b.getPath(!0,["outerShell","ccAno"]),b,"h").w("</span><br /></td><td><span class='innershell'>").f(b.getPath(!0,["innerShell","sigAno"]),b,"h").w(" </span><br /><span class='overallshell'>").f(b.getPath(!0,["overall","sigAno"]),b,"h").w("</span> <br /><span class='outershell'>").f(b.getPath(!0,["outerShell","sigAno"]),b,"h").w("</span>                                       </td><td  >").f(b.getPath(!0,["isa"]),b,"h").w("</td><td ><a href='").f(b.getPath(!0,["downloadFilesUrl"]),b,"h").w("' ><span style='font-size: 1.5em;' class=\"glyphicon glyphicon-download \" ></span></a></td></tr>")}function d(a,b){return a.w("<tr style='background-color:#ffddcc;'>")}function e(a,b){return a.x(b.get(["label"],!1),b,{block:f},{}).w("  ")}function f(a,b){return a.h("eq",b,{"else":g,block:h},{key:b.get(["label"],!1),value:"BEST"},"h").w(" ")}function g(a,b){return a.w(" <tr style='background-color:#ffffff;'>")}function h(a,b){return a.w("<tr style='background-color:#e6ffe6;'>")}function i(a,b){return a}function j(a,b){return a.w('<kbd style="FONT-FAMILY:helvetica, arial, verdana, sans-serif;background-color:#337ab7">ANOM</kbd>')}function k(a,b){return a.w("<td  >").f(b.getPath(!0,["rank"]),b,"h").w("</td>")}function l(a,b){return a.h("eq",b,{"else":m,block:n},{key:b.get(["label"],!1),value:"BEST"},"h")}function m(a,b){return a.w('<td  > <kbd style="background-color:orange">').f(b.getPath(!0,["label"]),b,"h").w("</kbd></td>")}function n(a,b){return a.w('<td >  <kbd style="background-color:green">').f(b.getPath(!0,["label"]),b,"h").w("</kbd></td>")}function o(a,b){return a}function p(a,b){return a}function q(a,b){return a}function r(a,b){return a}function s(a,b){return a}function t(a,b){return a}function u(a,b){return a.w("<span class='innershell' style='font-weight:700;color:red;'>").f(b.getPath(!0,["innerShell","rMerge"]),b,"h").w(" </span>")}function v(a,b){return a.w("<span class='innershell'>").f(b.getPath(!0,["innerShell","rMerge"]),b,"h").w(" </span>")}function w(a,b){return a.w("<span class='innershell'>").h("math",b,{},{key:100,method:"multiply",operand:b.getPath(!1,["innerShell","ccHalf"])},"h").w("%  </span><br />")}function x(a,b){return a.w("<span class='overallshell'>").h("math",b,{},{key:100,method:"multiply",operand:b.getPath(!1,["overall","ccHalf"])},"h").w("%  </span><br />")}function y(a,b){return a.w("<span class='outershell'>").h("math",b,{},{key:100,method:"multiply",operand:b.getPath(!1,["outerShell","ccHalf"])},"h").w("%  </span><br />")}return a.register("collapsed.autoprocintegrationgrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,p.__dustBody=!0,q.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,t.__dustBody=!0,u.__dustBody=!0,v.__dustBody=!0,w.__dustBody=!0,x.__dustBody=!0,y.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w(' <div class="container-fluid" class=\'containerWithScroll\' ><div class="row"><div class="col-xs-12 col-md-2" >        <table class="table"  ><thead><tr><th>Name</th><th>Type</th><th>Path</th></tr></thead>').s(b.getPath(!0,[]),b,{block:c},{}).w("    </table></div></div></div>")}function c(a,b){return a.w("<tbody><tr><td><a href='").f(b.getPath(!0,["url"]),b,"h").w("'>").f(b.getPath(!0,["fileName"]),b,"h").w("</a></td> <td>").f(b.getPath(!0,["fileType"]),b,"h").w("</td> <td>").f(b.getPath(!0,["filePath"]),b,"h").w("</td></tr></tbody>")}return a.register("files.autoprocintegrationgrid.template",b),b.__dustBody=!0,c.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table class='table-sm table table-striped'>").s(b.getPath(!0,["phasing","0"]),b,{block:c},{}).w("<tbody>               ").s(b.getPath(!0,["phasing"]),b,{block:d},{}).w("</tbody></table>")}function c(a,b){return a.w('	<thead>   <tr><th>Phasing</th><th><abbr title="Prepare Step">PR</abbr></th><th><abbr title="Substructure Determination Step">SU</abbr></th><th><abbr title="Phasing Step">PH</abbr></th><th><abbr title="Model Building Step">MO</abbr></th></tr></thead>')}function d(a,b){return a.w("		<tr><td><a href='#/phasing/autoprocintegrationId/").f(b.getPath(!0,["autoProcIntegrationId"]),b,"h").w("/main'>").f(b.getPath(!0,["spaceGroup"]),b,"h").w("</a></td><td>").h("eq",b,{"else":e,block:f},{key:b.get(["prepare"],!1),type:"boolean",value:"true"},"h").w("</td><td>").h("eq",b,{"else":g,block:h},{key:b.get(["sub"],!1),type:"boolean",value:"true"},"h").w("</td><td>").h("eq",b,{"else":i,block:j},{key:b.get(["phasing"],!1),type:"boolean",value:"true"},"h").w("</td><td>").h("eq",b,{"else":k,block:l},{key:b.get(["model"],!1),type:"boolean",value:"true"},"h").w("</td></tr>")}function e(a,b){return a.w("<span style='color:red;' class=\"glyphicon glyphicon-remove\"></span>")}function f(a,b){return a.w("<span style='color:green;' class=\"glyphicon glyphicon-ok\"></span>")}function g(a,b){return a.w("<span style='color:red;' class=\"glyphicon glyphicon-remove\"></span>")}function h(a,b){return a.w("<span style='color:green;' class=\"glyphicon glyphicon-ok\"></span>")}function i(a,b){return a.w("<span style='color:red;' class=\"glyphicon glyphicon-remove\"></span>")}function j(a,b){return a.w("<span style='color:green;' class=\"glyphicon glyphicon-ok\"></span>")}function k(a,b){return a.w("<span style='color:red;' class=\"glyphicon glyphicon-remove\"></span>")}function l(a,b){return a.w("<span style='color:green;' class=\"glyphicon glyphicon-ok\"></span>")}return a.register("phasing.autoprocintegrationgrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w(' <div class="container-fluid"><div class="row"><div id=\'rFactor_').f(b.getPath(!0,["v_datacollection_summary_phasing_autoProcProgramId"]),b,"h").w('\' class="col-xs-12 col-md-4">                   1   ').f(b.getPath(!0,["v_datacollection_summary_phasing_autoProcProgramId"]),b,"h").w("                        </div><div id='completeness_").f(b.getPath(!0,["v_datacollection_summary_phasing_autoProcProgramId"]),b,"h").w("' class=\"col-xs-12 col-md-4\">                    2                        </div><div id='sigmaI_").f(b.getPath(!0,["v_datacollection_summary_phasing_autoProcProgramId"]),b,"h").w('\' class="col-xs-12 col-md-4">3                    </div></div><div class="row"><div id=\'cc2_').f(b.getPath(!0,["v_datacollection_summary_phasing_autoProcProgramId"]),b,"h").w("' class=\"col-xs-12 col-md-4\">                   4                           </div><div id='sigmaAnno_").f(b.getPath(!0,["v_datacollection_summary_phasing_autoProcProgramId"]),b,"h").w("' class=\"col-xs-12 col-md-4\">                    5                       </div><div id='anno_").f(b.getPath(!0,["v_datacollection_summary_phasing_autoProcProgramId"]),b,"h").w('\' class="col-xs-12 col-md-4">6                    </div></div></div>')}return a.register("plots.autoprocintegrationgrid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table class='table-sm table table-striped'><thead><tr><th style='padding:0 15px 0 15px;'>Data Range</th><th style='padding:0 15px 0 15px;'>Resolution</th><th style='padding:0 15px 0 15px;'>Multiplicity</th><th style='padding:0 15px 0 15px;'>Completeness</th><th  style='padding:0 15px 0 15px;'>I/Sigmal</th><th style='padding:0 15px 0 15px;'>Rmeas</th><th style='padding:0 15px 0 15px;'>Rmerge</th><th style='padding:0 15px 0 15px;'>Rpim</th><th style='padding:0 15px 0 15px;'>cc(1/2)</th></tr></thead><tbody>").s(b.getPath(!0,["statistics"]),b,{block:c},{}).w("<tbody></table>")}function c(a,b){return a.w("<tr><td>").f(b.getPath(!0,["type"]),b,"h").w("</td><td >").h("decimal",b,{block:d},{key:"resolutionLimitLow",decimals:1},"h").w(" - ").h("decimal",b,{block:e},{key:"resolutionLimitHigh",decimals:1},"h").w("</td><td >").h("decimal",b,{block:f},{key:"multiplicity",decimals:1},"h").w("</td><td > ").h("gt",b,{block:g},{key:b.get(["completeness"],!1),value:20},"h").h("lte",b,{block:l},{key:b.get(["completeness"],!1),value:20},"h").w("</td><td > ").h("decimal",b,{block:n},{key:"meanIOverSigI",decimals:1},"h").w("</td><td > ").h("decimal",b,{block:o},{key:"rMeasAllIPlusIMinus",decimals:1},"h").w("</td><td > ").h("decimal",b,{block:p},{key:"rMerge",decimals:1},"h").w("</td><td > ").h("decimal",b,{block:q},{key:"rPimWithinIPlusIMinus",decimals:1},"h").w("</td><td > ").h("decimal",b,{block:r},{key:"ccHalf",decimals:1},"h").w("</td></tr>	")}function d(a,b){return a}function e(a,b){return a}function f(a,b){return a}function g(a,b){return a.h("gt",b,{"else":h,block:j},{key:b.get(["completeness"],!1),value:60},"h")}function h(a,b){return a.w('<div  style="background-repeat: repeat-x;border:1px solid #f0ad4e;color:#fff;background-color:#f0ad4e;width:').f(b.getPath(!0,["completeness"]),b,"h").w('%">                        ').h("decimal",b,{block:i},{key:"completeness",decimals:0},"h").w("%</div>")}function i(a,b){return a}function j(a,b){return a.w('<div  style="background-repeat: repeat-x;border:1px solid gray;color:#fff;background-image:linear-gradient(to bottom,#337ab7 0,#286090 100%);width:').f(b.getPath(!0,["completeness"]),b,"h").w('%">').h("decimal",b,{block:k},{key:"completeness",decimals:0},"h").w("%</div>")}function k(a,b){return a}function l(a,b){return a.w('<div  style="background-repeat: repeat-x;border:1px solid #d9534f;color:#fff;background-color:#d9534f;width:').f(b.getPath(!0,["completeness"]),b,"h").w('%">').h("decimal",b,{block:m},{key:"completeness",decimals:0},"h").w("%</div>")}function m(a,b){return a}function n(a,b){return a}function o(a,b){return a}function p(a,b){return a}function q(a,b){return a}function r(a,b){return a}return a.register("statistics.autoprocintegrationgrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,p.__dustBody=!0,q.__dustBody=!0,r.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table class='table table-striped'><thead>   <tr><th  style='padding:0 15px 0 15px;'>Cell A</th><th style='padding:0 15px 0 15px;'>Cell B</th><th style='padding:0 15px 0 15px;'>Cell C</th></tr></thead><tbody><tr><td  style='padding:0 15px 0 15px;'>").h("decimal",b,{block:c},{key:"v_datacollection_summary_phasing_cell_a",decimals:1},"h").w("</td><td style='padding:0 15px 0 15px;'>").h("decimal",b,{block:d},{key:"v_datacollection_summary_phasing_cell_b",decimals:1},"h").w("</td><td style='padding:0 15px 0 15px;'>").h("decimal",b,{block:e},{key:"v_datacollection_summary_phasing_cell_c",decimals:1},"h").w("</td></tr></tbody></table><table class='table table-striped'><thead>   <tr><th  style='padding:0 15px 0 15px;'>Alpha</th><th style='padding:0 15px 0 15px;'>Beta</th><th style='padding:0 15px 0 15px;'>Gamma</th></tr></thead><tbody><tr><td  style='padding:0 15px 0 15px;'>").h("decimal",b,{block:f},{key:"v_datacollection_summary_phasing_cell_alpha",decimals:1},"h").w("</td><td style='padding:0 15px 0 15px;'>").h("decimal",b,{block:g},{key:"v_datacollection_summary_phasing_cell_beta",decimals:1},"h").w("</td><td style='padding:0 15px 0 15px;'>").h("decimal",b,{block:h},{key:"v_datacollection_summary_phasing_cell_gamma",decimals:1},"h").w("</td></tr></tbody></table>")}function c(a,b){return a}function d(a,b){return a}function e(a,b){return a}function f(a,b){return a}function g(a,b){return a}function h(a,b){return a}return a.register("unitcell.autoprocintegrationgrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table> <tr><td>Acronym:</td><td style='color:#207a7a;font-weight:bold;'>").f(b.getPath(!0,["proteinVO","acronym"]),b,"h").w("</td></tr><tr><td>Name:</td><td>").f(b.getPath(!0,["proteinVO","name"]),b,"h").w("</td></tr><tr><td>Experiment:</td><td>").f(b.getPath(!0,["diffractionPlanVO","experimentKind"]),b,"h").w("</td></tr><tr><td>Space Group:</td><td>").f(b.getPath(!0,["spaceGroup"]),b,"h").w("</td></tr></table>")}return a.register("crystal.listview",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.s(b.getPath(!0,["onlineresults","0"]),b,{block:c},{})}function c(a,b){return a.w("       ").p("completeness.autoproc.mxdatacollectiongrid.template",b,b,{}).w("<br />                    ").p("unitcell.autoproc.mxdatacollectiongrid.template",b,b,{}).w("         ")}return a.register("autoproc.mxdatacollectiongrid.template",b),b.__dustBody=!0,c.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table class=\"table\">                    <tr><td>Number of passes</td><td  class='column_parameter_value'> ").f(b.getPath(!0,["DataCollection_numberOfPasses"]),b,"h").w("</td></tr><tr><td>Detector Distance</td><td  class='column_parameter_value'>").f(b.getPath(!0,["DataCollection_detectorDistance"]),b,"h").w(" mm</td></tr><tr><td>X Beam</td><td  class='column_parameter_value'>").f(b.getPath(!0,["DataCollection_xBeam"]),b,"h").w("</td></tr><tr><td>Y Beam</td><td  class='column_parameter_value'>").f(b.getPath(!0,["DataCollection_yBeam"]),b,"h").w("</td></tr><tr><td>Kappa Start</td><td  class='column_parameter_value'>").f(b.getPath(!0,["DataCollection_kappaStart"]),b,"h").w("</td></tr><tr><td>Phi Start</td><td  class='column_parameter_value'>").h("eq",b,{"else":c,block:d},{key:b.get(["DataCollection_phiStart"],!1),type:"number",value:-9999},"h").w("</td></tr></table>       ")}function c(a,b){return a.f(b.getPath(!0,["DataCollection_phiStart"]),b,"h")}function d(a,b){return a.w("N/A")}return a.register("beamline.mxdatacollectiongrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid"><div class="row"><div class="col-xs-6 col-md-1">#').f(b.getPath(!0,["DataCollection_dataCollectionNumber"]),b,"h").w(" ").f(b.getPath(!0,["DataCollectionGroup_experimentType"]),b,"h").w(" <br />").h("formatDate",b,{},{date:b.get(["DataCollectionGroup_startTime"],!1),format:"DD-MM-YYYY hh:mm:ss"},"h").w("</div><div class=\"col-xs-6 col-md-2\"><table class='table-sm table-condensed '><thead><tr><th  colspan=2 style='padding:0 15px 0 15px;'> </th></tr></thead><tbody><tr><td  style='padding:0 15px 0 15px;'>Protein</td><td  style='padding:0 15px 0 15px;' class='column_parameter_value'>").f(b.getPath(!0,["Protein_acronym"]),b,"h").w("</td></tr><tr><td  style='padding:0 15px 0 15px;'>Prefix</td><td  style='padding:0 15px 0 15px;'><a href='#/mx/datacollection/datacollectionid/").f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w("/main'>").f(b.getPath(!0,["DataCollection_imagePrefix"]),b,"h").w("</a></td></tr><tr><td  style='padding:0 15px 0 15px;'>Images</td><td  style='padding:0 15px 0 15px;' class='column_parameter_value'>").f(b.getPath(!0,["totalNumberOfImages"]),b,"h").w("</td></tr></tbody></table></div><div class=\"col-xs-6 col-md-2\"><table class='table-sm table-condensed'><thead><tr><th  colspan=2 style='padding:0 15px 0 15px;'></th></tr></thead><tbody><tr><td  style='padding:0 15px 0 15px;'>Type</td><td  style='padding:0 15px 0 15px;' class='column_parameter_value'>").f(b.getPath(!0,["DataCollectionGroup_experimentType"]),b,"h").w("</td></tr><tr><td  style='padding:0 15px 0 15px;'>Res. (corner)</td><td  style='padding:0 15px 0 15px;' class='column_parameter_value'>").f(b.getPath(!0,["DataCollection_resolution"]),b,"h").w(" &#8491; (").f(b.getPath(!0,["DataCollection_resolutionAtCorner"]),b,"h").w(" &#8491;)</td></tr><tr><td  style='padding:0 15px 0 15px;'>Wavelenth</td><td  style='padding:0 15px 0 15px;' class='column_parameter_value'>").f(b.getPath(!0,["DataCollection_wavelength"]),b,"h").w(' &#8491;</td></tr></tbody></table></div><div class="col-xs-1 col-md-1"> <a href="').f(b.getPath(!0,["indicator"]),b,"h").w("\" data-lightbox='").f(b.getPath(!0,["indicator"]),b,"h").w("' data-title=\"#").f(b.getPath(!0,["runNumber"]),b,"h").w(" ").f(b.getPath(!0,["folder"]),b,"h").w('"> <img alt="Image not found" class="img-responsive lazy"  src="').f(b.getPath(!0,["indicator"]),b,"h").w('" style=\'height:60px;width:60px\'/></a> </div><div class="col-xs-6 col-md-2">').s(b.getPath(!0,["onlineresults","0"]),b,{block:c},{}).w('                           </div><div class="col-xs-12 col-md-2">').s(b.getPath(!0,["onlineresults","0"]),b,{block:d},{}).w("                           </div><div class=\"col-sm-2 col-md-1 \" style='margin: 0 10px 10px 0;'>").s(b.getPath(!0,["autoprocessing"]),b,{block:e},{}).w("</div><div class=\"col-sm-2 col-md-1 \" style='margin: 0 10px 10px 0;'>").s(b.getPath(!0,["screening"]),b,{block:k
},{}).w("</div></div></div>")}function c(a,b){return a.w("       ").p("sm.completeness.autoproc.mxdatacollectiongrid.template",b,b,{})}function d(a,b){return a.w("       ").p("unitcell.autoproc.mxdatacollectiongrid.template",b,b,{}).w("       ")}function e(a,b){return a.h("gt",b,{block:f},{key:b.getPath(!1,["items","length"]),value:0},"h")}function f(a,b){return a.w("  ").s(b.getPath(!0,[]),b,{block:g},{}).w(" ")}function g(a,b){return a.w("<table class='table-sm table-condensed'>").s(b.getPath(!0,["items"]),b,{block:h},{}).w("</table>")}function h(a,b){return a.w("<tr>").h("eq",b,{block:i},{key:b.get(["status"],!1),value:"Success"},"h").h("ne",b,{block:j},{key:b.get(["status"],!1),value:"Success"},"h").w("</tr>")}function i(a,b){return a.w("<td> <span style='color:green;' class=\"glyphicon glyphicon-ok\"></span></td><td>").f(b.getPath(!0,["name"]),b,"h").w(" </td>")}function j(a,b){return a.w(" <td> <span style='color:red;' class=\"glyphicon glyphicon-remove\"></span></td><td>").f(b.getPath(!0,["name"]),b,"h").w(" </td>")}function k(a,b){return a.h("gt",b,{block:l},{key:b.getPath(!1,["items","length"]),value:0},"h")}function l(a,b){return a.w("  ").s(b.getPath(!0,[]),b,{block:m},{}).w(" ")}function m(a,b){return a.w("<table class='table-sm table-condensed'>").s(b.getPath(!0,["items"]),b,{block:n},{}).w("</table>")}function n(a,b){return a.w("<tr>").h("eq",b,{block:o},{key:b.get(["status"],!1),value:"Success"},"h").h("ne",b,{block:p},{key:b.get(["status"],!1),value:"Success"},"h").w("</tr>")}function o(a,b){return a.w("<td> <span style='color:green;' class=\"glyphicon glyphicon-ok\"></span></td><td>").f(b.getPath(!0,["name"]),b,"h").w(" </td>")}function p(a,b){return a.w(" <td> <span style='color:red;' class=\"glyphicon glyphicon-remove\"></span></td><td>").f(b.getPath(!0,["name"]),b,"h").w(" </td>")}return a.register("collapsed.mxdatacollectiongrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,p.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table class='table-sm'><thead><tr><th>             ").f(b.getPath(!0,["spaceGroup"]),b,"h").w("             </th><th style='padding:0 15px 0 15px;'>Completeness</th><th style='padding:0 15px 0 15px;'>Res.</th><th>Rmerge</th></tr><tr><td valign=\"top\">Inner</td><td><div class=\"progress\">").h("gte",b,{"else":c,block:d},{key:b.getPath(!1,["innerShell","completeness"]),value:50},"h").w("</div></td><td valign=\"top\" style='padding:0 15px 0 15px;'>").f(b.getPath(!0,["innerShell","resolutionsLimitHigh"]),b,"h").w('</td><td valign="top">').f(b.getPath(!0,["innerShell","rMerge"]),b,"h").w('</td></tr> <tr><td valign="top">Outer</td><td><div class="progress">').h("gte",b,{"else":g,block:h},{key:b.getPath(!1,["outerShell","completeness"]),value:50},"h").w("</div></td><td valign=\"top\" style='padding:0 15px 0 15px;'>").f(b.getPath(!0,["outerShell","resolutionsLimitHigh"]),b,"h").w('</td><td valign="top">').f(b.getPath(!0,["outerShell","rMerge"]),b,"h").w('</td></tr><tr><td valign="top">Overall</td><td><div class="progress">').h("gte",b,{"else":k,block:l},{key:b.getPath(!1,["overall","completeness"]),value:50},"h").w("</div></td><td valign=\"top\"  style='padding:0 15px 0 15px;'>").f(b.getPath(!0,["overall","resolutionsLimitHigh"]),b,"h").w('</td><td valign="top">').f(b.getPath(!0,["overall","rMerge"]),b,"h").w("</td></tr></thead></table>")}function c(a,b){return a.w('    <div class="progress-bar progress-bar"  role="progressbar" aria-valuenow="').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w('" aria-valuemin="0" aria-valuemax="100" style="background-color:#d9534f;width:').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w('%">').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w("%</div>")}function d(a,b){return a.h("gte",b,{"else":e,block:f},{key:b.getPath(!1,["innerShell","completeness"]),value:90},"h")}function e(a,b){return a.w('<div class="progress-bar progress-bar"  role="progressbar" aria-valuenow="').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w('" aria-valuemin="0" aria-valuemax="100" style="background-color:#f0ad4e;width:').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w('%">').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w("%</div>")}function f(a,b){return a.w('                            <div class="progress-bar progress-bar"  role="progressbar" aria-valuenow="').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w('" aria-valuemin="0" aria-valuemax="100" style="width:').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w('%">').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w("%</div>")}function g(a,b){return a.w('    <div class="progress-bar progress-bar"   role="progressbar" aria-valuenow="').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w('" aria-valuemin="0" aria-valuemax="100" style="background-color:#d9534f;width:').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w('%">').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w("%</div>")}function h(a,b){return a.h("gte",b,{"else":i,block:j},{key:b.getPath(!1,["outerShell","completeness"]),value:90},"h")}function i(a,b){return a.w('<div class="progress-bar progress-bar"   role="progressbar" aria-valuenow="').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w('" aria-valuemin="0" aria-valuemax="100" style="background-color:#f0ad4e;width:').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w('%">').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w("%</div>")}function j(a,b){return a.w('                            <div class="progress-bar progress-bar"   role="progressbar" aria-valuenow="').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w('" aria-valuemin="0" aria-valuemax="100" style="width:').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w('%">').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w("%</div>")}function k(a,b){return a.w('    <div class="progress-bar progress-bar"   role="progressbar" aria-valuenow="').f(b.getPath(!0,["overall","completeness"]),b,"h").w('" aria-valuemin="0" aria-valuemax="100" style="background-color:#d9534f;width:').f(b.getPath(!0,["overall","completeness"]),b,"h").w('%">').f(b.getPath(!0,["overall","completeness"]),b,"h").w("%</div>")}function l(a,b){return a.h("gte",b,{"else":m,block:n},{key:b.getPath(!1,["overall","completeness"]),value:90},"h")}function m(a,b){return a.w('<div class="progress-bar progress-bar"   role="progressbar" aria-valuenow="').f(b.getPath(!0,["overall","completeness"]),b,"h").w('" aria-valuemin="0" aria-valuemax="100" style="background-color:#f0ad4e;width:').f(b.getPath(!0,["overall","completeness"]),b,"h").w('%">').f(b.getPath(!0,["overall","completeness"]),b,"h").w("%</div>")}function n(a,b){return a.w('                            <div class="progress-bar progress-bar"   role="progressbar" aria-valuenow="').f(b.getPath(!0,["overall","completeness"]),b,"h").w('" aria-valuemin="0" aria-valuemax="100" style="width:').f(b.getPath(!0,["overall","completeness"]),b,"h").w('%">').f(b.getPath(!0,["overall","completeness"]),b,"h").w("%</div>")}return a.register("completeness.autoproc.mxdatacollectiongrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,n.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table class='table-sm table-condensed '><thead><tr><th  colspan=2 style='padding:0 15px 0 15px;'> </th></tr></thead><tbody><tr><td  style='padding:0 15px 0 15px;'>Container</td><td  style='padding:0 15px 0 15px;' class='column_parameter_value'>").f(b.get(["container_code"],!1),b,"h").w("</td></tr></tbody> </table>")}return a.register("containers.info.mxdatacollectiongrid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid"><div class="row">').x(b.get(["containerIds"],!1),b,{"else":c,block:d},{}).w("</div></div>")}function c(a,b){return a.w("<p><b>There were no containers found</b></p>")}function d(a,b){return a.s(b.get(["containerIds"],!1),b,{block:e},{})}function e(a,b){return a.w('<div class="col-xs-3 col-md-').h("math",b,{},{key:"12",method:"divide",operand:f,style:"padding:3cm"},"h").w('"><div id="puck-panel-').f(b.getPath(!0,[]),b,"h").w('" style="padding-top:30px;">There were no containers found</div><div id="puck-panel-').f(b.getPath(!0,[]),b,"h").w('-info" ></div></div>')}function f(a,b){return a.f(b.get(["$len"],!1),b,"h")}return a.register("containers.mxdatacollectiongrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div id='hoveringTooltipDiv' pointer-events='none' class='cell_info_tooltip'><b>Sample:</b> ").f(b.get(["sample_name"],!1),b,"h").w("<br/><b>Protein acronym:</b> ").f(b.get(["protein_acronym"],!1),b,"h").w("</div>")}return a.register("containers.tooltip.mxdatacollectiongrid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script><div class="container-fluid containerWithScroll" ><div class="row"><div class="col-xs-12 col-md-2">        <table class="table table-striped table-hover"><thead><tr><th>Run</th><th>Prefix</th><th>#Images</th><th>Exposure<br/>Time</th><th>Res. (corner)</th><th>Wavelength</th><th>Transmission</th><th>Directory</th><th>Time</th><th>Run status</th><th>Indicators</th><th>Results</th><th>Phasing</th><th></th></tr></thead>').s(b.getPath(!0,[]),b,{block:c},{}).w("    </table></div></div></div>")}function c(a,b){return a.h("eq",b,{"else":d,block:e},{key:b.get(["runStatus"],!1),value:"failed"},"h").w("    <td>#").f(b.getPath(!0,["dataCollectionNumber"]),b,"h").w("</td><td>").f(b.getPath(!0,["imagePrefix"]),b,"h").w("</td><td ><span class=\"badge\" style='background-color:#337ab7;'>").f(b.getPath(!0,["numberOfImages"]),b,"h").w("</span></td><td >").f(b.getPath(!0,["exposureTime"]),b,"h").w(" s</td><td >").h("decimal",b,{block:f},{key:"resolution",decimals:1},"h").w(" &#8491; (").h("decimal",b,{block:g},{key:"resolutionAtCorner",decimals:1},"h").w(" &#8491;)</td><td > ").h("decimal",b,{block:h},{key:"wavelength",decimals:1},"h").w(" &#8491;</td><td>").h("decimal",b,{},{key:"transmission",decimals:2,intIfPossible:"true"},"h").w('%</td><td><button type="button" class="btn btn-sm" data-toggle="modal" data-target="#myModal').f(b.getPath(!0,["dataCollectionId"]),b,"h").w('"><span class="glyphicon glyphicon-folder-close" aria-hidden="true"></span></button><!-- Modal --><div class="modal fade" id="myModal').f(b.getPath(!0,["dataCollectionId"]),b,"h").w('" role="dialog"><div class="modal-dialog"><!-- Modal content--><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">Image directory</h4></div><div class="modal-body"><h4>').f(b.getPath(!0,["imageDirectory"]),b,"h").w('</h4></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div></div></div></div></td><td>').f(b.getPath(!0,["formattedStartTime"]),b,"h").w("</td><td>").f(b.getPath(!0,["runStatus"]),b,"h").w("</td><td><a href=").f(b.getPath(!0,["urlImageQualityIndicators"]),b,"h").w(" data-lightbox=").f(b.getPath(!0,["urlImageQualityIndicators"]),b,"h").w(" ><img src=").f(b.getPath(!0,["urlImageQualityIndicators"]),b,"h").w(' height="35px" width="35px"/></a></td><td>').h("gt",b,{block:i},{key:b.get(["hasAutoProcessing"],!1),value:0},"h").w("</td><td>").h("gt",b,{block:j},{key:b.get(["hasPhasing"],!1),value:0},"h").w("</td><td>").s(b.getPath(!0,["onlineresults","0"]),b,{block:k},{}).w("</td></tr>")}function d(a,b){return a.w("<tr>")}function e(a,b){return a.w('<tr class="danger">')}function f(a,b){return a}function g(a,b){return a}function h(a,b){return a}function i(a,b){return a.w("<a target='blank' href=\"#/autoprocintegration/datacollection/").f(b.getPath(!0,["dataCollectionId"]),b,"h").w('/main"><span class="badge" style=\'background-color:#337ab7;\'>').f(b.getPath(!0,["hasAutoProcessing"]),b,"h").w("</span></a>")}function j(a,b){return a.w("<div class='summary_datacollection_success'></div>")}function k(a,b){return a.w(" ").p("sm.completeness.autoproc.mxdatacollectiongrid.template",b,b,{})}return a.register("datacollections.mxdatacollectiongrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table class=\"table\">                    <tr><td>Detector Type</td><td  class='column_parameter_value'> ").f(b.getPath(!0,["detectorType"]),b,"h").w("</td></tr><tr><td>Detector Model</td><td  class='column_parameter_value'>").f(b.getPath(!0,["detectorModel"]),b,"h").w("</td></tr><tr><td>Manufacturer</td><td  class='column_parameter_value'>").f(b.getPath(!0,["detectorManufacturer"]),b,"h").w("</td></tr><tr><td>Hor. Pixel Size</td><td  class='column_parameter_value'>").f(b.getPath(!0,["detectorPixelSizeHorizontal"]),b,"h").w("</td></tr><tr><td>Ver. Pixel Size</td><td  class='column_parameter_value'>").f(b.getPath(!0,["detectorPixelSizeVertical"]),b,"h").w("</td></tr><tr><td>Mode</td><td  class='column_parameter_value'>").f(b.getPath(!0,["detectorMode"]),b,"h").w("</td></tr></table>       ")}return a.register("detector.mxdatacollectiongrid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w(' <div class="col-xs-6 col-md-2"><table class="table"> <tr><td>Kind</td><td class=\'column_parameter_value\'>').f(b.getPath(!0,["experimentKind"]),b,"h").w("</td></tr> <tr><td>Positions</td><td class='column_parameter_value'>").f(b.getPath(!0,["numberOfPositions"]),b,"h").w("</td></tr><tr><td>Observed Res.</td><td class='column_parameter_value'> ").f(b.getPath(!0,["observedResolution"]),b,"h").w(" &#8491;</td></tr><tr><td>Min. Resolution </td><td class='column_parameter_value'>").f(b.getPath(!0,["minimalResolution"]),b,"h").w(" &#8491;</td></tr><tr><td>Max. Resolution</td><td class='column_parameter_value'>").f(b.getPath(!0,["maximalResolution"]),b,"h").w(" &#8491;</td></tr><tr><td>Screening Resolution</td><td class='column_parameter_value'>").f(b.getPath(!0,["screeningResolution"]),b,"h").w(" &#8491;</td></tr></table>       </div>")}return a.register("diffraction.mxdatacollectiongrid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table class=\"table\"><tr><td  >Workflow</td><td class='column_parameter_value'>").h("eq",b,{block:c},{key:b.get(["Workflow_status"],!1),value:"Success"},"h").h("eq",b,{block:d},{key:b.get(["Workflow_status"],!1),value:"Failure"},"h").f(b.getPath(!0,["Workflow_workflowType"]),b,"h").w("</td></tr><tr><td>Protein</td><td class='column_parameter_value'>").f(b.getPath(!0,["Protein_acronym"]),b,"h").w("</td></tr><tr><td>Sample</td><td class='column_parameter_value'>").f(b.getPath(!0,["BLSample_name"]),b,"h").w("</td></tr><tr><td>Prefix</td><td class='column_parameter_value'>").f(b.getPath(!0,["DataCollection_imagePrefix"]),b,"h").w("</td></tr><tr><td>Images</td><td class='column_parameter_value'>").f(b.getPath(!0,["totalNumberOfImages"]),b,"h").w("</td></tr><tr><td>Transmission</td><td class='column_parameter_value'>").h("decimal",b,{},{key:"transmission",decimals:1},"h").w(" %</td></tr><tr><td>Flux start</td><td class='column_parameter_value'>").f(b.getPath(!0,["DataCollection_flux"]),b,"h").w(" ph/sec</td></tr></table>")}function c(a,b){return a.w("<div class='summary_datacollection_success'></div>")}function d(a,b){return a.w("<div class='summary_datacollection_failed'></div>")}return a.register("first.general.mxdatacollectiongrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w(' <div class="col-xs-6 col-md-2">').p("first.general.mxdatacollectiongrid.template",b,b,{}).w('                             </div><div class="col-xs-6 col-md-2">').p("second.general.mxdatacollectiongrid.template",b,b,{}).w("                             </div> ")}return a.register("general.mxdatacollectiongrid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table><tr><td class='summary_datacollection_parameter_name'>Data Coll Group</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["DataCollection_dataCollectionGroupId"]),b,"h").w("</td>        </tr><tr><td class='summary_datacollection_parameter_name'>Data Collection</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w("</td>        </tr><tr><td class='summary_datacollection_parameter_name'>Sample</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["BLSample_blSampleId"]),b,"h").w("</td>        </tr><tr><td class='summary_datacollection_parameter_name'>Crystal</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["BLSample_crystalId"]),b,"h").w("</td>        </tr><tr><td class='summary_datacollection_parameter_name'>Session</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["BLSession_sessionId"]),b,"h").w("</td>        </tr><tr><td class='summary_datacollection_parameter_name'>Protein</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["Protein_proteinId"]),b,"h").w("</td>                </tr><tr><td class='summary_datacollection_parameter_name'>Auto Proc Int.</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["autoProcIntegrationId"]),b,"h").w("</td>                </tr>   <tr><td class='summary_datacollection_parameter_name'>Workflow Steps</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["WorkflowStep_workflowStepId"]),b,"h").w("</td>                </tr> <tr><td class='summary_datacollection_parameter_name'>Shipping</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["shippingId"]),b,"h").w("</td>                </tr>    </table> ")}return a.register("ids.mxdatacollectiongrid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid"><div class="panel with-nav-tabs panel-default"><div class="panel-heading clearfix"><div class="pull-left"><span style=\'font-size:12px;color:blue;\' ><kbd style=\'background-color:#CCCCCC;color:blue;\'>Run #').f(b.getPath(!0,["DataCollection_dataCollectionNumber"]),b,"h").w(" ").f(b.getPath(!0,["DataCollectionGroup_experimentType"]),b,"h").w("</kbd> <span style='color:blue;'>").f(b.getPath(!0,["DataCollectionGroup_startTime"]),b,"h").w("</span>                                   </span><p><b>").f(b.getPath(!0,["DataCollection_imageDirectory"]),b,"h").w('</b></p>      </div><div class="pull-right"><ul class="nav nav-tabs" id="myTabs"><li class="active"><a data-toggle="tab" href="#datacollection_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('"> Summary</a></li><li><a data-toggle="tab" href="#experimentparameters_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('">Beamline Parameters</a></li>               <li><a data-toggle="tab" href="#dc_').f(b.getPath(!0,["DataCollectionGroup_dataCollectionGroupId"]),b,"h").w('">Data Collections <span class="badge" style=\'background-color:#337ab7;\'>').f(b.getPath(!0,["totalNumberOfDataCollections"]),b,"h").w('</span></a></li><li><a data-toggle="tab" href="#sa_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('">Sample</a></li>').h("gt",b,{"else":c,block:d},{key:b.get(["resultsCount"],!1),value:"0"},"h").h("gt",b,{"else":e,block:f},{key:b.getPath(!1,["workflows","length"]),value:"0"},"h").h("gt",b,{"else":g,block:h},{key:b.get(["hasPhasing"],!1),value:"0"},"h").w('</ul></div></div><br /><div class="tab-content"><div id="datacollection_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" class="tab-pane fade in active"><div class="container-fluid"><div class="row">').p("general.mxdatacollectiongrid.template",b,b,{}).w('<div class="col-xs-12 col-md-2">  ').h("eq",b,{block:i},{key:b.get(["isScreeningVisible"],!1),type:"boolean",value:"true"},"h").w("  ").p("autoproc.mxdatacollectiongrid.template",b,b,{}).w('       </div><div class="col-xs-12 col-md-2"><a href="').f(b.getPath(!0,["url"]),b,"h").w("\" data-lightbox='").f(b.getPath(!0,["url"]),b,"h").w("' data-title=\"#").f(b.getPath(!0,["runNumber"]),b,"h").w(" ").f(b.getPath(!0,["folder"]),b,"h").w('"> <img alt="Image not found" class="img-responsive lazy"  data-src="').f(b.getPath(!0,["urlThumbnail"]),b,"h").w('" /></a>                           </div><div class="col-xs-12 col-md-2"><a href="').f(b.getPath(!0,["xtal1"]),b,"h").w('"  data-lightbox="').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" data-title="').f(b.getPath(!0,["Protein_acronym"]),b,"h").w(" : ").f(b.getPath(!0,["Protein_name"]),b,"h").w('"><img id="xtal1_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" alt="Image not found" class="img-responsive smalllazy" data-src="').f(b.getPath(!0,["xtal1"]),b,"h").w('" data-zoom-image="').f(b.getPath(!0,["xtal1"]),b,"h").w('"/></a>                           </div><div class="col-xs-6 col-md-2"> <a href="').f(b.getPath(!0,["indicator"]),b,"h").w("\" data-lightbox='").f(b.getPath(!0,["indicator"]),b,"h").w("' data-title=\"#").f(b.getPath(!0,["runNumber"]),b,"h").w(" ").f(b.getPath(!0,["folder"]),b,"h").w('"> <img  alt="Image not found" class="img-responsive lazy"  data-src="').f(b.getPath(!0,["indicator"]),b,"h").w('"/></a> </div></div><div class="container-fluid"><div class="col-xs-12 col-md-12">').x(b.get(["DataCollectionGroup_comments"],!1),b,{block:q},{}).x(b.get(["SpaceGroupModelResolvedByPhasing"],!1),b,{block:r},{}).w('</div></div></div></div><div id="experimentparameters_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" class="tab-pane fade"><div class="container-fluid"><div class="row">').p("general.mxdatacollectiongrid.template",b,b,{}).w('<div class="col-xs-4 col-md-2">').p("beamline.mxdatacollectiongrid.template",b,b,{}).w('                             </div><div class="col-xs-4 col-md-2">').p("detector.mxdatacollectiongrid.template",b,b,{}).w('                             </div><div class="col-xs-4 col-md-2"><table class="table">                    <tr><td>Synchrotron Current</td><td  class=\'column_parameter_value\'> ').f(b.getPath(!0,["synchrotronCurrent"]),b,"h").w('</td></tr>                                               </table>  </div></div></div></div><div id="sa_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" class="tab-pane fade"><div class="container-fluid"><div class="row"><div class="col-xs-6 col-md-2">').p("sample.mxdatacollectiongrid.template",b,b,{}).w('                             </div><div class="col-xs-12 col-md-2"><a href="').f(b.getPath(!0,["xtal1"]),b,"h").w('"  data-lightbox="').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" data-title="').f(b.getPath(!0,["Protein_acronym"]),b,"h").w(" : ").f(b.getPath(!0,["Protein_name"]),b,"h").w('"><img id="xtal1_samples_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" alt="Image not found" class="img-responsive smalllazy" data-src="').f(b.getPath(!0,["xtal1"]),b,"h").w('"/></a>                           </div><div class="col-xs-12 col-md-2"><a href="').f(b.getPath(!0,["xtal2"]),b,"h").w('"  data-lightbox="').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" data-title="').f(b.getPath(!0,["Protein_acronym"]),b,"h").w(" : ").f(b.getPath(!0,["Protein_name"]),b,"h").w('"><img id="xtal2_samples_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" alt="Image not found" class="img-responsive smalllazy" data-src="').f(b.getPath(!0,["xtal2"]),b,"h").w('"/></a>                           </div><div class="col-xs-12 col-md-2"><a href="').f(b.getPath(!0,["xtal3"]),b,"h").w('"  data-lightbox="').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" data-title="').f(b.getPath(!0,["Protein_acronym"]),b,"h").w(" : ").f(b.getPath(!0,["Protein_name"]),b,"h").w('"><img id="xtal3_samples_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" alt="Image not found" class="img-responsive smalllazy" data-src="').f(b.getPath(!0,["xtal3"]),b,"h").w('"/></a>                           </div><div class="col-xs-12 col-md-2"><a href="').f(b.getPath(!0,["xtal4"]),b,"h").w('"  data-lightbox="').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" data-title="').f(b.getPath(!0,["Protein_acronym"]),b,"h").w(" : ").f(b.getPath(!0,["Protein_name"]),b,"h").w('"><img id="xtal4_samples_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" alt="Image not found" class="img-responsive smalllazy" data-src="').f(b.getPath(!0,["xtal4"]),b,"h").w('"/></a>                           </div><div class="col-xs-12 col-md-2"><div id=\'sample_puck_layout_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w("'></div><div id='sample_puck_legend_").f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('\' style="height:60px"></div>                     </div></div><div class="container-fluid" ><div class="puck-selected-panel"><div id="puck_selected_info_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" class="col-xs-12 col-md-12"></div></div></div></div></div><div id="dc_').f(b.getPath(!0,["DataCollectionGroup_dataCollectionGroupId"]),b,"h").w('" class="tab-pane fade"><div class="container-fluid"><div class="row"><div class="col-xs-12 col-md-12" id="__dc_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w("\"><img style='display:block;margin-left: auto;margin-right: auto;height:150px;width:150px;'src='../images/loading-animation.gif' />                                           </div></div></div></div>").h("gt",b,{block:s},{key:b.get(["resultsCount"],!1),value:"0"},"h").w(" ").h("gt",b,{block:t},{key:b.getPath(!1,["workflows","length"]),value:"0"},"h").w(" ").h("gt",b,{block:u},{key:b.get(["hasPhasing"],!1),value:0},"h").w(" </div></div></div>")}function c(a,b){return a.w('<li class="disabled"><a data-toggle="tab"> Results</a></li>')}function d(a,b){return a.w('<li><a data-toggle="tab" href="#re_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('">Results  <span class="badge" style=\'background-color:#337ab7;\'>').f(b.getPath(!0,["resultsCount"]),b,"h").w("</span></a></li>")}function e(a,b){return a.w('<li class="disabled"><a data-toggle="tab">Workflow</a></li>')}function f(a,b){return a.w('<li><a data-toggle="tab" href="#wf_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('">Workflow  <span class="badge" style=\'background-color:#337ab7;\'>').f(b.getPath(!0,["workflows","length"]),b,"h").w("</span></a></li>")}function g(a,b){return a}function h(a,b){return a.w('<li><a data-toggle="tab" href="#ph_').f(b.getPath(!0,["DataCollection_dataCollectionGroupId"]),b,"h").w('">Phasing  <span class="badge" style=\'background-color:#337ab7;\'>').f(b.getPath(!0,["hasPhasing"]),b,"h").w("</span></a></li>")}function i(a,b){return a.h("ne",b,{block:j},{key:b.get(["ScreeningOutput_indexingSuccess"],!1),value:b.get(["null"],!1)},"h")}function j(a,b){return a.w("<table class=\"table\"><tr><td ><kbd style='background-color:#CCCCCC;color:blue;'>Indexed</kbd></td> <td>").h("eq",b,{"else":k,block:l},{key:b.get(["ScreeningOutput_indexingSuccess"],!1),type:"boolean",value:"true"},"h").w("</td><td>Mosaicity</td> <td class='column_parameter_value'>").h("decimal",b,{},{key:"ScreeningOutput_mosaicity",decimals:2},"h").w("</td></tr>").h("ne",b,{block:m},{key:b.get(["ScreeningOutput_strategySuccess"],!1),value:b.get(["null"],!1)},"h").w("                                                                                                                                                                                                           </table>").h("eq",b,{block:p},{key:b.get(["ScreeningOutput_strategySuccess"],!1),type:"boolean",value:"true"},"h").w("                             ")}function k(a,b){return a.w("<div class='summary_datacollection_failed'></div>")}function l(a,b){return a.w("<div class='summary_datacollection_success'></div>")}function m(a,b){return a.w("                    <tr><td><kbd style='background-color:#CCCCCC;color:blue;'>Strategy</kbd></td> ").h("eq",b,{"else":n,block:o},{key:b.get(["ScreeningOutput_strategySuccess"],!1),type:"boolean",value:"true"},"h").w("</tr>")}function n(a,b){return a.w("<td><div class='summary_datacollection_failed'></div></td>")}function o(a,b){return a.w("<td> <div class='summary_datacollection_success'></div></td> <td>Space Group</td> <td class='column_parameter_value'>").f(b.getPath(!0,["ScreeningOutputLattice_spaceGroup"]),b,"h").w("</td>                                                        <tr><td>Rank. Res.</td> <td class='column_parameter_value'>").f(b.getPath(!0,["ScreeningOutput_rankingResolution"]),b,"h").w(" &#8491;</td><td>Exp. Time</td> <td class='column_parameter_value'>").f(b.getPath(!0,["ScreeningStrategySubWedge_exposureTime"]),b,"h").w(" s</td></tr>                                                               <tr><td>Images</td> <td class='column_parameter_value'>").f(b.getPath(!0,["ScreeningStrategySubWedge_numberOfImages"]),b,"h").w("</td><td>Total rotation</td> <td class='column_parameter_value'>").f(b.getPath(!0,["ScreeningStrategySubWedge_oscillationRange"]),b,"h").w(" &deg;</td></tr>  <tr><td>Transmission</td> <td class='column_parameter_value'>").h("decimal",b,{},{key:"ScreeningStrategySubWedge_transmission",decimals:1},"h").w(" %</td><td></td> <td class='column_parameter_value'></td></tr>     ")}function p(a,b){return a.p("unitcell.screening.mxdatacollectiongrid.template",b,b,{}).w("  ")}function q(a,b){return a.w("<b>").h("dataCollectionComment",b,{},{key:"DataCollectionGroup_comments"},"h").w("</b>")}function r(a,b){return a.w("<div class=\"alert alert-success\" style='font-size:14px;'>Automatic SAD appears to have worked with the space group ").f(b.getPath(!0,["SpaceGroupModelResolvedByPhasing"]),b,"h").w(" </div>")}function s(a,b){return a.w('<div id="re_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" class="tab-pane fade"><div class="container-fluid"><div class="row" style=\'height:600px;\'><div class="col-xs-12 col-md-12" id="__re_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w("\"><img style='display:block;margin-left: auto;margin-right: auto;height:150px;width:150px;'src='../images/loading-animation.gif' />                                           </div></div></div></div>")}function t(a,b){return a.w('<div id="wf_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w('" class="tab-pane fade"><div class="container-fluid"><div class="row" style=\'height:600px;\'><div class="col-xs-12 col-md-12" id="__wf_').f(b.getPath(!0,["DataCollection_dataCollectionId"]),b,"h").w("\"><img style='display:block;margin-left: auto;margin-right: auto;height:150px;width:150px;'src='../images/loading-animation.gif' />                                           </div></div></div></div>")}function u(a,b){return a.w('<div id="ph_').f(b.getPath(!0,["DataCollection_dataCollectionGroupId"]),b,"h").w('" class="tab-pane fade"><div class="container-fluid"><div class="row" style=\'height:600px;\'><div class="col-xs-12 col-md-12" id="__wf_').f(b.getPath(!0,["DataCollection_dataCollectionGroupId"]),b,"h").w("\"><img style='display:block;margin-left: auto;margin-right: auto;height:150px;width:150px;'src='../images/loading-animation.gif' />                                           </div></div></div></div>  ")}return a.register("mxdatacollectiongrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,
f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,p.__dustBody=!0,q.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,t.__dustBody=!0,u.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<br /><div class="container-fluid"><div class="row">     <div class="col-sm-2 col-md-4 " style=\'margin: 0 10px 10px 0;\'>    </div>        ').s(b.getPath(!0,["autoprocessing"]),b,{block:c},{}).s(b.getPath(!0,["screening"]),b,{block:l},{}).w('<div class="col-sm-2 col-md-1 " style=\'margin: 0 10px 10px 0;\'>                                <div class="dropup">').h("eq",b,{block:v},{key:b.getPath(!1,["workflows","length"]),value:0},"h").h("gt",b,{block:w},{key:b.getPath(!1,["workflows","length"]),value:0},"h").w("</div>                            </div><div class=\"col-sm-2 col-md-2 \" style='margin: 0 10px 10px 0;'> ").h("gt",b,{block:G},{key:b.get(["phasingStepLength"],!1),value:0},"h").w("</div></div>   </div>                                                                                                                             ")}function c(a,b){return a.w('<div class="col-sm-2 col-md-1 " style=\'margin: 0 10px 10px 0;\'>                                  <div class="dropup">').h("eq",b,{block:d},{key:b.getPath(!1,["items","length"]),value:0},"h").w("                        ").h("gt",b,{block:e},{key:b.getPath(!1,["items","length"]),value:0},"h").w("</div></div>")}function d(a,b){return a.w('<button class="btn btn-xs btn-warning dropdown-toggle" type="button" data-toggle="dropdown"><span class="glyphicon glyphicon-cog"></span>  Processing <span class="badge">').h("size",b,{},{key:b.get(["items"],!1)},"h").w('</span><span class="caret"></span></button>')}function e(a,b){return a.w('  <button class="btn btn-xs btn-success dropdown-toggle" type="button" data-toggle="dropdown"><span class="glyphicon glyphicon-cog"></span>  Processing <span class="badge">').h("size",b,{},{key:b.get(["items"],!1)},"h").w('</span><span class="caret"></span></button>  <ul class="dropdown-menu">').s(b.getPath(!0,[]),b,{block:f},{}).w(" ").s(b.getPath(!0,[]),b,{block:j},{}).w("  </ul>")}function f(a,b){return a.s(b.getPath(!0,["items"]),b,{block:g},{})}function g(a,b){return a.w("<li> ").h("eq",b,{block:h},{key:b.get(["status"],!1),value:"Success"},"h").h("ne",b,{block:i},{key:b.get(["status"],!1),value:"Success"},"h").w("</li> ")}function h(a,b){return a.w("  <div class='summary_datacollection_success'></div>").f(b.getPath(!0,["name"]),b,"h").w(" ")}function i(a,b){return a.w("  <div class='summary_datacollection_failed'></div>").f(b.getPath(!0,["name"]),b,"h").w(" ")}function j(a,b){return a.s(b.getPath(!0,["items","0"]),b,{block:k},{})}function k(a,b){return a.w('<li class="divider"></li><li >                                                                                                  <div class="btn-group btn-group-xs" style=\'margin:0 0 0 30px;\'>                                                                <a href="#/autoprocintegration/datacollection/').f(b.getPath(!0,["dataCollectionId"]),b,"h").w('/main" class="btn btn-default" role="button"> <span class="glyphicon glyphicon-eye-open"></span> Open</a><a href="#/autoprocintegration/datacollection/').f(b.getPath(!0,["dataCollectionId"]),b,"h").w('/files" style=\'margin:0 0 0 10px;\' class="btn btn-default" role="button"> <span class="glyphicon glyphicon-file">Files</span></a></div></li>  ')}function l(a,b){return a.w('<div class="col-sm-2 col-md-1 " style=\'margin: 0 10px 10px 0;\'>                                  <div class="dropup">').h("eq",b,{block:m},{key:b.getPath(!1,["items","length"]),value:0},"h").w("                        ").h("gt",b,{block:n},{key:b.getPath(!1,["items","length"]),value:0},"h").w("</div></div>")}function m(a,b){return a.w('<button class="btn btn-xs btn-warning dropdown-toggle" type="button" data-toggle="dropdown"><span class="glyphicon glyphicon-screenshot"></span> Characterization <span class="badge">').h("size",b,{},{key:b.get(["items"],!1)},"h").w('</span><span class="caret"></span></button>')}function n(a,b){return a.w("  ").h("eq",b,{block:o},{key:b.get(["status"],!1),value:"Success"},"h").w(" ").h("ne",b,{block:p},{key:b.get(["status"],!1),value:"Success"},"h").w('  <ul class="dropdown-menu">').s(b.getPath(!0,[]),b,{block:q},{}).w("    </ul>")}function o(a,b){return a.w('<button class="btn btn-xs btn-success dropdown-toggle" type="button" data-toggle="dropdown"><span class="glyphicon glyphicon-screenshot"></span> Characterization <span class="badge">').h("size",b,{},{key:b.get(["items"],!1)},"h").w('</span><span class="caret"></span></button>')}function p(a,b){return a.w('<button class="btn btn-xs btn-danger dropdown-toggle" type="button" data-toggle="dropdown"><span class="glyphicon glyphicon-screenshot"></span> Characterization <span class="badge">').h("size",b,{},{key:b.get(["items"],!1)},"h").w('</span><span class="caret"></span></button>')}function q(a,b){return a.s(b.getPath(!0,["items"]),b,{block:r},{}).w("                                                ")}function r(a,b){return a.w("<li> ").h("eq",b,{block:s},{key:b.get(["status"],!1),value:"Success"},"h").h("ne",b,{block:t},{key:b.get(["status"],!1),value:"Success"},"h").w("<table class=\"table\"  style='margin:0 0 20 0px;'>").s(b.getPath(!0,["items"]),b,{block:u},{}).w("</table>                                                                                                                 </li> ")}function s(a,b){return a.w("  <div class='summary_datacollection_success'></div>").f(b.getPath(!0,["name"]),b,"h").w(" ")}function t(a,b){return a.w("  <div class='summary_datacollection_failed'></div>").f(b.getPath(!0,["name"]),b,"h").w(" ")}function u(a,b){return a.w("<tr><td>").f(b.getPath(!0,["name"]),b,"h").w("</td><td>").f(b.getPath(!0,["value"]),b,"h").w("</td></tr>    ")}function v(a,b){return a.w('<button class="btn btn-xs btn-warning dropdown-toggle" type="button" data-toggle="dropdown"><span class="glyphicon glyphicon-sort-by-attributes"></span>Workflow <span class="badge">').h("size",b,{},{key:b.get(["workflows"],!1)},"h").w('</span><span class="caret"></span></button>')}function w(a,b){return a.w('<button class="btn btn-xs btn-success dropdown-toggle" type="button" data-toggle="dropdown"><span class="glyphicon glyphicon-sort-by-attributes"></span>Workflow <span class="badge">').h("size",b,{},{key:b.get(["workflows"],!1)},"h").w('</span><span class="caret"></span></button><ul class="dropdown-menu">').s(b.getPath(!0,["workflows"]),b,{block:x},{}).w(" ").s(b.getPath(!0,["workflows","0"]),b,{block:F},{}).w("  </ul>")}function x(a,b){return a.w(" ").s(b.getPath(!0,[]),b,{block:y},{}).w("  ")}function y(a,b){return a.h("eq",b,{block:z},{key:b.get(["status"],!1),value:"Success"},"h").w("                                                                                                                                                                                                                                                            ").h("ne",b,{block:C},{key:b.get(["status"],!1),value:"Success"},"h")}function z(a,b){return a.w("<li> ").h("eq",b,{block:A},{key:b.get(["status"],!1),value:"Success"},"h").h("ne",b,{block:B},{key:b.get(["status"],!1),value:"Success"},"h").w("</li>                                                                                       ")}function A(a,b){return a.w(" <img  src='").f(b.getPath(!0,["img"]),b,"h").w("' style='width:30px;height:30px;'/><div class='summary_datacollection_success'></div>").f(b.getPath(!0,["name"]),b,"h")}function B(a,b){return a.w(" <img src='").f(b.getPath(!0,["img"]),b,"h").w("' style='width:30px;height:30px;'/><div class='summary_datacollection_failed'></div>").f(b.getPath(!0,["name"]),b,"h")}function C(a,b){return a.w("<li>").h("eq",b,{block:D},{key:b.get(["status"],!1),value:"Success"},"h").h("ne",b,{block:E},{key:b.get(["status"],!1),value:"Success"},"h").w("</li>                                                                                       ")}function D(a,b){return a.w("<img  src='").f(b.getPath(!0,["img"]),b,"h").w("' style='width:30px;height:30px;'/><div class='summary_datacollection_success'></div> ").f(b.getPath(!0,["name"]),b,"h").w(" ")}function E(a,b){return a.w("<div class='summary_datacollection_failed'></div ").f(b.getPath(!0,["name"]),b,"h").w(" ")}function F(a,b){return a.w('<li class="divider"></li><li ><div class="btn-group btn-group-xs" style=\'margin:0 0 0 30px;\'><a href="#/mx/workflow/step/').f(b.getPath(!0,["workflowStepIds"]),b,"h").w('/main" class="btn btn-default" role="button"> <span class="glyphicon glyphicon-eye-open"></span>Open</a></div></li>  ')}function G(a,b){return a}return a.register("online.mxdatacollectiongrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,p.__dustBody=!0,q.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,t.__dustBody=!0,u.__dustBody=!0,v.__dustBody=!0,w.__dustBody=!0,x.__dustBody=!0,y.__dustBody=!0,z.__dustBody=!0,A.__dustBody=!0,B.__dustBody=!0,C.__dustBody=!0,D.__dustBody=!0,E.__dustBody=!0,F.__dustBody=!0,G.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div class=\"container-fluid containerWithScroll\">       <div class=\"col-xs-12 col-md-12\">  <table class=\"table table-striped table-hover\">   <thead>   <tr> <th>Phasing</th><th><abbr title=\"Prepare Step\">PREPARE</abbr></th><th><abbr title=\"Substructure Determination Step\">SUBSTRUCTURE</abbr></th><th><abbr title=\"Phasing Step\">PHASING</abbr></th><th><abbr title=\"Model Building Step\">MODEL</abbr></th><th>Download</th>       <th style='color:gray'></th>                                                       <th style='color:gray'>Program</th><th style='color:gray'>Method</th><th style='color:gray'>Resolution</th><th style='color:gray'>Solvent</th>                                                                <th style='color:gray'>Chain Count</th><th style='color:gray'>Residues Count</th><th style='color:gray'>Average Fragment Length</th><th style='color:gray'>CC of partial model</th>                                                                                             <th style='color:gray'><abbr title=\"UglyMol:  https://github.com/uglymol/uglymol\">Electron Density</abbr></th><th style='color:gray; '>PDB</th>                               </tr></thead> <tbody>").s(b.getPath(!0,[]),b,{block:c},{}).w(" </tbody> </table>  </div><div class=\"col-xs-12 col-md-12\" style='background-color:#FAFAFA;border:1px gray solid;'><span>Automatic processing of macromolecular crystallography X-ray diffraction data at the ESRF.<br /></span><span style='color:rgb(119,119,119); font-weight:italic;'>Monaco S, Gordon E, Bowler MW, Delageniere S, Guijarro M, Spruce D, Svensson O, McSweeney SM, McCarthy AA, Leonard G, Nanao MH.<br /></span><span style='color:rgb(119,119,119);'>J Appl Crystallogr. 2013 Jun 1;46(Pt 3):804-810.<br /></span><a href='https://www.ncbi.nlm.nih.gov/pubmed/?term=monaco+ESRF '>https://www.ncbi.nlm.nih.gov/pubmed/?term=monaco+ESRF</a> </div>  <div class=\"col-xs-12 col-md-12\" style='background-color:#FAFAFA;margin-top:10px;border:1px gray solid;'><span>Experimental phasing with SHELXC/D/E: combining chain tracing with density modification.<br /></span><span style='color:rgb(119,119,119); font-weight:italic;'>Sheldrick GM.<br /></span><span style='color:rgb(119,119,119);'>Acta Crystallogr D Biol Crystallogr. 2010 Apr;66(Pt 4):479-85. doi: 10.1107/S0907444909038360.<br /></span><a href='https://www.ncbi.nlm.nih.gov/pubmed/20383001'>https://www.ncbi.nlm.nih.gov/pubmed/20383001</a> </div> <div class=\"col-xs-12 col-md-12\" style='background-color:#FAFAFA;margin-top:10px;margin-bottom:30px;border:1px gray solid;'><span>UglyMol: Electron Density Viewer<br /></span>                       <a href='https://github.com/uglymol/uglymol'>https://github.com/uglymol/uglymol</a> </div> </div></div>")}function c(a,b){return a.s(b.get(["metrics"],!1),b,{block:d},{})}function d(a,b){return a.w("                                 ").h("eq",b,{"else":e,block:f},{key:b.get(["$idx"],!1),value:0},"h").w("                                                                   <td>").h("eq",b,{block:g},{key:b.get(["$idx"],!1),value:0},"h").w("                                        </td><td>").h("eq",b,{block:h},{key:b.get(["$idx"],!1),value:0},"h").w(" </td><td>").h("eq",b,{block:k},{key:b.get(["$idx"],!1),value:0},"h").w("</td>  <td> ").h("eq",b,{block:n},{key:b.get(["$idx"],!1),value:0},"h").w("</td><td> ").h("eq",b,{block:q},{key:b.get(["$idx"],!1),value:0},"h").w("</td><td >   ").h("eq",b,{block:t},{key:b.get(["$idx"],!1),value:0},"h").w("                                                                                                                </td>                                                                 <td>").h("eq",b,{block:u},{key:b.get(["$idx"],!1),value:0},"h").w("  </td><td>").f(b.getPath(!0,["PhasingProgramRun_phasingPrograms"]),b,"h").w(" </td><td>").f(b.getPath(!0,["PhasingStep_method"]),b,"h").w(" </td><td>").f(b.getPath(!0,["PhasingStep_highRes"]),b,"h").w(" - ").f(b.getPath(!0,["PhasingStep_lowRes"]),b,"h").w(" </td><td>").f(b.getPath(!0,["PhasingStep_solventContent"]),b,"h").w(" </td>                                                               <td>").h("decimal",b,{block:v},{key:"Chain_Count",decimals:0},"h").w("  </td><td>").h("decimal",b,{block:w},{key:"_Residues_Count",decimals:0},"h").w(" </td>                     <td>").h("decimal",b,{block:x},{key:"_Average_Fragment_Length",decimals:0},"h").w(" </td><td>").h("decimal",b,{block:y},{key:"_CC_of_partial_model",decimals:2},"h").w("</td>                               <td>                                            ").x(b.get(["uglymol"],!1),b,{"else":z,block:A},{}).w("                                                                                        </td><td >                                            ").x(b.get(["pngURL"],!1),b,{"else":B,block:C},{}).w("                                                                                       </td>         </tr> ")}function e(a,b){return a.w("<tr> ")}function f(a,b){return a.w("<tr style='background-color:#e6ffe6;'>                                 ")}function g(a,b){return a.w("<a href='#/phasing/autoprocintegrationId/").f(b.getPath(!0,["autoProcIntegrationId"]),b,"h").w("/main'> ").f(b.getPath(!0,["spaceGroup"]),b,"h").w("</a>")}function h(a,b){return a.h("eq",b,{"else":i,block:j},{key:b.get(["prepare"],!1),type:"boolean",value:"true"},"h")}function i(a,b){return a.w("<span style='color:red;' class=\"glyphicon glyphicon-remove\"></span>")}function j(a,b){return a.w("<span style='color:green;' class=\"glyphicon glyphicon-ok\"></span>")}function k(a,b){return a.h("eq",b,{"else":l,block:m},{key:b.get(["sub"],!1),type:"boolean",value:"true"},"h").w(" ")}function l(a,b){return a.w("<span style='color:red;' class=\"glyphicon glyphicon-remove\"></span>")}function m(a,b){return a.w("<span style='color:green;' class=\"glyphicon glyphicon-ok\"></span>")}function n(a,b){return a.h("eq",b,{"else":o,block:p},{key:b.get(["phasing"],!1),type:"boolean",value:"true"},"h")}function o(a,b){return a.w("<span style='color:red;' class=\"glyphicon glyphicon-remove\"></span>")}function p(a,b){return a.w("<span style='color:green;' class=\"glyphicon glyphicon-ok\"></span>")}function q(a,b){return a.h("eq",b,{"else":r,block:s},{key:b.get(["model"],!1),type:"boolean",value:"true"},"h")}function r(a,b){return a.w("<span style='color:red;' class=\"glyphicon glyphicon-remove\"></span>")}function s(a,b){return a.w("                           <span style='color:green;' class=\"glyphicon glyphicon-ok\"></span>                          ")}function t(a,b){return a.w("                     <a href='").f(b.getPath(!0,["downloadFilesUrl"]),b,"h").w("' ><span style='font-size: 1.5em;' class=\"glyphicon glyphicon-download \" ></span></a>")}function u(a,b){return a.w('<kbd style="background-color:green">BEST</kbd>')}function v(a,b){return a}function w(a,b){return a}function x(a,b){return a}function y(a,b){return a}function z(a,b){return a.w("                                                    ")}function A(a,b){return a.w('<a><a target="_blank" href=\'').f(b.getPath(!0,["uglymol"]),b,"h").w("' ><span style='font-size: 1em;' class=\"glyphicon glyphicon-eye-open\"  ></span></a> ")}function B(a,b){return a.w("                                                    ")}function C(a,b){return a.w('<a href="').f(b.getPath(!0,["pngURL"]),b,"h").w('"  data-lightbox="').f(b.getPath(!0,["PhasingStep_autoProcScalingId"]),b,"h").w('" data-title="').f(b.getPath(!0,["PhasingStep_phasingStepType"]),b,"h").w(" : ").f(b.getPath(!0,["SpaceGroup_spaceGroupShortName"]),b,"h").w('"><img id="').f(b.getPath(!0,["PhasingStep_phasingStepId"]),b,"h").w("\" alt=\"Image not found\" style='height:15px; width:15px;'  src='../images/icon/ic_search_black_48dp.png'/></a>")}return a.register("phasing.mxdatacollectiongrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,p.__dustBody=!0,q.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,t.__dustBody=!0,u.__dustBody=!0,v.__dustBody=!0,w.__dustBody=!0,x.__dustBody=!0,y.__dustBody=!0,z.__dustBody=!0,A.__dustBody=!0,B.__dustBody=!0,C.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table class=\"table\"><tr><td>Protein</td><td  class='column_parameter_value'>").f(b.getPath(!0,["Protein_acronym"]),b,"h").w("</td></tr> <tr><td>Sample</td><td  class='column_parameter_value'>").f(b.getPath(!0,["BLSample_name"]),b,"h").w("</td></tr> <tr><td>Shipment</td><td  class='column_parameter_value'>").f(b.getPath(!0,["Shipping_shippingName"]),b,"h").w("</td></tr><tr><td>Parcel</td><td  class='column_parameter_value'>").f(b.getPath(!0,["Dewar_code"]),b,"h").w("</td></tr> <tr><td> Container / Position </td><td  class='column_parameter_value'> ").f(b.getPath(!0,["Container_containerType"]),b,"h").w(" / ").f(b.getPath(!0,["BLSample_location"]),b,"h").w(" </td></tr> <tr><td> Sample barcode</td><td  class='column_parameter_value'> ").f(b.getPath(!0,["barCode"]),b,"h").w("</td></tr>                   <tr><td>Beamline location</td><td  class='column_parameter_value'> ").f(b.getPath(!0,["Container_beamlineLocation"]),b,"h").w("</td></tr><tr><td>Sample changer location</td><td  class='column_parameter_value'>").f(b.getPath(!0,["Container_sampleChangerLocation"]),b,"h").w("</td></tr></table>       ")}return a.register("sample.mxdatacollectiongrid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table class=\"table\">                    <tr><td>Type</td><td  class='column_parameter_value'> ").f(b.getPath(!0,["DataCollectionGroup_experimentType"]),b,"h").w("</td></tr><tr><td>Res. (corner)</td><td  class='column_parameter_value'>").f(b.getPath(!0,["DataCollection_resolution"]),b,"h").w(" &#8491; (").f(b.getPath(!0,["DataCollection_resolutionAtCorner"]),b,"h").w(" &#8491;)</td></tr><tr><td>Wavelength</td><td  class='column_parameter_value'>").f(b.getPath(!0,["DataCollection_wavelength"]),b,"h").w(" &#8491;</td></tr><tr><td>").f(b.getPath(!0,["DataCollection_rotationAxis"]),b,"h").w(" range</td><td  class='column_parameter_value'>").h("decimal",b,{},{key:"DataCollection_axisRange",decimals:2},"h").w("&deg;</td></tr><tr><td>").f(b.getPath(!0,["DataCollection_rotationAxis"]),b,"h").w(" start (total)</td><td  class='column_parameter_value'>").h("decimal",b,{},{key:"DataCollection_axisEnd",decimals:1},"h").w("&deg; (").f(b.getPath(!0,["DataCollection_axisTotal"]),b,"h").w("&deg;)</td></tr><tr><td>Exposure Time</td><td  class='column_parameter_value'>").f(b.getPath(!0,["DataCollection_exposureTime"]),b,"h").w(" s</td></tr><tr><td>Flux end</td><td  class='column_parameter_value'>").f(b.getPath(!0,["DataCollection_flux_end"]),b,"h").w(" ph/sec</td></tr></table>")}return a.register("second.general.mxdatacollectiongrid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table class='table-sm table table-striped'><thead>   <tr><th  style='padding:0 15px 0 15px;'>").f(b.getPath(!0,["spaceGroup"]),b,"h").w("</th><th style='padding:0 15px 0 15px;'>Completeness</th><th style='padding:0 15px 0 15px;'>Res.</th><th style='padding:0 15px 0 15px;'>Rmerge</th>                    </tr></thead><tbody><tr><td  style='padding:0 15px 0 15px;'>Inner</td><td  style='padding:0 15px 0 15px;'>").h("gte",b,{"else":c,block:d},{key:b.getPath(!1,["innerShell","completeness"]),value:50},"h").w("</td><td style='padding:0 15px 0 15px;'>").f(b.getPath(!0,["innerShell","resolutionsLimitHigh"]),b,"h").w("</td><td style='padding:0 15px 0 15px;'>").f(b.getPath(!0,["innerShell","rMerge"]),b,"h").w("</td></tr><tr><td  style='padding:0 15px 0 15px;'>Outer</td><td  style='padding:0 15px 0 15px;'>  ").h("gte",b,{"else":g,block:h},{key:b.getPath(!1,["outerShell","completeness"]),value:50},"h").w("</td><td style='padding:0 15px 0 15px;'>").f(b.getPath(!0,["outerShell","resolutionsLimitHigh"]),b,"h").w("</td><td style='padding:0 15px 0 15px;'>").f(b.getPath(!0,["outerShell","rMerge"]),b,"h").w("</td></tr><tr><td  style='padding:0 15px 0 15px;'>Overall</td><td  style='padding:0 15px 0 15px;'>").h("gte",b,{"else":k,block:l},{key:b.getPath(!1,["overall","completeness"]),value:50},"h").w("</td><td style='padding:0 15px 0 15px;'>").f(b.getPath(!0,["overall","resolutionsLimitHigh"]),b,"h").w("</td><td style='padding:0 15px 0 15px;'>").f(b.getPath(!0,["overall","rMerge"]),b,"h").w("</td></tr></tbody></table>")}function c(a,b){return a.w('<div  style="background-repeat: repeat-x;border:1px solid #d9534f;color:#000;background-color:#d9534f;width:').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w('%">').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w("%</div>")}function d(a,b){return a.h("gte",b,{"else":e,block:f},{key:b.getPath(!1,["innerShell","completeness"]),value:90},"h").w("               ")}function e(a,b){return a.w('<div  style="background-repeat: repeat-x;border:1px solid #f0ad4e;color:#fff;background-color:#f0ad4e;width:').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w('%">').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w("%</div>")}function f(a,b){return a.w('<div  style="background-repeat: repeat-x;border:1px solid gray;color:#fff;background-image:linear-gradient(to bottom,#337ab7 0,#286090 100%);width:').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w('%">').f(b.getPath(!0,["innerShell","completeness"]),b,"h").w("%</div>")}function g(a,b){return a.w('    <div  style="background-repeat: repeat-x;border:1px solid #d9534f;color:#000;background-color:#d9534f;width:').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w('%">').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w("%</div>")}function h(a,b){return a.h("gte",b,{"else":i,block:j},{key:b.getPath(!1,["outerShell","completeness"]),value:90},"h")}function i(a,b){return a.w('<div  style="background-repeat: repeat-x;border:1px solid #f0ad4e;color:#fff;background-color:#f0ad4e;width:').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w('%">').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w("%</div>")}function j(a,b){return a.w('<div  style="background-repeat: repeat-x;border:1px solid gray;color:#fff;background-image:linear-gradient(to bottom,#337ab7 0,#286090 100%);width:').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w('%">').f(b.getPath(!0,["outerShell","completeness"]),b,"h").w("%</div>")}function k(a,b){return a.w('<div  style="background-repeat: repeat-x;border:1px solid #d9534f;color:#000;background-color:#d9534f;width:').f(b.getPath(!0,["overall","completeness"]),b,"h").w('%">').f(b.getPath(!0,["overall","completeness"]),b,"h").w("%</div>                            ")}function l(a,b){return a.h("gte",b,{"else":m,block:n},{key:b.getPath(!1,["overall","completeness"]),value:90},"h")}function m(a,b){return a.w('<div  style="background-repeat: repeat-x;border:1px solid #f0ad4e;color:#fff;background-color:#f0ad4e;width:').f(b.getPath(!0,["overall","completeness"]),b,"h").w('%">').f(b.getPath(!0,["overall","completeness"]),b,"h").w("%</div>")}function n(a,b){return a.w('<div  style="background-repeat: repeat-x;border:1px solid gray;color:#fff;background-image:linear-gradient(to bottom,#337ab7 0,#286090 100%);width:').f(b.getPath(!0,["overall","completeness"]),b,"h").w('%">').f(b.getPath(!0,["overall","completeness"]),b,"h").w("%</div>")}return a.register("sm.completeness.autoproc.mxdatacollectiongrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,n.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("   <table class='table-sm table table-striped'><thead>   <tr><th style='padding:0 15px 0 15px;font-weight: normal;'>Cell A</th><th style='padding:0 15px 0 15px;font-weight: normal;'>Cell B</th><th style='padding:0 15px 0 15px;font-weight: normal;'>Cell C</th></tr></thead><tbody><tr><td class='column_parameter_value' style='padding:0 15px 0 15px;'>").h("decimal",b,{},{key:"overall.cell_a",decimals:2,intIfPossible:"true"},"h").w("</td><td class='column_parameter_value' style='padding:0 15px 0 15px;'>").h("decimal",b,{},{key:"overall.cell_b",decimals:2,intIfPossible:"true"},"h").w("</td><td class='column_parameter_value' style='padding:0 15px 0 15px;'>").h("decimal",b,{},{key:"overall.cell_c",decimals:2,intIfPossible:"true"},"h").w("</td></tr><tr><th  style='padding:0 15px 0 15px;font-weight: normal;'>Alpha</th><th style='padding:0 15px 0 15px;font-weight: normal;'>Beta</th><th style='padding:0 15px 0 15px;font-weight: normal;'>Gamma</th></tr><tr><td class='column_parameter_value' style='padding:0 15px 0 15px;'>").h("decimal",b,{},{key:"overall.cell_alpha",decimals:2,intIfPossible:"true"},"h").w("</td><td class='column_parameter_value' style='padding:0 15px 0 15px;'>").h("decimal",b,{},{key:"overall.cell_beta",decimals:2,intIfPossible:"true"},"h").w("</td><td class='column_parameter_value' style='padding:0 15px 0 15px;'>").h("decimal",b,{},{key:"overall.cell_gamma",decimals:2,intIfPossible:"true"},"h").w("</td></tr></tbody></table>")}return a.register("unitcell.autoproc.mxdatacollectiongrid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("   <table class='table-sm table table-striped'><thead>   <tr><th  style='padding:0 15px 0 15px;'>Cell A</th><th style='padding:0 15px 0 15px;'>Cell B</th><th style='padding:0 15px 0 15px;'>Cell C</th></tr></thead><tbody><tr><td class='column_parameter_value' style='padding:0 15px 0 15px;'>").h("decimal",b,{},{key:"ScreeningOutputLattice_unitCell_a",decimals:2},"h").w("</td><td class='column_parameter_value' style='padding:0 15px 0 15px;'>").h("decimal",b,{},{key:"ScreeningOutputLattice_unitCell_b",decimals:2},"h").w("</td><td class='column_parameter_value' style='padding:0 15px 0 15px;'>").h("decimal",b,{},{key:"ScreeningOutputLattice_unitCell_c",decimals:2},"h").w("</td></tr><tr><th  style='padding:0 15px 0 15px;'>Alpha</th><th style='padding:0 15px 0 15px;'>Beta</th><th style='padding:0 15px 0 15px;'>Gamma</th></tr><tr><td class='column_parameter_value' style='padding:0 15px 0 15px;'>").h("decimal",b,{},{key:"ScreeningOutputLattice_unitCell_alpha",decimals:2},"h").w("</td><td class='column_parameter_value' style='padding:0 15px 0 15px;'>").h("decimal",b,{},{key:"ScreeningOutputLattice_unitCell_beta",decimals:2},"h").w("</td><td class='column_parameter_value' style='padding:0 15px 0 15px;'>").h("decimal",b,{},{key:"ScreeningOutputLattice_unitCell_gamma",decimals:2},"h").w("</td></tr></tbody></table>")}return a.register("unitcell.screening.mxdatacollectiongrid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid containerWithScroll"><div class="row"><div class="col-xs-12 col-md-2"><table class="table table-striped table-hover"><thead><tr>').s(b.getPath(!0,[]),b,{block:c},{}).w("</tr></thead><tr> ").s(b.getPath(!0,[]),b,{block:d},{}).w("</tr></tr><tr>").s(b.getPath(!0,[]),b,{block:e},{}).w("</tr></table></div></div></div>")}function c(a,b){return a.w('<th> <a href="#/mx/workflow/steps/').f(b.getPath(!0,["workflowStepIds"]),b,"h").w("/step/").f(b.getPath(!0,["workflowStepId"]),b,"h").w("/main\" target='_blank'>").f(b.getPath(!0,["name"]),b,"h").w("</a></th>                 ")}function d(a,b){return a.w('<td  ><a href="#/mx/workflow/steps/').f(b.getPath(!0,["workflowStepIds"]),b,"h").w("/step/").f(b.getPath(!0,["workflowStepId"]),b,"h").w("/main\" target='_blank' ><img style='height:150px;width:150px;' src='").f(b.getPath(!0,["img"]),b,"h").w("' /></a></td>")}function e(a,b){return a.w("<td  >").f(b.getPath(!0,["status"]),b,"h").w("</td>")}return a.register("workflows.mxdatacollectiongrid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid"><div class="panel with-nav-tabs panel-default"><div class="panel-heading clearfix"><div class="pull-left"><h1 class="panel-title" style=\'color:#337ab7;\'><span style=\'font-size:12px;\'>   ').f(b.getPath(!0,["startTime"]),b,"h").w('</span></h1></div><div class="pull-right"><ul class="nav nav-tabs"><li class="active"><a data-toggle="tab" href="#datacollection_').f(b.get(["DataCollection_dataCollectionId"],!1),b,"h").w('">Summary </a></li></ul></div></div><br /><div class="tab-content"><div id="datacollection_').f(b.get(["DataCollection_dataCollectionId"],!1),b,"h").w('" class="tab-pane fade in active"><div class="container-fluid"><div class="row"><div class="col-xs-1 col-md-1"><div class="well" style=\'font-size:30px;\'>').f(b.getPath(!0,["element"]),b,"h").w('</div></div><div class="col-xs-3 col-md-3"><table class="table table-condensed"><tr><td>Start Time</td><td class=\'column_parameter_value\'>').f(b.getPath(!0,["startTime"]),b,"h").w("</td></tr><tr><td>Protein</td><td class='column_parameter_value'>").f(b.getPath(!0,["acronym"]),b,"h").w("</td></tr><tr><td>Sample</td><td class='column_parameter_value'>").f(b.getPath(!0,["name"]),b,"h").w("</td></tr><tr><td>Fluorescence Detector</td><td class='column_parameter_value'>").f(b.getPath(!0,["fluorescenceDetector"]),b,"h").w("</td></tr><tr><td style='width:150px;'>Energy Scan Range</td><td class='column_parameter_value'>").f(b.getPath(!0,["startEnergy"]),b,"h").w(" kev - ").f(b.getPath(!0,["endEnergy"]),b,"h").w(" kev</td></tr><tr><td>Edge Energy (theoretical)</td><td class='column_parameter_value'>").f(b.getPath(!0,["edgeEnergy"]),b,"h").w(" kev</td></tr><tr><td>Flux @100%</td><td class='column_parameter_value'>").f(b.getPath(!0,["flux"]),b,"h").w(" ph/sec</td></tr><tr><td>Transmission</td><td class='column_parameter_value'>").f(b.getPath(!0,["transmissionFactor"]),b,"h").w(" %</td></tr><tr><td style='width:150px;'>Beam Size Hor</td><td class='column_parameter_value'>").f(b.getPath(!0,["beamSizeHorizontal"]),b,"h").w(" micrometer</td></tr><tr><td>Beam Size Vert</td><td class='column_parameter_value'>").f(b.getPath(!0,["beamSizeVertical"]),b,"h").w(" micrometer</td></tr><tr><td>Exposure Time</td><td class='column_parameter_value'>").f(b.getPath(!0,["exposureTime"]),b,"h").w(" sec</td></tr><tr><td>Filename</td><td class='column_parameter_value'>").f(b.getPath(!0,["filename"]),b,"h").w('</td></tr></table></div><div class="col-xs-3 col-md-3"><table class="table table-condensed"><tr><td >Peak Energy</td><td class=\'column_parameter_value\'>').f(b.getPath(!0,["peakEnergy"]),b,"h").w(" kev</td></tr><tr><td >Pk f'</td><td class='column_parameter_value'>").f(b.getPath(!0,["peakFPrime"]),b,"h").w(" e</td></tr><tr><td >Pk f''</td><td class='column_parameter_value'>").f(b.getPath(!0,["peakFDoublePrime"]),b,"h").w(" e</td></tr><tr><td >Inflection Energy</td><td class='column_parameter_value'>").f(b.getPath(!0,["inflectionEnergy"]),b,"h").w(" kev</td></tr><tr><td >Ip f'</td><td class='column_parameter_value'>").f(b.getPath(!0,["inflectionFPrime"]),b,"h").w(" e </td></tr><tr><td >Ip f''</td><td class='column_parameter_value'>").f(b.getPath(!0,["inflectionFDoublePrime"]),b,"h").w(' e </td></tr></table></div><div class="col-xs-3 col-md-3"><a href=\'').f(b.getPath(!0,["choochURL"]),b,"h").w("' data-lightbox='").f(b.getPath(!0,["choochURL"]),b,"h").w('\' data-title="Chooch"><img class="lazy"  data-src=\'').f(b.getPath(!0,["choochURL"]),b,"h").w("' src='").f(b.getPath(!0,["choochURL"]),b,"h").w("' /> </a></div></div></div></div></div></div></div>");
}return a.register("energyscangrid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div id="container"><div style=\'float:left;\' id="left"><img class="titleImage" src="../images/logo_EXI.jpg" /><span class="title">ExiMX<span class="subtitle">Extended ISPyB for MX<sub style="font-size:10px;color:orange">BETA</sub></span></span></div><div id="center"></div><div style=\'float:right;width:120px;\' id="logos"><img class="logoImage" src="../images/logo_EMBL.png" /><img class="logoImage" src="../images/logo_ESRF.png" /></div><div style=\'float:right;width:120px;\' id="right"><div style=\'color:white;font-size:10px; \'>Version: ').f(b.getPath(!0,["version"]),b,"h").w("</div><div style='color:white;font-size:10px; '>Released: ").f(b.getPath(!0,["release_date"]),b,"h").w("</div><div style='color:white;font-size:10px;'>").f(b.getPath(!0,["database"]),b,"h").w("</div></div></div>")}return a.register("mxheader",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div id="Viewer" style="position: absolute; left:0px; top:0px;"></div><div class="centeredControls" id="loadControls"><form action="javascript:requestFromServer();" id="pdbIdFetch"><div class="controlItem" id="pdbFetch">Load PDB ID: <input type="text" id="pdbIdInput" style="width:50px;" /><input type="submit" style="display:none" /></div></form></div><div class="controlButton" id="loadControlsButton"><div class="controlMargin" id="loadControlsBtnMargin"><div class="controlItem" id="loadControlsShow">Load structure...</div></div></div>')}return a.register("electron.density.viewer.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div><table  style='border:1px solid #FAFAFA;'>").s(b.getPath(!0,[]),b,{block:c},{}).w("       </table></div>")}function c(a,b){return a.w("	<tr><td class='summary_datacollection_parameter_name'>Space Group</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["spaceGroupShortName"]),b,"h").w(" (").f(b.getPath(!0,["spaceGroup"]),b,"h").w(")</td></tr> <tr><td class='summary_datacollection_parameter_name'>Type</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["phasingStepType"]),b,"h").w("</td></tr> <tr><td class='summary_datacollection_parameter_name'>Program</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["phasingPrograms"]),b,"h").w("</td></tr>     <tr><td class='summary_datacollection_parameter_name'>Resolution</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["lowRes"]),b,"h").w(" - ").f(b.getPath(!0,["highRes"]),b,"h").w("</td></tr>  <tr>  <td class='summary_datacollection_parameter_name'>StartTime</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["phasingStartTime"]),b,"h").w("</td></tr>  <tr>  <td class='summary_datacollection_parameter_name'>Protein</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["acronym"]),b,"h").w("</td></tr>                         ")}return a.register("phasinggrid.prepare",b),b.__dustBody=!0,c.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div><table>").s(b.getPath(!0,["0"]),b,{block:c},{}).w("  ").s(b.getPath(!0,[]),b,{block:d},{}).w("       </table></div>")}function c(a,b){return a.w("<tr><th class=\"datacollection_parameter_name\" style='width:70px;'>Resolution</th><th class=\"datacollection_parameter_name\" style='width:70px;'>Method</th><th class=\"datacollection_parameter_name\" style='width:70px;'>Enantiomorph</th><th  class=\"datacollection_parameter_name\"style='width:70px;'>SpaceGroup</th><th class=\"datacollection_parameter_name\" style='width:70px;'>Solvent</th><th class=\"datacollection_parameter_name\" style='width:120px;'>Statistics</th>            </tr>  ")}function d(a,b){return a.w("	    <tr  class='selectable_row'><td>").f(b.getPath(!0,["lowRes"]),b,"h").w(" - ").f(b.getPath(!0,["highRes"]),b,"h").w("</td><td>").f(b.getPath(!0,["method"]),b,"h").w("</td><td>").f(b.getPath(!0,["enantiomorph"]),b,"h").w("</td><td>").f(b.getPath(!0,["spaceGroup"]),b,"h").w(" (").f(b.getPath(!0,["spaceGroupShortName"]),b,"h").w(")</td><td>").f(b.getPath(!0,["solventContent"]),b,"h").w("</td><td><table>").s(b.getPath(!0,["statistics"]),b,{block:e},{}).w("</table>  </td></tr>  ")}function e(a,b){return a.w("<tr><td>").f(b.getPath(!0,["name"]),b,"h").w("</td><td>").f(b.getPath(!0,["value"]),b,"h").w("</td><tr>")}return a.register("phasinggrid.stats",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<div><table>").s(b.getPath(!0,["0"]),b,{block:c},{}).w(" ").s(b.getPath(!0,[]),b,{block:d},{}).w("       </table></div>")}function c(a,b){return a.w("<tr><th class=\"datacollection_parameter_name\" style='width:70px;'>Type</th><th class=\"datacollection_parameter_name\" style='width:70px;'>Program</th><th class=\"datacollection_parameter_name\" style='width:70px;'>Resolution</th><th  class=\"datacollection_parameter_name\"style='width:70px;'>Method</th></tr>  ")}function d(a,b){return a.w("	<tr class='selectable_row'><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["phasingStepType"]),b,"h").w("</td>        <td class='summary_datacollection_parameter'>").f(b.getPath(!0,["phasingPrograms"]),b,"h").w("</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["lowRes"]),b,"h").w(" - ").f(b.getPath(!0,["highRes"]),b,"h").w("</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["method"]),b,"h").w("</td></tr> ")}return a.register("phasinggrid.substructure",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.s(b.get(["prepare"],!1),b,{block:c},{}).w("<br />").s(b.get(["prepare"],!1),b,{block:d},{}).w("<br />").s(b.get(["substructure"],!1),b,{block:h},{}).w("<br />").s(b.get(["phasing"],!1),b,{block:n},{}).w("<br />").s(b.get(["models"],!1),b,{block:v},{}).w("<br /><br />")}function c(a,b){return a.w("<span style='font-size:12px;'>").f(b.getPath(!0,["spaceGroup"]),b,"h").w(" (").f(b.getPath(!0,["spaceGroupShortName"]),b,"h").w(")</span>  ")}function d(a,b){return a.h("eq",b,{block:e},{key:b.get(["status"],!1),value:"Success"},"h").h("eq",b,{block:f},{key:b.get(["status"],!1),value:"Failure"},"h").h("eq",b,{block:g},{key:b.get(["status"],!1),value:"Not found"},"h").f(b.getPath(!0,["type"]),b,"h")}function e(a,b){return a.w("<div class='summary_datacollection_success'></div>")}function f(a,b){return a.w("<div class='summary_datacollection_failed'></div>")}function g(a,b){return a.w("<div class='summary_datacollection_noFound'></div>")}function h(a,b){return a.h("eq",b,{block:i},{key:b.get(["status"],!1),value:"Success"},"h").h("eq",b,{block:j},{key:b.get(["status"],!1),value:"Failure"},"h").h("eq",b,{block:k},{key:b.get(["status"],!1),value:"Not found"},"h").h("gt",b,{block:l},{key:b.get(["runs"],!1),value:0},"h").h("eq",b,{block:m},{key:b.get(["runs"],!1),value:0},"h")}function i(a,b){return a.w("<div class='summary_datacollection_success'></div>")}function j(a,b){return a.w("<div class='summary_datacollection_failed'></div>")}function k(a,b){return a.w("<div class='summary_datacollection_noFound'></div>")}function l(a,b){return a.w(" ").f(b.getPath(!0,["type"]),b,"h").w("  <span style='color:gray;font-size:10px'>(").f(b.getPath(!0,["runs"]),b,"h").w(" runs)</span> ")}function m(a,b){return a.w(" <span style='color:gray;font-size:10px'> ").f(b.getPath(!0,["type"]),b,"h").w(" (").f(b.getPath(!0,["runs"]),b,"h").w(" runs)</span> ")}function n(a,b){return a.h("eq",b,{block:o},{key:b.get(["status"],!1),value:"Success"},"h").h("eq",b,{block:p},{key:b.get(["status"],!1),value:"Failure"},"h").h("eq",b,{block:q},{key:b.get(["status"],!1),value:"Not found"},"h").h("gt",b,{block:r},{key:b.get(["runs"],!1),value:0},"h").h("eq",b,{block:s},{key:b.get(["runs"],!1),value:0},"h").h("gt",b,{block:t},{key:b.get(["runs"],!1),value:0},"h")}function o(a,b){return a.w("<div class='summary_datacollection_success'></div>")}function p(a,b){return a.w("<div class='summary_datacollection_failed'></div>")}function q(a,b){return a.w("<div class='summary_datacollection_noFound'></div>")}function r(a,b){return a.w(" ").f(b.getPath(!0,["type"]),b,"h").w("  <span style='color:gray;font-size:10px'>(").f(b.getPath(!0,["runs"]),b,"h").w(" runs)</span> ")}function s(a,b){return a.w(" <span style='color:gray;font-size:10px'> ").f(b.getPath(!0,["type"]),b,"h").w(" (").f(b.getPath(!0,["runs"]),b,"h").w(" runs)</span> ")}function t(a,b){return a.w("   ").s(b.get(["stats"],!1),b,{block:u},{})}function u(a,b){return a.w("<table style='margin-left:30px;'><tr><td> ").f(b.getPath(!0,["successCondition"]),b,"h").w(" runs with successful stats</td></tr><tr><td> ").f(b.getPath(!0,["withStatistics"]),b,"h").w(" runs with statistics</td></tr><tr><td> ").f(b.getPath(!0,["withoutStatistics"]),b,"h").w(" runs with no statistics</td></tr></table>")}function v(a,b){return a.h("eq",b,{block:w},{key:b.get(["status"],!1),value:"Success"},"h").h("eq",b,{block:x},{key:b.get(["status"],!1),value:"Failure"},"h").h("eq",b,{block:y},{key:b.get(["status"],!1),value:"Not found"},"h").h("gt",b,{block:z},{key:b.get(["runs"],!1),value:0},"h").h("eq",b,{block:A},{key:b.get(["runs"],!1),value:0},"h")}function w(a,b){return a.w("<div class='summary_datacollection_success'></div>")}function x(a,b){return a.w("<div class='summary_datacollection_failed'></div>")}function y(a,b){return a.w("<div class='summary_datacollection_noFound'></div>")}function z(a,b){return a.w(" ").f(b.getPath(!0,["type"]),b,"h").w("  <span style='color:gray;font-size:10px'>(").f(b.getPath(!0,["runs"]),b,"h").w(" runs)</span> ")}function A(a,b){return a.w(" <span style='color:gray;font-size:10px'> ").f(b.getPath(!0,["type"]),b,"h").w(" (").f(b.getPath(!0,["runs"]),b,"h").w(" runs)</span> ")}return a.register("phasinglistview",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,p.__dustBody=!0,q.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,t.__dustBody=!0,u.__dustBody=!0,v.__dustBody=!0,w.__dustBody=!0,x.__dustBody=!0,y.__dustBody=!0,z.__dustBody=!0,A.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<select id="').f(b.get(["id"],!1),b,"h").w("-").f(b.get(["containerId"],!1),b,"h").w('" class="beamlines-select" style="pointer-events:none" disabled>').s(b.get(["beamlines"],!1),b,{block:c},{}).w("</select>")}function c(a,b){return a.w("<option value=").f(b.get(["containerId"],!1),b,"h").w(" ").h("eq",b,{block:d},{key:e,value:f},"h").w(">").f(b.getPath(!0,[]),b,"h").w("</option>")}function d(a,b){return a.w("selected")}function e(a,b){return a.f(b.getPath(!0,[]),b,"h")}function f(a,b){return a.f(b.get(["selected"],!1),b,"h")}return a.register("beamlines.combobox.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container"><div class="row"><div class="col-xs-6 col-md-6"><div id="previous-button-div" class="previous-button-div"><button id="previous-button" class="btn btn-lg btn-success" type="button"><i class="icon-next"></i> Previous</button></div> </div><div class="col-xs-6 col-md-6"><div id="next-button-div" class="next-button-div"><button id="next-button" class="btn btn-lg btn-success"type="button"><i class="icon-next"></i> Next</button></div></div></div></div>')}return a.register("buttons.prepare.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="steps-container"><div class="container"><div class="row"><div class="stepwizard"><div class="stepwizard-row"><div class="stepwizard-step"><a id="step-1" class="btn btn-default btn-circle step-btn" >1</a><p>Select Shipment</p></div><div class="stepwizard-step"><a id="step-2" class="btn btn-default btn-circle step-btn" >2</a><p>Load Sample Changer</p></div></div></div></div></div></div>')}return a.register("toolbar.prepare.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("Code : ").f(b.getPath(!0,["Container_code"]),b,"h").w("<br />Type: ").f(b.getPath(!0,["Container_containerType"]),b,"h").w("<br />Status : ").f(b.getPath(!0,["Dewar_dewarStatus"]),b,"h").w("<br />Beamline : ").f(b.getPath(!0,["Container_beamlineLocation"]),b,"h").w("<br />Date: ").f(b.getPath(!0,["Shipping_bltimeStamp"]),b,"h")}return a.register("puck.listview",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid"><div class="row"><div style=\'font-size:10px;text-align:center;\' class="col-sm-2 col-md-1 " style=\'margin: 0 10px 0px 0;\'><a href=\'#/mx/datacollection/session/').f(b.getPath(!0,["sessionId"]),b,"h").w('/main\' title=\'click to go\' type="button" class="btn btn-link">').f(b.getPath(!0,["month"]),b,"h").w(" ").f(b.getPath(!0,["day"]),b,"h").w(" ").f(b.getPath(!0,["year"]),b,"h").w("</a><br />").f(b.getPath(!0,["beamLineName"]),b,"h").w("<br />").f(b.getPath(!0,["beamLineOperator"]),b,"h").w("</div><div style='font-size:14px;text-align:center;' class=\"col-sm-2 col-md-1\" ><a href='#/mx/datacollection/session/").f(b.getPath(!0,["sessionId"]),b,"h").w("/main'   title=\"").f(b.getPath(!0,["Proposal_title"]),b,"h").w('" class="btn btn-link">').f(b.getPath(!0,["Proposal_proposalCode"]),b,"h").f(b.getPath(!0,["Proposal_ProposalNumber"]),b,"h").w("</a><br />").f(b.getPath(!0,["nbShifts"]),b,"h").w(' shifts     </div><div class="col-sm-1"  style=\'margin: 10px 10px 0px 0;\'><!-- List group --><ul class="list-group">').h("gt",b,{block:c},{key:b.get(["sampleCount"],!1),value:0},"h").w('</ul></div><div class="col-sm-1"  style=\'margin: 10px 10px 0px 0;\'><!-- List group --><ul class="list-group">').h("gt",b,{block:d},{key:b.get(["testDataCollectionGroupCount"],!1),value:0},"h").w('</ul></div><div class="col-sm-1"  style=\'margin: 10px 10px 0px 0;\'><!-- List group --><ul class="list-group">').h("gt",b,{block:e},{key:b.get(["dataCollectionGroupCount"],!1),value:0},"h").w('</ul></div><div class="col-sm-1"  style=\'margin: 10px 10px 0px 0;\'><!-- List group --><ul class="list-group">').h("gt",b,{block:f},{key:b.get(["xrfSpectrumCount"],!1),value:0},"h").w('</ul></div><div class="col-sm-1"  style=\'margin: 10px 10px 0px 0;\'><!-- List group --><ul class="list-group">        ').h("gt",b,{block:g},{key:b.get(["energyScanCount"],!1),value:0},"h").w("        </ul></div><div class=\"col-sm-3\"  style='margin: 10px 10px 0px 0;'>").f(b.getPath(!0,["comments"]),b,"h").w("</div></div></div>")}function c(a,b){return a.w('<li class="list-group-item"><span style=\'background-color:#337ab7;\' class="badge badge-primary">').f(b.getPath(!0,["sampleCount"]),b,"h").w("</span>Samples</li>")}function d(a,b){return a.w('<li class="list-group-item"><span style=\'background-color:#337ab7;\' class="badge">').f(b.getPath(!0,["testDataCollectionGroupCount"]),b,"h").w("</span>Tests</li>")}function e(a,b){return a.w('<li class="list-group-item"><span style=\'background-color:#337ab7;\' class="badge">').f(b.getPath(!0,["dataCollectionGroupCount"]),b,"h").w("</span>Collect.</li>")}function f(a,b){return a.w('<li class="list-group-item"><span style=\'background-color:#337ab7;\' class="badge">').f(b.getPath(!0,["xrfSpectrumCount"]),b,"h").w("</span>XRF</li>")}function g(a,b){return a.w('<li class="list-group-item"><span style=\'background-color:#337ab7;\' class="badge">').f(b.getPath(!0,["energyScanCount"]),b,"h").w("</span>En. Scans</li>")}return a.register("session.grid",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table><tr><td  class='summary_datacollection_parameter_name'>Space Group</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["spaceGroupShortName"]),b,"h").w(" (").f(b.getPath(!0,["spaceGroup"]),b,"h").w(")</td></tr><tr><td  class='summary_datacollection_parameter_name'>Type</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["phasingStepType"]),b,"h").w(" (").f(b.getPath(!0,["phasingPrograms"]),b,"h").w(")</td></tr><tr><td  class='summary_datacollection_parameter_name'>Method</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["method"]),b,"h").w("</td></tr><tr><td  class='summary_datacollection_parameter_name'>Resolution</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["lowRes"]),b,"h").w(" - ").f(b.getPath(!0,["highRes"]),b,"h").w("</td></tr><tr><td  class='summary_datacollection_parameter_name'>Protein</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["acronym"]),b,"h").w("</td></tr><tr><td  class='summary_datacollection_parameter_name'>Start Time</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["phasingStartTime"]),b,"h").w("</td></tr><tr><td  class='summary_datacollection_parameter_name'>End Time</td><td class='summary_datacollection_parameter'>").f(b.getPath(!0,["phasingEndTime"]),b,"h").w("</td></tr></table>")}return a.register("summaryphasinggrid.first.step",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.h("eq",b,{block:c},{key:b.get(["type"],!1),value:"images"},"h").h("eq",b,{block:e},{key:b.get(["type"],!1),value:"image"},"h").h("eq",b,{block:f},{key:b.get(["type"],!1),value:"logFile"},"h").h("eq",b,{block:g},{key:b.get(["type"],!1),value:"title"},"h").h("eq",b,{block:h},{key:b.get(["type"],!1),value:"info"},"h").h("eq",b,{block:i},{key:b.get(["type"],!1),value:"warning"},"h").h("eq",b,{block:j},{key:b.get(["type"],!1),value:"table"},"h").w("  ")}function c(a,b){return a.w('<table align="center"><tr>').s(b.get(["items"],!1),b,{block:d},{}).w("</tr>	</table>	")}function d(a,b){return a.w('<td><a href="data:image/png;base64,').f(b.getPath(!0,["value"]),b,"h").w("\" data-lightbox='a' data-title=\"").f(b.getPath(!0,["title"]),b,"h").w('"><img height="').f(b.getPath(!0,["ysize"]),b,"h").w('" width="').f(b.getPath(!0,["xsize"]),b,"h").w('" src="data:image/png;base64,').f(b.getPath(!0,["value"]),b,"h").w("\" /></a><br /><span class='summary_datacollection_parameter'>").f(b.getPath(!0,["title"]),b,"h").w("</span></td></div>	")}function e(a,b){return a.w('<div align="center"><img height="200" width="200" src="data:image/png;base64,').f(b.getPath(!0,["value"]),b,"h").w("\" /><br /><span class='summary_datacollection_parameter'>").f(b.getPath(!0,["title"]),b,"h").w("</span></div>			")}function f(a,b){return a.w('<div class="container"><button id=').f(b.getPath(!0,["id"]),b,"h").w(' style=\'margin:10px;\'  type="button" class="btn btn-default"><span class="glyphicon glyphicon-download-alt"></span> ').f(b.getPath(!0,["title"]),b,"h").w("</button></div>				")}function g(a,b){return a.w("<div><h1 >").f(b.getPath(!0,["value"]),b,"h").w("</h1></div>			")}function h(a,b){return a.w('<div class="container"><div class="alert alert-info">').f(b.getPath(!0,["value"]),b,"h").w("</div></div>	   		")}function i(a,b){return a.w('<div class="container"><div class="alert alert-warning">').f(b.getPath(!0,["value"]),b,"h").w("</div></div>	   		")}function j(a,b){return a.w('<div class="container"><table class="table table-hover table-striped table-bordered"> <tr>                    <th style=\'background-color:#3892d3;color:white;font-size:14px;\' colspan=').f(b.getPath(!0,["columns","length"]),b,"h").w(">").f(b.getPath(!0,["title"]),b,"h").w("</th>                   </tr>                    <tr>").s(b.get(["columns"],!1),b,{block:k},{}).w("</tr>	").s(b.get(["data"],!1),b,{block:l},{}).w("</table> </div>                                  		")}function k(a,b){return a.w("<th>").f(b.getPath(!0,[]),b,"h").w("</th>")}function l(a,b){return a.w("<tr>").s(b.getPath(!0,[]),b,{block:m},{}).w("</tr> ")}function m(a,b){return a.w("<td>").f(b.getPath(!0,[]),b,"h").w("</td>")}return a.register("workflowmainview.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.s(b.getPath(!0,[]),b,{block:c},{}).w("	")}function c(a,b){return a.w("<table><tr><td style='text-align:center;'>").h("eq",b,{block:d},{key:b.get(["status"],!1),value:"Success"},"h").h("eq",b,{block:e},{key:b.get(["status"],!1),value:"Failure"},"h").w("<span>").f(b.getPath(!0,["workflowStepType"]),b,"h").w('</span></td></tr><tr><td><img src="').f(b.getPath(!0,["imageURL"]),b,"h").w("\" style='border:1px solid #3892d3;' alt=\"").f(b.getPath(!0,["workflowStepType"]),b,"h").w('" height="100" width="100"></td></tr></table>')}function d(a,b){return a.w("<div class='summary_datacollection_success'></div>")}function e(a,b){return a.w("<div class='summary_datacollection_failed'></div>")}return a.register("workflowstepmain_steps",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid"><div class="panel with-nav-tabs panel-default"><div class="panel-heading clearfix"><div class="pull-left"><h1 class="panel-title" style=\'color:#337ab7;\'><span style=\'font-size:12px;\'>   ').f(b.getPath(!0,["startTime"]),b,"h").w('</span></h1></div><div class="pull-right"><ul class="nav nav-tabs"><li class="active"><a data-toggle="tab" href="#datacollection_').f(b.get(["DataCollection_dataCollectionId"],!1),b,"h").w('">Summary </a></li></ul></div></div><br /><div class="tab-content"><div id="datacollection_').f(b.get(["DataCollection_dataCollectionId"],!1),b,"h").w('" class="tab-pane fade in active"><div class="container-fluid"><div class="row"><div class="col-xs-6 col-md-6"><table class="table table-condensed"><tr>      <td >Start Time</td><td class=\'column_parameter_value\'>').f(b.getPath(!0,["startTime"]),b,"h").w("</td>        </tr><tr><td >Filename</td><td class='column_parameter_value'>").f(b.getPath(!0,["filename"]),b,"h").w("</td></tr><tr><td >Fluorescence Detector</td><td class='column_parameter_value'>To be added to DB</td></tr><tr><td >Energy</td><td class='column_parameter_value'> ").f(b.getPath(!0,["energy"]),b,"h").w(" kev</td></tr><tr><td >Flux @100%</td><td class='column_parameter_value'>").f(b.getPath(!0,["flux"]),b,"h").w(" ph/s</td>    </tr><tr>      <td >Transmission</td><td class='column_parameter_value'>").f(b.getPath(!0,["beamTransmission"]),b,"h").w("%</td></tr><tr>       <td style='width:150px;' >Beam Size Hor</td><td class='column_parameter_value'>").f(b.getPath(!0,["beamSizeHorizontal"]),b,"h").w(" micrometer</td></tr><tr>                            <td >Beam Size Vert</td><td class='column_parameter_value'>").f(b.getPath(!0,["beamSizeVertical"]),b,"h").w(" micrometer</td></tr><tr>                                <td >Exposure Time</td><td class='column_parameter_value'>").f(b.getPath(!0,["exposureTime"]),b,"h").w(" s</td>                                    </tr><tr>                                <td >Directory</td><td class='column_parameter_value'>").f(b.getPath(!0,["workingDirectory"]),b,"h").w('</td>                                    </tr></table></div><div class="col-xs-2 col-md-2"><div id=\'').f(b.getPath(!0,["containerId"]),b,"h").w("'></div><br /><a href='#/mx/xfe/").f(b.getPath(!0,["xfeFluorescenceSpectrumId"]),b,"h").w('/main\' type="button" class="btn btn-default">Open</a></div>        </div></div></div></div></div>')}return a.register("xfescangrid.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid"><div class="row"><div class="col-xs-12 col-md-12"><table class="table table-striped table-hover"><thead><tr><th >type</th><th >PDB</th><th >FirFile</th><th >LogFile</th><th >chiSqrt</th><th >rfactor</th><th >rg</th></tr></thead>').s(b.getPath(!0,[]),b,{block:c},{}).w("</table></div></div></div>")}function c(a,b){return a.w("<tr class=").f(b.getPath(!0,["rowClass"]),b,"h").w("><td>").f(b.getPath(!0,["type"]),b,"h").w("</td><td>").f(b.getPath(!0,["pdbFile"]),b,"h").w("</td><td>").f(b.getPath(!0,["firFile"]),b,"h").w("</td><td>").f(b.getPath(!0,["logFile"]),b,"h").w("</td><td>").h("decimal",b,{},{key:"chiSqrt",decimals:3},"h").w("  </td><td>").h("decimal",b,{},{key:"rfactor",decimals:3},"h").w(" </td><td>").h("decimal",b,{},{key:"rg",decimals:3},"h").w(" </td></tr>")}return a.register("abinitiogrid.template",b),b.__dustBody=!0,c.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<table id="').f(b.get(["id"],!1),b,"h").w('-frames-table" class="table table-hover small-padding-rows">').s(b.getPath(!0,[]),b,{block:c},{}).w("</table>")}function c(a,b){return a.w("<tr><td id='").f(b.getPath(!0,["domId"]),b,"h").w('\' class="frame-cell-element" style="cursor:pointer"><span class="unselectable-text" style="pointer-events:none;">').h("fileName",b,{},{},"h").w("</span>").x(b.getPath(!0,["discarded"]),b,{block:d},{}).w("</td><tr>")}function d(a,b){return a.w('<span class="unselectable-text" style="color:red;pointer-events:none;"> (discarded)</span>')}return a.register("frames.grid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="panel panel-primary"><div class="panel-heading"><h3>').f(b.getPath(!0,["name"]),b,"h").w(' </h3></div><div class="panel-body"><div class="row"><div class="col-sm-11"> Date: ').f(b.getPath(!0,["creationDate"]),b,"h").w('</div><div class="col-sm-1"><a href="').f(b.getPath(!0,["url"]),b,"h").w('">Download HDF5<span class="glyphicon glyphicon-download" style=\'font-size:14px;\'></span></a> </div></div></div></div>')}return a.register("header.hplcmainview.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid"><div class="row"><div class="col-xs-12 col-md-12"><table class="table"><thead><tr><th>Frame</th><th>I0</th>                        <th>Rg</th><th>Mass</th><th>Vc</th><th>Qr</th><th>Quality</th><th>Download</th></tr></thead>').s(b.getPath(!0,[]),b,{block:c},{}).w("</table></div></div></div>")}function c(a,b){return a.w("<tr><td>").f(b.getPath(!0,["frame"]),b,"h").w("</td><td> ").h("decimal",b,{block:d},{key:"I0",decimals:1},"h").w("</td>                        <td>").h("decimal",b,{block:e},{key:"Rg",decimals:1},"h").w("</td>    <td>").h("decimal",b,{block:f},{key:"Mass",decimals:1},"h").w("</td>  <td>").h("decimal",b,{block:g},{key:"Vc",decimals:1},"h").w("</td>  <td>").h("decimal",b,{block:h},{key:"Qr",decimals:1},"h").w("</td>  <td>").h("decimal",b,{block:i},{key:"quality",decimals:1},"h").w('</td> <td> <a href="').f(b.getPath(!0,["downloadURL"]),b,"h").w('"><span class="glyphicon glyphicon-download" style=\'font-size:14px;\'></span></a>  </td> </tr>')}function d(a,b){return a}function e(a,b){return a}function f(a,b){return a}function g(a,b){return a}function h(a,b){return a}function i(a,b){return a}return a.register("summary.hplcmainview.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid persist-header" align="center"><div class="row text-center" style="border : 1px solid #ccc;"><div class="col-sm-3 queue-border-right-columns "><div>&nbsp;</div>Specimen<div class="row text-center"><div class="col-sm-4 queue-border-top-columns queue-border-right-columns">Macromolecule</div><div class="col-sm-4 queue-border-top-columns queue-border-right-columns">Conc.</div><div class="col-sm-4 queue-border-top-columns">Buffer</div></div></div> <div class="col-sm-5 queue-border-right-columns"><div>&nbsp;</div>Parameters<div class="row text-center"><div class="col-sm-2 queue-border-top-columns queue-border-right-columns">Exp. Temp.</div><div class="col-sm-2 queue-border-top-columns queue-border-right-columns">Vol. Load</div><div class="col-sm-2 queue-border-top-columns queue-border-right-columns">Trans.</div><div class="col-sm-2 queue-border-top-columns queue-border-right-columns">wait T.</div><div class="col-sm-2 queue-border-top-columns queue-border-right-columns">Flow</div><div class="col-sm-2 queue-border-top-columns">Viscosity</div></div></div> <div class="col-sm-2 queue-border-right-columns" ><div>&nbsp;</div>Status<div>&nbsp;</div></div><div class="col-sm-2 queue-border-right-columns" ><div>&nbsp;</div>Time<div>&nbsp;</div></div></div>  </div>  <div id="').f(b.get(["id"],!1),b,"h").w('-scrollable" style="display: block;">').s(b.getPath(!0,[]),b,{block:c},{}).w("</div>")}function c(a,b){return a.w('<div class="container-fluid persist-header"><div class="row queue-border-bottom-columns" ').x(b.get(["Run_runId"],!1),b,{block:d},{}).w('><div class="col-sm-3 "><div class="row"><div class="col-sm-4">').f(b.getPath(!0,["Macromolecule_acronym"]),b,"h").w('</div><div class="col-sm-4">').f(b.getPath(!0,["Specimen_concentration"]),b,"h").w('</div><div class="col-sm-4 ">').f(b.getPath(!0,["Buffer_acronym"]),b,"h").w("<span style='font-style:oblique;'> Plate: [").f(b.getPath(!0,["SamplePlate_slotPositionColumn"]),b,"h").w(",").f(b.getPath(!0,["samplePlateLetter"]),b,"h").w("-").f(b.getPath(!0,["SamplePlatePosition_columnNumber"]),b,"h").w(']</span></div></div></div> <div class="col-sm-5 "><div class="row"><div class="col-sm-2 ">').f(b.getPath(!0,["Run_exposureTemperature"]),b,"h").w('</div><div class="col-sm-2 ">').f(b.getPath(!0,["Measurement_volumeToLoad"]),b,"h").w('</div><div class="col-sm-2 ">').f(b.getPath(!0,["Measurement_transmission"]),b,"h").w('</div><div class="col-sm-2 ">').f(b.getPath(!0,["Measurement_waitTime"]),b,"h").w('</div><div class="col-sm-2 ">').f(b.getPath(!0,["Measurement_flow"]),b,"h").w('</div><div class="col-sm-2 ">').f(b.getPath(!0,["Measurement_viscosity"]),b,"h").w("</div></div></div> <div class=\"col-sm-2 \"><span style='font-weight: bold;'>").x(b.get(["Run_runId"],!1),b,{block:e},{}).w('</span></div><div class="col-sm-2 "></div></div>  </div>')}function d(a,b){return a.w('style="background:rgb(188,245,169);"')}function e(a,b){return a.w("DONE")}return a.register("measurement.grid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid"><div class="row"><div class="col-xs-12 col-md-12"><table class="table small-padding-rows table-striped table-hover align-middle-header align-middle-rows valign-middle-header valign-middle-rows border-header"><thead><tr><th rowspan="2">Run</th><th rowspan="2" colspan="2">Sample</th><th rowspan="2" colspan="2">Frames <br /> (Average/Total)</th><th colspan="3">Guinier</th><th colspan="3">Gnom</th><th colspan="2">Porod</th><th rowspan="2">Scattering</th><th rowspan="2">Kratky.</th><th rowspan="2">Density</th><th rowspan="2">Guinier</th><th rowspan="2">Advanced</th></tr><tr><th>Rg</th><th>Points</th><th>I0</th><th>Rg</th><th>Total</th><th>D<sub>max</sub></th><th>Volume</th><th>MM Vol. est.</th></tr></thead>').s(b.getPath(!0,[]),b,{block:c},{}).w("</table></div></div></div>")}function c(a,b){return a.w("<tr class=").f(b.getPath(!0,["rowClass"]),b,"h").w("><td>").x(b.getPath(!0,["Macromolecule_macromoleculeId"]),b,{"else":d,block:e},{}).w("</td><td>").x(b.getPath(!0,["Macromolecule_macromoleculeId"]),b,{block:f},{}).w("</td><td>").x(b.getPath(!0,["Macromolecule_macromoleculeId"]),b,{"else":g,block:h},{}).w('</td><td><div  style="background-color:').h("framesColor",b,{},{},"h").w(';">').x(b.get(["Merge_framesMerge"],!1),b,{"else":i,block:j},{}).w(" / ").x(b.get(["Merge_framesCount"],!1),b,{"else":k,block:l},{}).w('</div></td><td><a href="').f(b.getPath(!0,["urlSpecific"]),b,"h").w('"><span class="glyphicon glyphicon-download" style=\'font-size:14px;\'></span></a></td>').x(b.getPath(!0,["Macromolecule_macromoleculeId"]),b,{"else":m,block:n},{}).x(b.getPath(!0,["rowSpan"]),b,{block:E},{}).w("</tr>")}function d(a,b){return a.w("<kbd style='background-color:gray'>#").f(b.getPath(!0,["Measurement_code"]),b,"h").w("</kbd>")}function e(a,b){return a.w("<kbd style='background-color:#207a7a'>#").f(b.getPath(!0,["Measurement_code"]),b,"h").w("</kbd>");
}function f(a,b){return a.w('<a href="').f(b.getPath(!0,["urlDownload"]),b,"h").w('"><span class="glyphicon glyphicon-download" style=\'font-size:14px;\'></span></a>                        ')}function g(a,b){return a.f(b.getPath(!0,["Buffer_acronym"]),b,"h")}function h(a,b){return a.w("<b>").f(b.getPath(!0,["Macromolecule_acronym"]),b,"h").w(" </b>                                    <br /> ").h("decimal",b,{},{key:"Specimen_concentration",decimals:3},"h").w(" <span style='font-size:9px;color:gray'>  mg/ml</span><br /> ").f(b.getPath(!0,["Run_exposureTemperature"]),b,"h").w(" C ")}function i(a,b){return a.w("NA")}function j(a,b){return a.f(b.getPath(!0,["Merge_framesMerge"]),b,"h")}function k(a,b){return a.w("NA")}function l(a,b){return a.f(b.getPath(!0,["Merge_framesCount"]),b,"h")}function m(a,b){return a.w("<td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>")}function n(a,b){return a.w("<td><span ").nx(b.get(["Subtraction_rg"],!1),b,{"else":o,block:p},{}).w("</td><td><span ").nx(b.get(["Subtraction_rg"],!1),b,{"else":q,block:r},{}).w("</span></td><td><span ").nx(b.get(["Subtraction_I0"],!1),b,{"else":s,block:t},{}).w("</td><td><span ").nx(b.get(["Subtraction_rgGnom"],!1),b,{"else":u,block:v},{}).w("</td><td><span ").nx(b.get(["Subtraction_total"],!1),b,{"else":w,block:x},{}).w("</span></td><td><span ").nx(b.get(["Subtraction_dmax"],!1),b,{"else":y,block:z},{}).w("</td><td><span ").nx(b.get(["Subtraction_volume"],!1),b,{"else":A,block:B},{}).w("</td><td><span ").nx(b.get(["Subtraction_volume"],!1),b,{"else":C,block:D},{}).w("</td>")}function o(a,b){return a.w(">").h("decimal",b,{},{key:"Subtraction_rg",decimals:3},"h").w("</span><span style='font-size:10px;color:gray'>  nm</span>")}function p(a,b){return a.w("class='notavailablefield'>NA</span>")}function q(a,b){return a.w(">").f(b.getPath(!0,["Subtraction_firstPointUsed"]),b,"h").w(" - ").f(b.getPath(!0,["Subtraction_lastPointUsed"]),b,"h").w(" (").h("math",b,{},{key:b.get(["Subtraction_lastPointUsed"],!1),method:"subtract",operand:b.getPath(!0,["Subtraction_firstPointUsed"])},"h").w(")")}function r(a,b){return a.w("class='notavailablefield'>NA")}function s(a,b){return a.w(">").h("decimal",b,{},{key:"Subtraction_I0",decimals:1},"h").w("</span><span style='font-size:10px'> &#177; ").h("exponential",b,{},{key:"Subtraction_I0Stdev",decimals:3},"h").w("</span>")}function t(a,b){return a.w("class='notavailablefield'>NA</span>")}function u(a,b){return a.w(">").h("decimal",b,{},{key:"Subtraction_rgGnom",decimals:3},"h").w("</span><span style='font-size:10px;color:gray'>  nm</span>")}function v(a,b){return a.w("class='notavailablefield'>NA</span>")}function w(a,b){return a.w(">").h("decimal",b,{},{key:"Subtraction_total",decimals:3},"h")}function x(a,b){return a.w("class='notavailablefield'>NA")}function y(a,b){return a.w(">").h("decimal",b,{},{key:"Subtraction_dmax",decimals:3},"h").w("</span><span style='font-size:10px;color:gray'>  nm</span>")}function z(a,b){return a.w("class='notavailablefield'>NA</span>")}function A(a,b){return a.w(">").h("decimal",b,{},{key:"Subtraction_volume",decimals:3},"h").w("</span><span style='font-size:8px;color:gray;'> nm<sub>3</sub></span>")}function B(a,b){return a.w("class='notavailablefield'>NA</span>")}function C(a,b){return a.w(">").h("mmVolTest",b,{},{},"h").w("</span><span style='font-size:8px;color:gray;'> kD</span>")}function D(a,b){return a.w("class='notavailablefield'>NA</span>")}function E(a,b){return a.w('<td rowspan="').f(b.getPath(!0,["rowSpan"]),b,"h").w('" class="blue-bottom-border-row" style="border-left:1px solid #ccc;"><a href="').f(b.getPath(!0,["scattering"]),b,"h").w('" data-lightbox="').f(b.getPath(!0,["scattering"]),b,"h").w('" data-title="Scattering"><center><img id="scattering-').f(b.getPath(!0,["MeasurementToDataCollection_dataCollectionId"]),b,"h").w('" alt="Image not found" class="img-responsive" data-src="').f(b.getPath(!0,["scattering"]),b,"h").w('" style="display: block;margin:0px;" height="150px" width="150px"/></center></a> </td><td rowspan="').f(b.getPath(!0,["rowSpan"]),b,"h").w('" class="blue-bottom-border-row"><a href="').f(b.getPath(!0,["kratky"]),b,"h").w('" data-lightbox="').f(b.getPath(!0,["kratky"]),b,"h").w('" data-title="Kratky"><center><img id="kratky-').f(b.getPath(!0,["MeasurementToDataCollection_dataCollectionId"]),b,"h").w('" alt="Image not found" class="img-responsive" data-src="').f(b.getPath(!0,["kratky"]),b,"h").w('" style="display: block;margin:0px;" height="150px" width="150px"/></center></a>  </td><td rowspan="').f(b.getPath(!0,["rowSpan"]),b,"h").w('" class="blue-bottom-border-row"><a href="').f(b.getPath(!0,["density"]),b,"h").w('" data-lightbox="').f(b.getPath(!0,["density"]),b,"h").w('" data-title="Density"><center><img id="density-').f(b.getPath(!0,["MeasurementToDataCollection_dataCollectionId"]),b,"h").w('" alt="Image not found" class="img-responsive" data-src="').f(b.getPath(!0,["density"]),b,"h").w('" style="display: block;margin:0px;" height="150px" width="150px"/></center></a> </td><td rowspan="').f(b.getPath(!0,["rowSpan"]),b,"h").w('" class="blue-bottom-border-row"><a href="').f(b.getPath(!0,["guinier"]),b,"h").w('" data-lightbox="').f(b.getPath(!0,["guinier"]),b,"h").w('" data-title="Guinier"><center><img id="guinier-').f(b.getPath(!0,["MeasurementToDataCollection_dataCollectionId"]),b,"h").w('" alt="Image not found" class="img-responsive" data-src="').f(b.getPath(!0,["guinier"]),b,"h").w('" style="display: block;margin:0px;" height="150px" width="150px" /></center></a> </td><td rowspan="').f(b.getPath(!0,["rowSpan"]),b,"h").w('" class="blue-bottom-border-row"><table class="table queue-small-padding-table table-queue-grid-borderless"><tbody><tr><td>').x(b.get(["dataReduction"],!1),b,{"else":F,block:G},{}).w('<span class="submit-text" style="color:black;"> Data Reduction</span></button></a></td></tr><tr><td>').x(b.get(["SubtractionToAbInitioModel_abinitioId"],!1),b,{"else":H,block:I},{}).w("</button></a> </td></tr><tr><td>").x(b.get(["fit"],!1),b,{"else":J,block:K},{}).w('<span class="submit-text" style="color:black;"> Fit</span></button></a></td></tr><tr><td>').x(b.get(["superposition"],!1),b,{"else":L,block:M},{}).w('<span class="submit-text" style="color:black;"> Superposition</span></button></a></td></tr><tr><td>').x(b.get(["rigidBody"],!1),b,{"else":N,block:O},{}).w('<span class="submit-text" style="color:black;"> Rigid Body</span></button></a></td></tr></tbody></table></td>')}function F(a,b){return a.w('<a><button class="btn-blue" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-remove" style="color:black;"></span>')}function G(a,b){return a.w("<a onclick=\"window.open('#/saxs/datacollection/dataCollectionId/").f(b.getPath(!0,["MeasurementToDataCollection_dataCollectionId"]),b,"h").w('/primaryviewer\',\'_blank\');window.close();return false"><button class="btn-green" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-ok" style="color:black;"></span>')}function H(a,b){return a.w('<a><button class="btn-blue" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-remove" style="color:black;"></span><span class="submit-text" style="color:black;"> Abinitio</span></a>')}function I(a,b){return a.w('<a href="#/saxs/datacollection/dataCollectionId/').f(b.getPath(!0,["MeasurementToDataCollection_dataCollectionId"]),b,"h").w('/abinitio" target=\'_blank\' ><button class="btn-green" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-ok" style="color:black;"></span><span class="submit-text" style="color:black;"> Abinitio</span></a>')}function J(a,b){return a.w('<a><button class="btn-blue" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-remove" style="color:black;"></span>')}function K(a,b){return a.w('<a><button class="btn-green" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-ok" style="color:black;"></span>')}function L(a,b){return a.w('<a><button class="btn-blue" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-remove" style="color:black;"></span>')}function M(a,b){return a.w('<a><button class="btn-green" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-ok" style="color:black;"></span>')}function N(a,b){return a.w('<a><button class="btn-blue" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-remove" style="color:black;"></span>')}function O(a,b){return a.w('<a><button class="btn-green" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-ok" style="color:black;"></span>')}return a.register("overview.queue.grid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,p.__dustBody=!0,q.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,t.__dustBody=!0,u.__dustBody=!0,v.__dustBody=!0,w.__dustBody=!0,x.__dustBody=!0,y.__dustBody=!0,z.__dustBody=!0,A.__dustBody=!0,B.__dustBody=!0,C.__dustBody=!0,D.__dustBody=!0,E.__dustBody=!0,F.__dustBody=!0,G.__dustBody=!0,H.__dustBody=!0,I.__dustBody=!0,J.__dustBody=!0,K.__dustBody=!0,L.__dustBody=!0,M.__dustBody=!0,N.__dustBody=!0,O.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<h2>").f(b.getPath(!0,["code"]),b,"h").w("</h2>").s(b.getPath(!0,[]),b,{block:c},{})}function c(a,b){return a.w("<br />Storage conditions: ").f(b.getPath(!0,["storageLocation"]),b,"h").w("<br />").f(b.getPath(!0,["comments"]),b,"h")}return a.register("parcelformsummary",b),b.__dustBody=!0,c.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid"><div class="row text-center"><div class="col-sm-1 border-columns" style="width: 4.166666666%">Run<div>&nbsp;</div></div> <div class="col-sm-1 border-columns" style="width: 12.5%">Frames <span style=\'font-size:10px;\'>(Average/Total)</span><div>&nbsp;</div></div> <div class="col-sm-1 border-columns" style="width: 4.166666666%;font-size:8px;">Exp. Temp.<div>&nbsp;</div></div><div class="col-sm-2 border-columns">Guinier<div class="row text-center"><div class="col-sm-4 border-right-columns">Rg</div><div class="col-sm-4 border-right-columns">Points</div><div class="col-sm-4">I0</div></div></div> <div class="col-sm-2 border-columns">Gnom<div class="row text-center"><div class="col-sm-4 border-right-columns">Rg</div><div class="col-sm-4 border-right-columns">Total</div><div class="col-sm-4">D<sub>max</sub></div></div></div> <div class="col-sm-1 border-columns" style="width: 12.5%">Porod<div class="row text-center"><div class="col-sm-6 border-right-columns">Volume</div><div class="col-sm-6" style=\'font-size:7px;\'>MM Vol. est.</div></div></div><div class="col-sm-1 border-columns">Scattering<div>&nbsp;</div></div> <div class="col-sm-1 border-columns">Kratky.<div>&nbsp;</div></div> <div class="col-sm-1 border-columns">Density<div>&nbsp;</div></div> <div class="col-sm-1 border-columns">Guinier.<div>&nbsp;</div></div></div></div>')}return a.register("queue.grid.header.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div class="container-fluid persist-header" ><div class="row text-center" style="border : 1px solid #ccc;"><div class="col-sm-7 " style="padding:0px;"><div class="container-fluid"><div class="row"><div class="col-sm-1  queue-border-right-columns" style="width:4.166666666%; padding:0;"><div>&nbsp;</div>Run<div>&nbsp;</div></div> <div class="col-sm-2  queue-border-right-columns" style="width:20.833333333%"><div>&nbsp;</div>Frames <span style=\'font-size:10px;\'>(Average/Total)</span><div>&nbsp;</div></div><div class="col-sm-3  queue-border-right-columns"><div>&nbsp;</div>Guinier<div class="row text-center"><div class="col-sm-4 queue-border-top-columns queue-border-right-columns">Rg</div><div class="col-sm-4 queue-border-top-columns queue-border-right-columns">Points</div><div class="col-sm-4 queue-border-top-columns ">I0</div></div></div> <div class="col-sm-3 queue-border-right-columns"><div>&nbsp;</div>Gnom<div class="row text-center"><div class="col-sm-4 queue-border-top-columns queue-border-right-columns">Rg</div><div class="col-sm-4 queue-border-top-columns queue-border-right-columns">Total</div><div class="col-sm-4 queue-border-top-columns ">D<sub>max</sub></div></div></div> <div class="col-sm-3 queue-border-right-columns"><div>&nbsp;</div>Porod<div class="row text-center"><div class="col-sm-6 queue-border-top-columns  queue-border-right-columns">Volume</div><div class="col-sm-6 queue-border-top-columns" style=\'font-size:7px;\'>MM Vol. est.</div></div></div> </div></div></div><div class="col-sm-4"  style="padding:0px;"><div class="col-sm-3  queue-border-right-columns" ><div>&nbsp;</div>Scattering<div>&nbsp;</div></div> <div class="col-sm-3 queue-border-right-columns " ><div>&nbsp;</div>Kratky.<div>&nbsp;</div></div> <div class="col-sm-3  queue-border-right-columns " ><div>&nbsp;</div>Density <div>&nbsp;</div></div> <div class="col-sm-3 queue-border-right-columns " ><div>&nbsp;</div>Guinier<div>&nbsp;</div></div></div><div class="col-sm-1"  style="padding:0px;"><div>&nbsp;</div>Advanced<div>&nbsp;</div></div></div></div>  <div id="').f(b.get(["id"],!1),b,"h").w('-scrollable" style="display: block; height: ').f(b.get(["height"],!1),b,"h").w('px; overflow-y: scroll">').s(b.get(["rows"],!1),b,{block:c},{}).w("</div>")}function c(a,b){return a.w('<div class="container-fluid queue-border-bottom-columns" style="padding-top:10px; padding-bottom:10px;"><div class="row"><div class="col-sm-7"  style="padding-left:0px;padding-right:0px;padding-bottom:0px;padding-top:10px;"><div class="container-fluid"><div class="row text-center"><div class="col-sm-1 " style="width:4.166666666%; padding:0;"><div class="row"><div class="col-sm-12"><table class="table queue-small-padding-table table-queue-grid-borderless"><tbody>').s(b.getPath(!0,["codes"]),b,{block:d},{}).w('</tbody></table></div> </div> </div> <div class="col-sm-2 " style="width:20.833333333%"><div class="row"><div class="col-sm-8"><table class="table  queue-small-padding-table table-queue-grid-borderless"><tbody><tr><td><b>').f(b.getPath(!0,["macromoleculeAcronym"]),b,"h").w("</b></td></tr><tr><td>").f(b.getPath(!0,["concentration"]),b,"h").w(" <span style='font-size:9px;color:gray'>  mg/ml</span></td></tr><tr><td>").f(b.getPath(!0,["expTemp"]),b,"h").w(' C</td></tr></tbody></table></div> <div class="col-sm-4"><table class="table  queue-small-padding-table table-queue-grid-borderless"><tbody>').s(b.getPath(!0,["averages"]),b,{block:e},{}).w('</tbody></table></div> </div></div><div class="col-sm-3"><div class="row text-center"><div class="col-sm-4" ><span ').h("eq",b,{"else":f,block:g},{key:b.get(["rg"],!1),value:"NA"},"h").w('</div><div class="col-sm-4" ><span ').h("eq",b,{"else":h,block:i},{key:b.get(["points"],!1),value:"NA"},"h").w('</span></div><div class="col-sm-4"><span ').h("eq",b,{"else":j,block:k},{key:b.get(["I0"],!1),value:"NA"},"h").w('</div></div></div> <div class="col-sm-3"><div class="row text-center"><div class="col-sm-4" ><span ').h("eq",b,{"else":l,block:m},{key:b.get(["rgGnom"],!1),value:"NA"},"h").w('</div><div class="col-sm-4" ><span ').h("eq",b,{"else":n,block:o},{key:b.get(["total"],!1),value:"NA"},"h").w('</span></div><div class="col-sm-4" ><span ').h("eq",b,{"else":p,block:q},{key:b.get(["dmax"],!1),value:"NA"},"h").w('</div></div></div> <div class="col-sm-3"><div class="row text-center"><div class="col-sm-6"><span ').h("eq",b,{"else":r,block:s},{key:b.get(["volumePorod"],!1),value:"NA"},"h").w('</div><div class="col-sm-6"><span ').h("eq",b,{"else":t,block:u},{key:b.get(["volumePorod"],!1),value:"NA"},"h").w('</div></div></div></div></div></div><div class="col-sm-4"  style="padding:0px;"><div class="container-fluid"><div class="row "><div class="col-sm-3 "><a href="').f(b.getPath(!0,["scattering"]),b,"h").w('" data-lightbox="').f(b.getPath(!0,["scattering"]),b,"h").w('" data-title="Scattering"><center><img alt="Image not found" class="img-responsive queue-img" src="').f(b.getPath(!0,["scattering"]),b,"h").w('" style="display: block;"  height="').f(b.getPath(!0,["imgWidth"]),b,"h").w('px" width="').f(b.getPath(!0,["imgWidth"]),b,"h").w('px"/></center></a>  </div> <div class="col-sm-3" ><a href="').f(b.getPath(!0,["kratky"]),b,"h").w('" data-lightbox="').f(b.getPath(!0,["kratky"]),b,"h").w('" data-title="Kratky"><center><img alt="Image not found" class="img-responsive queue-img" src="').f(b.getPath(!0,["kratky"]),b,"h").w('" style="display: block;"  height="').f(b.getPath(!0,["imgWidth"]),b,"h").w('px" width="').f(b.getPath(!0,["imgWidth"]),b,"h").w('px"/></center></a>                           </div> <div class="col-sm-3"><a href="').f(b.getPath(!0,["density"]),b,"h").w('" data-lightbox="').f(b.getPath(!0,["density"]),b,"h").w('" data-title="Density"><center><img alt="Image not found" class="img-responsive queue-img" src="').f(b.getPath(!0,["density"]),b,"h").w('" style="display: block;" height="').f(b.getPath(!0,["imgWidth"]),b,"h").w('px" width="').f(b.getPath(!0,["imgWidth"]),b,"h").w('px"/></center></a>                           </div> <div class="col-sm-3"><a href="').f(b.getPath(!0,["guinier"]),b,"h").w('" data-lightbox="').f(b.getPath(!0,["guinier"]),b,"h").w('" data-title="Guinier"><center><img alt="Image not found" class="img-responsive queue-img" src="').f(b.getPath(!0,["guinier"]),b,"h").w('" style="display: block;" height="').f(b.getPath(!0,["imgWidth"]),b,"h").w('px" width="').f(b.getPath(!0,["imgWidth"]),b,"h").w('px" /></center></a>                           </div> </div></div></div><div class="col-sm-1 text-center"  style="padding:0px;"><table class="table queue-small-padding-table table-queue-grid-borderless"><tbody><tr><td>').x(b.get(["dataReduction"],!1),b,{"else":v,block:w},{}).w('<span class="submit-text"> Data Reduction</span></button></td></tr><tr><td>').x(b.get(["abinitio"],!1),b,{"else":x,block:y},{}).w('<span class="submit-text"> Abinitio</span></button></td></tr><tr><td>').x(b.get(["fit"],!1),b,{"else":z,block:A},{}).w('<span class="submit-text"> Fit</span></button></td></tr><tr><td>').x(b.get(["superposition"],!1),b,{"else":B,block:C},{}).w('<span class="submit-text"> Superposition</span></button></td></tr><tr><td>').x(b.get(["rigidBody"],!1),b,{"else":D,block:E},{}).w('<span class="submit-text"> Rigid Body</span></button></td></tr></tbody></table></div></div></div>')}function d(a,b){return a.w("<tr><td># ").f(b.getPath(!0,[]),b,"h").w("</td></tr>")}function e(a,b){return a.w('<tr><td style="background-color:').f(b.getPath(!0,["color"]),b,"h").w(';">').f(b.getPath(!0,["text"]),b,"h").w("</td></tr>")}function f(a,b){return a.w(">").f(b.getPath(!0,["rg"]),b,"h").w("</span><span style='font-size:10px;color:gray'>  nm</span>")}function g(a,b){return a.w("class='notavailablefield'>NA</span>")}function h(a,b){return a.w(">").f(b.getPath(!0,["points"]),b,"h")}function i(a,b){return a.w("class='notavailablefield'>NA")}function j(a,b){return a.w(">").f(b.getPath(!0,["I0"]),b,"h").w("</span><span style='font-size:10px'> &#177; ").f(b.getPath(!0,["I0Stdev"]),b,"h").w("</span>")}function k(a,b){return a.w("class='notavailablefield'>NA</span>")}function l(a,b){return a.w(">").f(b.getPath(!0,["rgGnom"]),b,"h").w("</span><span style='font-size:10px;color:gray'>  nm</span>")}function m(a,b){return a.w("class='notavailablefield'>NA</span>")}function n(a,b){return a.w(">").f(b.getPath(!0,["total"]),b,"h")}function o(a,b){return a.w("class='notavailablefield'>NA")}function p(a,b){return a.w(">").f(b.getPath(!0,["dmax"]),b,"h").w("</span><span style='font-size:10px;color:gray'>  nm</span>")}function q(a,b){return a.w("class='notavailablefield'>NA</span>")}function r(a,b){return a.w(">").f(b.getPath(!0,["volumePorod"]),b,"h").w("</span><span style='font-size:8px;color:gray;'> nm<sub>3</sub></span>")}function s(a,b){return a.w("class='notavailablefield'>NA</span>")}function t(a,b){return a.w(">").f(b.getPath(!0,["mmvolest"]),b,"h").w("</span><span style='font-size:8px;color:gray;'> kD</span>")}function u(a,b){return a.w("class='notavailablefield'>NA</span>")}function v(a,b){return a.w('<button class="btn-blue" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-remove"></span>')}function w(a,b){return a.w('<button class="btn-green" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-ok"></span>')}function x(a,b){return a.w('<button class="btn-blue" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-remove"></span>')}function y(a,b){return a.w('<button class="btn-green" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-ok"></span>')}function z(a,b){return a.w('<button class="btn-blue" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-remove"></span>')}function A(a,b){return a.w('<button class="btn-green" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-ok"></span>')}function B(a,b){return a.w('<button class="btn-blue" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-remove"></span>')}function C(a,b){return a.w('<button class="btn-green" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-ok"></span>')}function D(a,b){return a.w('<button class="btn-blue" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-remove"></span>')}function E(a,b){return a.w('<button class="btn-green" type="submit" style="font-size:9px;width:90px; height:15px"><span class="glyphicon glyphicon-ok"></span>')}return a.register("queue.grid.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,h.__dustBody=!0,i.__dustBody=!0,j.__dustBody=!0,k.__dustBody=!0,l.__dustBody=!0,m.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,p.__dustBody=!0,q.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,t.__dustBody=!0,u.__dustBody=!0,v.__dustBody=!0,w.__dustBody=!0,x.__dustBody=!0,y.__dustBody=!0,z.__dustBody=!0,A.__dustBody=!0,B.__dustBody=!0,C.__dustBody=!0,D.__dustBody=!0,E.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<svg id="').f(b.get(["id"],!1),b,"h").w('-svg"  height="').f(b.getPath(!1,["formatter","height"]),b,"h").w('" width="').f(b.getPath(!1,["formatter","width"]),b,"h").w('"><rect x="0" y="0" width="').f(b.getPath(!1,["formatter","width"]),b,"h").w('" height="').f(b.getPath(!1,["formatter","height"]),b,"h").w('" fill="').f(b.getPath(!1,["formatter","backgroundColor"]),b,"h").w('"/>').s(b.get(["nodes"],!1),b,{block:c},{}).s(b.get(["text"],!1),b,{block:e},{}).w("</svg>")}function c(a,b){return a.w('<rect id="').f(b.getPath(!0,["squareId"]),b,"h").w('" visibility="hidden" x="').f(b.getPath(!0,["xSquare"]),b,"h").w('" y="').f(b.getPath(!0,["ySquare"]),b,"h").w('" width="').f(b.getPath(!0,["squareSide"]),b,"h").w('" height="').f(b.get(["squareSide"],!1),b,"h").w('" fill="#d2d2d2" class="plate-square" pointer-events="none"/><circle id="').f(b.getPath(!0,["nodeId"]),b,"h").w('" cx="').f(b.getPath(!0,["x"]),b,"h").w('" cy="').f(b.getPath(!0,["y"]),b,"h").w('" r="').f(b.getPath(!0,["radius"]),b,"h").w('" fill="').f(b.getPath(!1,["formatter","fill"]),b,"h").w('" stroke="').f(b.getPath(!1,["formatter","stroke"]),b,"h").w('" stroke-width="').f(b.getPath(!1,["formatter","stroke-width"]),b,"h").w('" ').x(b.get(["enableClick"],!1),b,{block:d},{}).w("></circle>")}function d(a,b){return a.w('cursor="pointer"')}function e(a,b){return a.w('<text x="').f(b.getPath(!0,["x"]),b,"h").w('" y="').f(b.getPath(!0,["y"]),b,"h").w('" fill="').f(b.getPath(!1,["formatter","title","fill"]),b,"h").w('" font-size="').f(b.getPath(!1,["formatter","title","fontSize"]),b,"h").w('" text-anchor="middle" pointer-events="none"><tspan dx="0" dy="0" pointer-events="none">').f(b.getPath(!0,["text"]),b,"h").w("</tspan></text>")}return a.register("sample.plate.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div id="container"><div style=\'float:left;\' id="left"><img class="titleImage" src="../images/logo_EXI.jpg" /><span class="title">ExiSAXS<span class="subtitle">Extended ISPyB forSAXS<sub style="font-size:10px;color:orange">BETA</sub></span></span></div><div id="center"></div><div style=\'float:right;width:120px;\' id="logos"><img class="logoImage" src="../images/logo_EMBL.png" /><img class="logoImage" src="../images/logo_ESRF.png" /></div><div style=\'float:right;width:120px;\' id="right"><div style=\'color:white;font-size:10px; \'>Version: ').f(b.getPath(!0,["version"]),b,"h").w("</div><div style='color:white;font-size:10px; '>Released: ").f(b.getPath(!0,["release_date"]),b,"h").w("</div><div style='color:white;font-size:10px;'>").f(b.getPath(!0,["database"]),b,"h").w("</div></div></div>")}return a.register("saxsheader",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w(" <kbd style='background-color:#AC58FA;font-size:12px;'>").f(b.getPath(!0,["experimentType"]),b,"h").w("</kbd><br />").f(b.getPath(!0,["creationDate"]),b,"h").w("<br />").f(b.getPath(!0,["name"]),b,"h").w('<br /><table style=\'margin-left:10px;\'>           <tr><td  style="height:10px;">Subtractions</td><td style=\'padding-left:10px;\'><div class="meter-wrap"><div class="meter-value" style="background-color: #99CC00 ; width: ').f(b.getPath(!0,["subtracted"]),b,"h").w('%;"><div class="meter-text">').f(b.getPath(!0,["dataCollectionDoneCount"]),b,"h").w(" of ").f(b.getPath(!0,["dataCollectionCount"]),b,"h").w("</div></div></div></td></tr></table>")}return a.register("hplc.sessionsaxslistview.template",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.h("eq",b,{block:c},{key:b.get(["experimentType"],!1),value:"STATIC"},"h").w("    ").h("eq",b,{block:d},{key:b.get(["experimentType"],!1),value:"SAMPLE CHANGER"},"h").w("   ").h("eq",b,{block:e},{key:b.get(["experimentType"],!1),value:"CALIBRATION"},"h").w("  ").h("eq",b,{block:f},{key:b.get(["experimentType"],!1),value:"HPLC"},"h").w("   ")}function c(a,b){return a.p("static.sessionsaxslistview.template",b,b,{})}function d(a,b){return a.p("static.sessionsaxslistview.template",b,b,{})}function e(a,b){return a.p("static.sessionsaxslistview.template",b,b,{})}function f(a,b){return a.p("hplc.sessionsaxslistview.template",b,b,{})}return a.register("sessionsaxslistview.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,e.__dustBody=!0,f.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w(" ").h("eq",b,{"else":c,block:d},{key:b.get(["experimentType"],!1),value:"STATIC"},"h").w(" <br />").f(b.getPath(!0,["creationDate"]),b,"h").w("<br />").f(b.getPath(!0,["name"]),b,"h").w('<br /><table style=\'margin-left:10px;\'><tr><td  style="height:10px;">Samples</td><td style=\'padding-left:10px;\'><div class="meter-wrap"><div class="meter-value" style="background-color: #99CC00 ; width: ').f(b.getPath(!0,["measured"]),b,"h").w('%;"><div class="meter-text">').f(b.getPath(!0,["measurementDoneCount"]),b,"h").w(" of ").f(b.getPath(!0,["measurementCount"]),b,"h").w('</div></div></div></td></tr><tr><td  style="height:10px;">Averages</td><td style=\'padding-left:10px;\'><div class="meter-wrap"><div class="meter-value" style="background-color: #99CC00 ; width: ').f(b.getPath(!0,["averaged"]),b,"h").w('%;"><div class="meter-text">').f(b.getPath(!0,["measurementAveragedCount"]),b,"h").w(" of ").f(b.getPath(!0,["measurementCount"]),b,"h").w('</div></div></div></td></tr><tr><td  style="height:10px;">Subtractions</td><td style=\'padding-left:10px;\'><div class="meter-wrap"><div class="meter-value" style="background-color: #99CC00 ; width: ').f(b.getPath(!0,["subtracted"]),b,"h").w('%;"><div class="meter-text">').f(b.getPath(!0,["dataCollectionDoneCount"]),b,"h").w(" of ").f(b.getPath(!0,["dataCollectionCount"]),b,"h").w("</div></div></div></td></tr></table>")}function c(a,b){return a.w("<kbd style='background-color:#2E9AFE;font-size:12px;'>").f(b.getPath(!0,["experimentType"]),b,"h").w("</kbd>")}function d(a,b){return a.w("       <kbd style='background-color:#088A08;font-size:12px;'>SAMPLE CHANGER</kbd>")}return a.register("static.sessionsaxslistview.template",b),b.__dustBody=!0,c.__dustBody=!0,d.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table> <tr><td>Macromolecule:</td><td style='color:#207a7a;font-weight:bold;'>").f(b.getPath(!0,["macromoleculeAcronym"]),b,"h").w(" ").f(b.getPath(!0,["record","data","concentration"]),b,"h").w(" mg/ml</td></tr><tr><td>Buffer:</td><td>").f(b.getPath(!0,["bufferAcronym"]),b,"h").w("</td></tr><tr><td>Storage Temperature:</td><td>").f(b.getPath(!0,["storageTemperature"]),b,"h").w("</td></tr></table>")}return a.register("stocksolution.listview",b),b.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w("<table>").s(b.getPath(!0,[]),b,{block:c},{}).w("</table>")}function c(a,b){return a.w("<tr><td>").f(b.getPath(!0,["count"]),b,"h").w("</td><td>").f(b.getPath(!0,["step"]),b,"h").w("</td></tr>")}return a.register("test",b),b.__dustBody=!0,c.__dustBody=!0,b}(dust),function(a){function b(a,b){return a.w('<div id="container"> <div style=\'float:left;\' id="left"><img class="logoImage" src="../images/logo_ESRF.png" /><span class="title">E-Track<span class="subtitle">ESRF Tracking System<sub style="font-size:10px;color:orange">BETA</sub></span></span> </div><div id="center"></div><div style=\'float:right;width:120px;\' id="right"><div style=\'color:white;font-size:10px; \'>Version: ').f(b.getPath(!0,["version"]),b,"h").w("</div><div style='color:white;font-size:10px; '>Released: ").f(b.getPath(!0,["release_date"]),b,"h").w("</div><div style='color:white;font-size:10px;'>").f(b.getPath(!0,["database"]),b,"h").w("</div></div></div>")}return a.register("trackingheader.template",b),b.__dustBody=!0,b}(dust);