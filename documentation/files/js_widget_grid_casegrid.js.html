<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>js/widget/grid/casegrid.js - EXI</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="EXI" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AutoProcIntegrationGrid.html">AutoProcIntegrationGrid</a></li>
                                <li><a href="../classes/ManagerWelcomeMainView.html">ManagerWelcomeMainView</a></li>
                                <li><a href="../classes/ParcelGrid.html">ParcelGrid</a></li>
                                <li><a href="../classes/ParcelPanel.html">ParcelPanel</a></li>
                                <li><a href="../classes/PhasingNetworkWidget.html">PhasingNetworkWidget</a></li>
                                <li><a href="../classes/ShippingMainView.html">ShippingMainView</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: js/widget/grid/casegrid.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * A shipment may contains one or more cases where stock solutions and sample plates are stored
 * 
 * @height
 * @btnEditVisible
 * @btnRemoveVisible
 * 
 * #onEditButtonClicked
 * #onAddButtonClicked
 * #onRemoveButtonClicked
 * #onDuplicateButtonClicked
 */
function CaseGrid(args) {
	this.height = 100;
	this.btnEditVisible = true;
	this.btnRemoveVisible = true;
	
	if (args != null) {
		if (args.height != null) {
			this.height = args.height;
		}
		if (args.btnEditVisible != null) {
			this.btnEditVisible = args.btnEditVisible;
		}
		if (args.btnRemoveVisible != null) {
			this.btnRemoveVisible = args.btnRemoveVisible;
		}
	}

	/** Events **/
	this.onSuccess = new Event(this);
	this.onAdd = new Event(this);
	this.onRemove = new Event(this);
}

CaseGrid.prototype._getHTMLTable = function(items) {
	var html = &quot;&lt;table style=&#x27;font-size:14px;color:gray;&#x27;&gt;&quot;;
	
	for (var i = 0; i &lt; items.length; i++) {
		html = html + &quot;&lt;tr&gt;&quot;;
		html = html + &quot;&lt;td&gt;&quot;;
		html = html + items[i].key;
		html = html + &quot;&lt;/td&gt;&quot;;
		html = html + &quot;&lt;td style=&#x27;font-weight:bold;color:black;&#x27;&gt;&quot;;
		html = html + items[i].value;
		html = html + &quot;&lt;/td&gt;&quot;;
		html = html + &quot;&lt;/tr&gt;&quot;;
	}
	return html + &quot;&lt;/table&gt;&quot;;
	
	
};

CaseGrid.prototype._getHTMLButton = function(dewarId, value) {
	return &#x27;&lt;input id=&quot;&#x27; + dewarId+&#x27; &quot;type=&quot;button&quot; name=&quot;btn&quot; style=&quot;font-size:9px;width:90px; height:40px&quot; class=&quot;btn-component&quot; value=&quot;&#x27; + value +&#x27;&quot; &gt;&#x27;;
};

CaseGrid.prototype._getUnpackStockSolutionButton = function(stockSolutionId, value) {
	return &#x27;&lt;input id=&quot;&#x27; + stockSolutionId +&#x27;&quot;type=&quot;button&quot; name=&quot;stockSolution&quot; style=&quot;font-size:9px;width:90px; height:40px&quot; class=&quot;btn-component-remove&quot; value=&quot;&#x27; + value +&#x27;&quot; &gt;&#x27;;
};

CaseGrid.prototype._getRemoveContainerButton = function(stockSolutionId, value) {
	return &#x27;&lt;input id=&quot;&#x27; + stockSolutionId +&#x27;&quot;type=&quot;button&quot; name=&quot;puck&quot; style=&quot;font-size:9px;width:90px; height:40px&quot; class=&quot;btn-component-remove&quot; value=&quot;&#x27; + value +&#x27;&quot; &gt;&#x27;;
};

CaseGrid.prototype._getEditPuckButton = function(type, id, value) {
	return &#x27;&lt;input id=&quot;&#x27; + type + &quot;_&quot; + id +&#x27;&quot;type=&quot;button&quot; name=&quot;edit&quot; style=&quot;font-size:9px;width:90px; height:40px&quot; class=&quot;btn-component-puck-edit&quot; value=&quot;&#x27; + value +&#x27;&quot; &gt;&#x27;;
};

CaseGrid.prototype._getPrintParcelButton = function(dewarId, value) {
	return &#x27;&lt;input id=&quot;&#x27; + dewarId+&#x27; &quot;type=&quot;button&quot; name=&quot;printLabels&quot; style=&quot;font-size:9px;width:90px; height:40px&quot; class=&quot;btn-component-print-parcel&quot; value=&quot;&#x27; + value +&#x27;&quot; &gt;&#x27;;
};

CaseGrid.prototype._getEditParcelButton = function(dewarId, value) {
	return &#x27;&lt;input id=&quot;&#x27; + dewarId+&#x27; &quot;type=&quot;button&quot; name=&quot;editParcel&quot; style=&quot;font-size:9px;width:90px; height:40px&quot; class=&quot;btn-component-edit-parcel&quot; value=&quot;&#x27; + value +&#x27;&quot; &gt;&#x27;;
};

CaseGrid.prototype._getRemoveParcelButton = function(dewarId, value) {
	return &#x27;&lt;input id=&quot;&#x27; + dewarId+&#x27; &quot;type=&quot;button&quot; name=&quot;removeParcel&quot; style=&quot;font-size:9px;width:90px; height:40px&quot; class=&quot;btn-component-remove&quot; value=&quot;&#x27; + value +&#x27;&quot; &gt;&#x27;;
};


CaseGrid.prototype._getComponentRowHTML = function(icon, type, code, capacity, id) {
	var html = &quot;&quot;;
	html = html + &quot;&lt;tr  class=&#x27;tr-component&#x27;&gt;&quot;;

	html = html + &quot;&lt;td&gt;&quot;;
	html = html +  this._getEditPuckButton(type, Number(id), &quot;Edit&quot;);
	html = html + &quot;&lt;/td&gt;&quot;;

	html = html + &quot;&lt;td&gt;&quot;;
	html = html +  type;
	html = html + &quot;&lt;/td&gt;&quot;;
	
	html = html + &quot;&lt;td&gt;&quot;;
	html = html +  code;
	html = html + &quot;&lt;/td&gt;&quot;;
	
	html = html + &quot;&lt;td&gt;&quot;;
	html = html +  capacity;
	html = html + &quot;&lt;/td&gt;&quot;;

	if (type == &quot;Stock Solution&quot;){
		html = html + &quot;&lt;td&gt;&quot;;
		html = html +  this._getUnpackStockSolutionButton(Number(id), &quot;Unpack&quot;);
		html = html + &quot;&lt;/td&gt;&quot;;
	}
	
	if (type == &quot;Puck&quot;){
		html = html + &quot;&lt;td&gt;&quot;;
		html = html +  this._getRemoveContainerButton(Number(id), &quot;Remove&quot;);
		html = html + &quot;&lt;/td&gt;&quot;;
	}
	
	html = html + &quot;&lt;/tr&gt;&quot;;
	return html;
};

CaseGrid.prototype._getComponentHTML = function(dewarId, items) {
	var html = &quot;&quot;;
	if (items.length &gt; 0){
		html = &quot;&lt;table  class=&#x27;table-component&#x27;&gt;&lt;tr&gt;&lt;th class=&#x27;th-component&#x27;&gt;&lt;/th&gt;&lt;th class=&#x27;th-component&#x27;&gt;Type&lt;/th&gt;&lt;th class=&#x27;th-component&#x27;&gt;Code&lt;/th&gt;&lt;th class=&#x27;th-component&#x27;&gt;Capacity&lt;/th&gt;&lt;th&gt;&lt;/th&gt;&lt;/tr&gt;&quot;;
		for (var i = 0; i &lt; items.length; i++) {
			var icon = &#x27;../images/BasketView_24x24_01.png&#x27;;
			
			if (items[i].type == &quot;Puck&quot;){
					html = html + this._getComponentRowHTML(icon, items[i].type,  items[i].code,  items[i].sampleCount + &quot;/&quot;+ items[i].capacity,  items[i].id);
			}
			
			if (items[i].type == &quot;Stock Solution&quot;){
				icon = &#x27;../images/SampleHolderView_24x24_01.png&#x27;;
				html = html + this._getComponentRowHTML(icon, items[i].type,  items[i].code,  items[i].capacity, items[i].id);
			}
			
		}
		html = html + &quot;&lt;/table&gt;&quot;;
	}
	else{
		html = html + &quot;&lt;br /&gt;&lt;br /&gt;&lt;span class=&#x27;parcel-empty-msg&#x27;&gt;This parcel is empty&lt;/span&gt;&quot;;
	}
	
	
	/** Adding buttons **/
	if (items.length == 0){
		html =  this._getHTMLButton(dewarId, &quot;Add Solution&quot;) + this._getHTMLButton(dewarId, &quot;Add Puck&quot;) + html;
	}

	if (items.length &gt; 0){
		if (items[0].type == &quot;Puck&quot;){
			html =  this._getHTMLButton(dewarId, &quot;Add Puck&quot;) + html;
		}
		else{
			html =  this._getHTMLButton(dewarId, &quot;Add Solution&quot;)+ html;
		}
	}
	return &#x27;&lt;div  class=&quot;header-component-table&quot; &gt;Components&lt;/div&gt;&lt;div  style=&quot;margin:0px 0px 0px 0px !important;width:610px;&quot;&gt;&#x27; + html + &#x27;&lt;/div&gt;&#x27;;
};


CaseGrid.prototype._getParcelHTML = function(dewar) {
	var html = &quot;&lt;table  class=&#x27;table-component&#x27;&gt;&lt;tr&gt;&lt;th class=&#x27;th-component&#x27;&gt;Code&lt;/th&gt;&lt;th class=&#x27;th-component&#x27;&gt;Status&lt;/th&gt;&lt;th class=&#x27;th-component&#x27;&gt;Store Location&lt;/th&gt;&lt;th class=&#x27;th-component&#x27;&gt;Comments&lt;/th&gt;&lt;/tr&gt;&quot;;

	var storageLocation = dewar[&quot;Dewar_storageLocation&quot;];
	var dewarCode = dewar[&quot;Dewar_code&quot;];
	var status = dewar[&quot;Dewar_status&quot;];
	var comments = dewar[&quot;Dewar_comments&quot;];

	if (dewarCode == null){
		dewarCode = &quot;&lt;span style=&#x27;color:orange&#x27;&gt;Not set&lt;/span&gt;&quot;;
	}

	if (status == null){
		status = &quot;&lt;span style=&#x27;color:orange&#x27;&gt;Unknown&lt;/span&gt;&quot;;
	}

	if (storageLocation == null){
		storageLocation = &quot;&lt;span style=&#x27;color:orange&#x27;&gt;Not set&lt;/span&gt;&quot;;
	}

	if (comments == null){
		comments = &quot;&quot;;
	}

	html = html + &quot;&lt;tr class=&#x27;tr-component&#x27;&gt;&lt;td&gt;&quot; + dewarCode + &quot;&lt;/td&gt;&lt;td&gt;&quot; + status + &quot;&lt;/td&gt;&lt;td&gt;&quot; + storageLocation + &quot;&lt;/td&gt;&lt;td&gt;&quot; + comments + &quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;
	/** Adding buttons **/
	html =  this._getEditParcelButton(dewar[&quot;Dewar_dewarId&quot;], &quot;Edit&quot;) +  this._getPrintParcelButton(dewar[&quot;Dewar_dewarId&quot;], &quot;Print Labels&quot;) + this._getRemoveParcelButton(dewar[&quot;Dewar_dewarId&quot;], &quot;Remove&quot;) + html;
	return &#x27;&lt;div  class=&quot;header-component-table&quot; &gt;Parcel&lt;/div&gt;&lt;div  style=&quot;margin:0px 0px 0px 0px !important;width:610px;&quot;&gt;&#x27; + html + &#x27;&lt;/div&gt;&#x27;;
};



CaseGrid.prototype._getColumns = function() {
	var _this = this;

	var columns = [
		{
			header : &#x27;General&#x27;,
			dataIndex : &#x27;type&#x27;,
			name : &#x27;type&#x27;,
			type : &#x27;string&#x27;,
			flex : 0.5,
			
			renderer : function(grid, opts, record){
				var deserialized = JSON.parse(record.data.serialized);
				return _this._getParcelHTML(deserialized[0]);
			}
		},
		{
			header : &#x27;Content&#x27;,
			dataIndex : &#x27;Dewar_comments&#x27;,
			name : &#x27;type&#x27;,
			type : &#x27;string&#x27;,
			flex : 0.5,
			renderer : function(grid, opts, record){
				var deserialized = JSON.parse(record.data.serialized);
				
				var dewarId = deserialized[0].Dewar_dewarId;
				var items = [];
				
				if (deserialized != null){
					if (deserialized.length &gt; 0){
						for (var i = 0; i &lt; deserialized.length; i++) {
							if (deserialized[i].Container_containerType == &quot;Puck&quot;){
								var code = &quot;&quot;;
								if (deserialized[i].Container_code != null){
									code = deserialized[i].Container_code;
								}

								items.push({
								    type 		: deserialized[i].Container_containerType,
								    code 		: code,
								    capacity 	: deserialized[i].Container_capacity,
								    sampleCount : deserialized[i].sampleCount,
								    id 			: deserialized[i].Container_containerId,
								 
								});
								
							}
						}
					}
				}
				
				/** Stock Solutions **/
				var stockSolutions = EXI.proposalManager.getStockSolutionsByDewarId(dewarId);
				for (var i = 0; i &lt; stockSolutions.length; i++) {
						items.push({
										type 		: &quot;Stock Solution&quot;,
	         					    	code 		: stockSolutions[i].name,
	         					    	capacity 	:	stockSolutions[i].volume + &quot;ml&quot;,
	         					    	sampleCount :	&quot;&quot;,
	         					    	id 			: 	stockSolutions[i].stockSolutionId
						 
						});
						
				}
				/** Rendering on HTML **/
				return _this._getComponentHTML(dewarId, items);
			}
		}
	];
	return columns;
};

CaseGrid.prototype._getTopButtons = function() {
	var _this = this;
	var actions = [];

	actions.push(Ext.create(&#x27;Ext.Action&#x27;, {
		icon : &#x27;../images/icon/add.png&#x27;,
		text : &#x27;Add&#x27;,
		disabled : false,
		handler : function(widget, event) {
			_this.edit();
		}
	}));
	

	return actions;
};


CaseGrid.prototype.groupBy = function(array , f ){
	  var groups = {};
	  array.forEach( function( o )
	  {
	    var group = JSON.stringify( f(o) );
	    groups[group] = groups[group] || [];
	    groups[group].push( o );  
	  });
	  
	  return Object.keys(groups).map( function( group ){
		  return groups[group]; 
	  });
	};

CaseGrid.prototype.load = function(shipment) {
	var _this = this;
	
	this.shipment = shipment;
	this.dewars = shipment.dewarVOs;
	
	if (this.dewars.length &gt; 0){
		function onSuccess(sender, containers){
			var dewars = (_this.groupBy(containers, function(item){
				  return [item.Dewar_dewarId];
			}));
			var data = [];
			for (var i = 0; i &lt; dewars.length; i++) {
				data.push({serialized : JSON.stringify(dewars[i])})
			}
			_this.store.loadData(data);
		}
		
		EXI.getDataAdapter({onSuccess : onSuccess}).proposal.shipping.getDewarsByShipmentId(shipment.shippingId);
	}
};


CaseGrid.prototype.edit = function(dewar) {
	var _this = this;
	var caseForm = new CaseForm();
	
	var window = Ext.create(&#x27;Ext.window.Window&#x27;, {
	    title: &#x27;Parcel&#x27;,
	    height: 360,
	    width: 600,
	    modal : true,
	    layout: &#x27;fit&#x27;,
	    items: [
	            	caseForm.getPanel(dewar)
	    ],
	    buttons : [ {
						text : &#x27;Save&#x27;,
						handler : function() {
							var adapter = new DataAdapter();
							_this.panel.setLoading();
							var dewar = caseForm.getDewar();
							var onSuccess = (function(sender, shipment) {
								_this.load(shipment);
								window.close();
								_this.panel.setLoading(false);
							});
							dewar[&quot;sessionId&quot;] = dewar.firstExperimentId;
							dewar[&quot;shippingId&quot;] = _this.shipment.shippingId;
							EXI.getDataAdapter({onSuccess : onSuccess}).proposal.dewar.saveDewar(_this.shipment.shippingId, dewar);
						}
					}, {
						text : &#x27;Cancel&#x27;,
						handler : function() {
							window.close();
						}
					} ]
	});
	window.show();
	
};

CaseGrid.prototype._getStoreFields = function() {
	return [ {
		name : &#x27;serialized&#x27;,
		type : &#x27;string&#x27;
	}
	];
};

CaseGrid.prototype.getDewarById = function(dewarId) {
	var _this = this;
	for (var i = 0; i &lt; _this.dewars.length; i++) {
		if (_this.dewars[i].dewarId == dewarId){
			return _this.dewars[i];
		}
	}
};

CaseGrid.prototype.saveStockSolution = function(stockSolution) {
	var _this = this;
	this.panel.setLoading();
	var onSuccess = function(){
		var onSuccess2 = function(){
			_this.panel.setLoading(false);
			_this.load(_this.shipment);
		};
		EXI.getDataAdapter({onSuccess : onSuccess2}).proposal.proposal.update();
	}
	EXI.getDataAdapter({onSuccess : onSuccess}).saxs.stockSolution.saveStockSolution(stockSolution);
};



CaseGrid.prototype.addPuckToDewar = function(dewarId) {
	var _this = this;
	this.panel.setLoading();
	var onSuccess = function(){
		_this.load(_this.shipment);
		_this.panel.setLoading(false);
	};
	EXI.getDataAdapter({onSuccess : onSuccess}).proposal.shipping.addPuck(this.shipment.shippingId, Number(dewarId));
	
};

CaseGrid.prototype.removePuck = function(puckId) {
	var _this = this;
	this.panel.setLoading();
	var onSuccess = function(sender, data){
		_this.load(_this.shipment);
		_this.panel.setLoading(false);
	};
	EXI.getDataAdapter({onSuccess: onSuccess}).proposal.shipping.removeContainerById(_this.shipment.shippingId,puckId,puckId );
	
};

/** Open a window with the stock solutions **/
CaseGrid.prototype.openStockSolutionWindow = function(dewarId) {
	var _this = this;
	var stockSolutionGrid = new StockSolutionGrid({
		btnAddVisible : false,
		btnEditVisible : false,
		btnRemoveVisible : false,
		btnAddExisting : false,
		isPackedVisible : false,
		multiselect : true
	});

	var window = Ext.create(&#x27;Ext.window.Window&#x27;, {
		height : 400,
		width : 700,
		items : [ stockSolutionGrid.getPanel() ],
		buttons : [ {
			text : &#x27;Pack&#x27;,
			handler : function() {
				window.close();
				stockSolutionGrid.selectedStockSolutions[0][&quot;boxId&quot;] = dewarId;
				_this.saveStockSolution(stockSolutionGrid.selectedStockSolutions[0]);
				
			}
		}, {
			text : &#x27;Cancel&#x27;,
			handler : function() {
				window.close();
			}
		} ]

	}).show();

	stockSolutionGrid.load(EXI.proposalManager.getUnpackedStockSolutions());
};

CaseGrid.prototype.getPanel = function() {
	var _this = this;

	/** Store **/
	this.store = Ext.create(&#x27;Ext.data.Store&#x27;, {
		fields : this._getStoreFields(),
		data : [],
		autoload : true
	});

	
	this.panel = Ext.create(&#x27;Ext.grid.Panel&#x27;, {
		style : {
			padding : 15
		},
		cls : &#x27;border-grid&#x27;,
		height : 800,
		deferEmptyText: false,
	    	emptyText: &#x27;No data&#x27;,
		store : this.store,
		columns : this._getColumns(),
		disableSelection : true,
		viewConfig : {
			stripeRows : true,
				enableTextSelection : true,
				preserveScrollOnRefresh : true,
				stripeRows : true,
				rowLines : true,
				listeners : {
					celldblclick : function(grid, td, cellIndex, record, tr, rowIndex, e, eOpts) {
						_this.edit(_this.getDewarById(JSON.parse(record.data.serialized)[0].Dewar_dewarId));
					},
					cellclick : function(grid, td, cellIndex, record, tr, rowIndex, e, eOpts) {

							if (e.target.name == &#x27;printLabels&#x27;) {
								var dewarId = e.target.id.trim();
								var url = EXI.getDataAdapter().proposal.shipping.getDewarLabelURL(_this.shipment.shippingId, dewarId);
								console.log(dewarId);
								location.href = url;
								return;
							}
							if (e.target.name == &#x27;removeParcel&#x27;) {
								BUI.showWarning(&quot;Not implemented yet&quot;);
								return;
							}
							if (e.target.name == &#x27;editParcel&#x27;) {
								_this.edit(_this.getDewarById(parseInt(e.target.id.trim())));
								return;
							}
							if (e.target.name == &#x27;edit&#x27;) {
								/** Edit stock solution **/
								if (e.target.id.indexOf(&quot;Stock Solution&quot;) != -1){
									var stockSolutionId = e.target.id.split(&quot;_&quot;)[1];
									location.hash = &quot;/stocksolution/&quot; + stockSolutionId +&quot;/main&quot;;
								}
								
								if (e.target.id.indexOf(&quot;Puck&quot;) != -1){
									var containerId = e.target.id.split(&quot;_&quot;)[1];
									//location.hash = &quot;/puck/&quot; + containerId +&quot;/main&quot;;
									var puckForm = new PuckForm({
										width : Ext.getBody().getWidth() - 150
									});

									puckForm.onSaved.attach(function(sender, puck){
										_this.load(_this.shipment);
										window.close();
									});
									var window = Ext.create(&#x27;Ext.window.Window&#x27;, {
										    title: &#x27;Edit Puck&#x27;,
										    height: 700,
										    width: Ext.getBody().getWidth() - 100,
										    modal : true,
										    resizable : true,
										    layout: &#x27;fit&#x27;,
										    items: puckForm.getPanel()
										}).show();

									if (containerId != null){
										var onSuccess = function(sender, puck){
											puckForm.load(puck);
										
										};
										EXI.getDataAdapter({onSuccess : onSuccess}).proposal.shipping.getContainerById(containerId,containerId,containerId);
									}

								}
								
							}
							
							
							if (e.target.defaultValue == &#x27;Add Solution&#x27;) {
								_this.openStockSolutionWindow(e.target.id);
							}
							
							if (e.target.defaultValue == &#x27;Add Puck&#x27;) {
								_this.addPuckToDewar(e.target.id);
							}
							

							if (e.target.defaultValue == &#x27;Unpack&#x27;) {
								if (e.target.name == &quot;stockSolution&quot;){
									var stockSolution = EXI.proposalManager.getStockSolutionById(e.target.id);
									stockSolution.boxId = null;
									_this.saveStockSolution(stockSolution);
								}
							}
							
							if (e.target.defaultValue == &#x27;Remove&#x27;) {
								var puckId = Number(e.target.id);
								if (e.target.name == &quot;puck&quot;){
									function showResult(result){
											if (result == &quot;yes&quot;){
												_this.removePuck(puckId);
											}
									}
									  Ext.MessageBox.show({
								           title:&#x27;Save Changes?&#x27;,
								           msg: &#x27;Removing a puck from this parcel will remove also its content. &lt;br /&gt;Are you sure you want to continue?&#x27;,
								           buttons: Ext.MessageBox.YESNOCANCEL,
								           fn: showResult,
								           animateTarget: &#x27;mb4&#x27;,
								           icon: Ext.MessageBox.QUESTION
								       });
									  
								}
							}
					}
				}
		},
		selModel : {
			mode : &#x27;SINGLE&#x27;
		}
	});

	this.panel.addDocked({
		height : 45,
		xtype : &#x27;toolbar&#x27;,
		items : _this._getTopButtons(),
		cls : &#x27;exi-top-bar&#x27;
	});

	return this.panel;
};

/*
var canvas = SVG.createSVGCanvas(document.getElementById(&quot;testXVG&quot;), [[&quot;width&quot;, 1000], [&quot;height&quot;, 1000]])

var steps = 10;
var centerX = 500;
var centerY = 500;
var radius = 400;
var xValues = []
var yValues = []
for (var i = 0; i &lt; steps; i++) {
    xValues[i] = (centerX + radius * Math.cos(2 * Math.PI * i / steps));
    yValues[i] = (centerY + radius * Math.sin(2 * Math.PI * i / steps));
    SVG.drawCircle(xValues[i], yValues[i], 100, canvas, [[&quot;fill&quot;, &quot;green&quot;]]);
}*/
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
