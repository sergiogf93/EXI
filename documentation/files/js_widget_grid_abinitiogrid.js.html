<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>js/widget/grid/abinitiogrid.js - EXI</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="EXI" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AutoProcIntegrationGrid.html">AutoProcIntegrationGrid</a></li>
                                <li><a href="../classes/ManagerWelcomeMainView.html">ManagerWelcomeMainView</a></li>
                                <li><a href="../classes/ParcelGrid.html">ParcelGrid</a></li>
                                <li><a href="../classes/ParcelPanel.html">ParcelPanel</a></li>
                                <li><a href="../classes/PhasingNetworkWidget.html">PhasingNetworkWidget</a></li>
                                <li><a href="../classes/ShippingMainView.html">ShippingMainView</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: js/widget/grid/abinitiogrid.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">


function AbinitioGrid(args) {
	this.height = null;
	this.width = null;
	this.id = BUI.id();

	if (args != null) {
		if (args.height != null) {
			this.height = args.height;

			if (args.width != null) {
				this.width = args.width;
			}
		}
	}
	
	this.onSelected = new Event(this);
};


AbinitioGrid.prototype.refresh = function(subtractions){
	this.store.loadData(this._prepareData(subtractions));
};

AbinitioGrid.prototype._prepareData = function(subtractions){
	/** Parsing data * */
	var models = [];
	for (var l = 0; l &lt; subtractions.length; l++) {
		var subtraction = subtractions[l];
		for (var k = 0; k &lt; subtraction.substractionToAbInitioModel3VOs.length; k++) {
			var data = subtraction.substractionToAbInitioModel3VOs[k].abinitiomodel3VO;
			if (data.averagedModel != null) {
				models.push(data.averagedModel);
				models[models.length - 1].type = &quot;Reference&quot;;
			}
	
			if (data.shapeDeterminationModel != null) {
				models.push(data.shapeDeterminationModel);
				models[models.length - 1].type = &quot;Refined&quot;;
			}
	
			if (data.modelList3VO != null) {
				if (data.modelList3VO.modeltolist3VOs != null) {
					for (var i = 0; i &lt; data.modelList3VO.modeltolist3VOs.length; i++) {
						models.push(data.modelList3VO.modeltolist3VOs[i].model3VO);
						models[models.length - 1].type = &quot;Model&quot;;
					}
				}
			}
		}
	}
	return models;
};

AbinitioGrid.prototype.getPanel = function(){
	var _this = this;
	
	
	var modelFields = [ &quot;modelId&quot;, &quot;type&quot;, &quot;chiSqrt&quot;, &quot;dmax&quot;, &quot;firFile&quot;, &quot;logFile&quot;, &quot;fitFile&quot;, &quot;pdbFile&quot;, &quot;rfactor&quot;, &quot;rg&quot;, &quot;volume&quot; ];
	Ext.define(&#x27;AbinitioModel&#x27;, {
		extend : &#x27;Ext.data.Model&#x27;,
		fields : modelFields
		
	});

	/**
	 * Store in Memory
	 */
	this.store = Ext.create(&#x27;Ext.data.Store&#x27;, {
		model : &#x27;AbinitioModel&#x27;,
		autoload : true,
		groupField : &#x27;type&#x27;
	});
	
	
	  var groupingFeature = Ext.create(&#x27;Ext.grid.feature.Grouping&#x27;,{
	        groupHeaderTpl: &#x27;{name} ({rows.length} model{[values.rows.length &gt; 1 ? &quot;s&quot; : &quot;&quot;]})&#x27;,
	        startCollapsed: false,
	        collapsible : true
	  });
	
	  var selModel = Ext.create(&#x27;Ext.selection.RowModel&#x27;, {
			allowDeselect : true,
//			mode : &#x27;multi&#x27;,
			listeners : {
				selectionchange : function(sm, selections) {
					if (selections.length &gt; 0){
						_this.onSelected.notify([selections[0].data]); 
					}

				}

			} });
	  
	this.grid = Ext.create(&#x27;Ext.grid.Panel&#x27;, {
		collapsible : false,
		resizable : true,
		selModel : selModel,
		features: [groupingFeature],
		autoscroll : true,
		multiSelect : true,
		store : this.store,
		cls : &#x27;border-grid&#x27;,
		height : this.height,
		width : this.width,
		margin : 10,
		columns : [ {
			text : &quot;Type&quot;,
			dataindex : &quot;type&quot;,
			hidden : true,
			renderer : function(a, b, record) {
				return record.data.type;
			},
			flex : 1
		},
		{
			text : &quot;ModelId&quot;,
			dataindex : &quot;modelId&quot;,
			hidden : true,
			renderer : function(a, b, record) {
					return record.data.modelId;
				
			},
			flex : 1
		},
		
		{
			text : &quot;chiSqrt&quot;,
			dataindex : &quot;chiSqrt&quot;,
			renderer : function(a, b, record) {
				if (record.data.dmax != null) {
					return BUI.formatValuesUnits(record.data.chiSqrt, &quot;&quot;, 12, this.decimals);
				}
				
			},
			flex : 1
		},
		{
			text : &quot;Dmax&quot;,
			dataindex : &quot;dmax&quot;,
			renderer : function(a, b, record) {
				if (record.data.dmax != null) {
					return BUI.formatValuesUnits(record.data.dmax, &quot;nm&quot;, 12, this.decimals);
				}
				
			},
			flex : 1
		}, {
			text : &quot;rFactor&quot;,
			dataindex : &quot;rfactor&quot;,
			hidden : true,
			renderer : function(a, b, record) {
				if (record.data.rfactor != null) {
					return record.data.rfactor;
				}
			},
			flex : 1
		}, {
			text : &quot;Rg&quot;,
			dataindex : &quot;rg&quot;,
			renderer : function(a, b, record) {
				if (record.data.rg != null) {
					return BUI.formatValuesUnits(record.data.rg, &quot;nm&quot;, 12, this.decimals);
				}
				
			},
			flex : 1
		},
		{
			text : &quot;Volume&quot;,
			dataindex : &quot;volume&quot;,
			renderer : function(a, b, record) {
				if (record.data.volume != null){
					return BUI.formatValuesUnits(record.data.volume, &#x27;&#x27;) + &quot;&lt;span style=&#x27;font-size:8px;color:gray;&#x27;&gt; nm&lt;sub&gt;3&lt;/sub&gt;&lt;/span&gt;&quot;;
				}
			},
			flex : 1
		},
		{
			text : &quot;PDB&quot;,
			dataindex : &quot;pdbFile&quot;,
			renderer : function(a, b, record) {
				if (record.data.pdbFile != null){
					return record.data.pdbFile.split(&quot;/&quot;)[record.data.pdbFile.split(&quot;/&quot;).length - 1];
				}
			},
			flex : 1
		}, {
			text : &quot;Fir&quot;,
			dataindex : &quot;firFile&quot;,
			renderer : function(a, b, record) {
				if (record.data.firFile != null){
					return record.data.firFile.split(&quot;/&quot;)[record.data.firFile.split(&quot;/&quot;).length - 1];
				}
			},
			flex : 1
		}, {
			text : &quot;LOG&quot;,
			dataindex : &quot;logFile&quot;,
			hidden : true,
			renderer : function(a, b, record) {
				if (record.data.logFile != null){
					return record.data.logFile.split(&quot;/&quot;)[record.data.logFile.split(&quot;/&quot;).length - 1];
				}
			},
			flex : 1
		}
		],
		viewConfig : {
			enableTextSelection : true,
			preserveScrollOnRefresh : true,
			stripeRows : true,
			listeners : {
//				&#x27;celldblclick&#x27; : function(grid, td, cellIndex, record, tr, rowIndex, e, eOpts) {
//				},
//				&#x27;cellclick&#x27; : function(grid, td, cellIndex, record, tr, rowIndex, e, eOpts) {
//					var models = [];
//					debugger
//					for (var i = 0; i &lt; grid.getSelectionModel().selected.items.length; i++) {
//						models.push(grid.getSelectionModel().selected.items[i].data);
//					}
//					
//				}
			}
		}
	});
	return this.grid;
	
};

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
